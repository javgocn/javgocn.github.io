<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://www.javgo.cn/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html"><meta property="og:site_name" content="JavGo"><meta property="og:title" content="04-cloud-å®æˆ˜é¡¹ç›®æ­å»º"><meta property="og:description" content="1.æ­å»ºå¼€å‘ç¯å¢ƒ â€œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨â€â€”â€”è¿™ä¸ªå¤ä»£çš„æ ¼è¨€åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­ä¾ç„¶é€‚ç”¨ã€‚å¼€å‘ç¯å¢ƒçš„æ­å»ºæ˜¯è¿›è¡Œé«˜æ•ˆè½¯ä»¶å¼€å‘çš„åŸºç¡€ï¼Œç¡®ä¿åœ¨é¡¹ç›®å®æ–½è¿‡ç¨‹ä¸­ç³»ç»Ÿè¿è¡Œçš„ç¨³å®šæ€§ä¸ä¸€è‡´æ€§ã€‚åœ¨æ·±å…¥é¡¹ç›®å®æˆ˜ä¹‹å‰ï¼Œå…³é”®åœ¨äºå»ºç«‹ä¸€ä¸ªå¥å…¨ä¸”å¯é çš„å¼€å‘ç¯å¢ƒï¼Œä»¥é¿å…åæœŸç”±äºç¯å¢ƒé…ç½®ä¸å½“å¸¦æ¥çš„ç§ç§é—®é¢˜å’ŒæŒ‘æˆ˜ã€‚ 1. å¼€å‘ç¯å¢ƒçš„ç»Ÿä¸€æ ‡å‡†åŒ– é¦–å…ˆï¼Œç»Ÿä¸€çš„å¼€å‘ç¯å¢ƒé…ç½®æ˜¯ä¿éšœé¡¹ç›®å›¢é˜Ÿåä½œé¡º..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-11-10T16:14:41.000Z"><meta property="article:author" content="Mr.JavGo"><meta property="article:modified_time" content="2023-11-10T16:14:41.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"04-cloud-å®æˆ˜é¡¹ç›®æ­å»º","image":[""],"dateModified":"2023-11-10T16:14:41.000Z","author":[{"@type":"Person","name":"Mr.JavGo","url":"https://www.javgo.cn","email":"javgocn@gmail.com"}]}</script><link rel="icon" href="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-11-03-091254.gif"><title>04-cloud-å®æˆ˜é¡¹ç›®æ­å»º | JavGo</title><meta name="description" content="1.æ­å»ºå¼€å‘ç¯å¢ƒ â€œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨â€â€”â€”è¿™ä¸ªå¤ä»£çš„æ ¼è¨€åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­ä¾ç„¶é€‚ç”¨ã€‚å¼€å‘ç¯å¢ƒçš„æ­å»ºæ˜¯è¿›è¡Œé«˜æ•ˆè½¯ä»¶å¼€å‘çš„åŸºç¡€ï¼Œç¡®ä¿åœ¨é¡¹ç›®å®æ–½è¿‡ç¨‹ä¸­ç³»ç»Ÿè¿è¡Œçš„ç¨³å®šæ€§ä¸ä¸€è‡´æ€§ã€‚åœ¨æ·±å…¥é¡¹ç›®å®æˆ˜ä¹‹å‰ï¼Œå…³é”®åœ¨äºå»ºç«‹ä¸€ä¸ªå¥å…¨ä¸”å¯é çš„å¼€å‘ç¯å¢ƒï¼Œä»¥é¿å…åæœŸç”±äºç¯å¢ƒé…ç½®ä¸å½“å¸¦æ¥çš„ç§ç§é—®é¢˜å’ŒæŒ‘æˆ˜ã€‚ 1. å¼€å‘ç¯å¢ƒçš„ç»Ÿä¸€æ ‡å‡†åŒ– é¦–å…ˆï¼Œç»Ÿä¸€çš„å¼€å‘ç¯å¢ƒé…ç½®æ˜¯ä¿éšœé¡¹ç›®å›¢é˜Ÿåä½œé¡º...">
    <style>
      html {
        background: #fff;
      }

      html[data-theme="dark"] {
        background: #1d1e1f;
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-8a499f0b.css" as="style"><link rel="stylesheet" href="/assets/style-8a499f0b.css">
    <link rel="modulepreload" href="/assets/app-009ef08a.js"><link rel="modulepreload" href="/assets/04-cloud-å®æˆ˜é¡¹ç›®æ­å»º.html-aeccdb85.js"><link rel="modulepreload" href="/assets/04-cloud-å®æˆ˜é¡¹ç›®æ­å»º.html-e1c55e4a.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/assets/index.html-59545fda.js" as="script"><link rel="prefetch" href="/assets/index.html-b0db079f.js" as="script"><link rel="prefetch" href="/assets/disable.html-2014604b.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-d40e3c22.js" as="script"><link rel="prefetch" href="/assets/markdown.html-6da9f9fb.js" as="script"><link rel="prefetch" href="/assets/page.html-a73ec1b5.js" as="script"><link rel="prefetch" href="/assets/index.html-25c59f41.js" as="script"><link rel="prefetch" href="/assets/index.html-e02c2004.js" as="script"><link rel="prefetch" href="/assets/index.html-76825eba.js" as="script"><link rel="prefetch" href="/assets/baz.html-c679209f.js" as="script"><link rel="prefetch" href="/assets/index.html-f29edad1.js" as="script"><link rel="prefetch" href="/assets/ray.html-18a627bd.js" as="script"><link rel="prefetch" href="/assets/Docker.html-b875c70e.js" as="script"><link rel="prefetch" href="/assets/Git.html-d7745bd5.js" as="script"><link rel="prefetch" href="/assets/Homebrew.html-f7c0660d.js" as="script"><link rel="prefetch" href="/assets/JDK.html-b3833425.js" as="script"><link rel="prefetch" href="/assets/Linux.html-4506b435.js" as="script"><link rel="prefetch" href="/assets/MacOS.html-92677d4f.js" as="script"><link rel="prefetch" href="/assets/Maven.html-b5ff16f2.js" as="script"><link rel="prefetch" href="/assets/01-Javaä»‹ç».html-4693b97b.js" as="script"><link rel="prefetch" href="/assets/02-ç¯å¢ƒæ­å»º.html-33f85d2b.js" as="script"><link rel="prefetch" href="/assets/03-IDEå¼€å‘å·¥å…·.html-f7e91fb5.js" as="script"><link rel="prefetch" href="/assets/04-æ•°æ®ç±»å‹.html-f3a415d9.js" as="script"><link rel="prefetch" href="/assets/05-æµç¨‹æ§åˆ¶.html-0156f680.js" as="script"><link rel="prefetch" href="/assets/06-æ•°ç»„.html-ced4c392.js" as="script"><link rel="prefetch" href="/assets/07-é¢å‘å¯¹è±¡.html-03adc1d0.js" as="script"><link rel="prefetch" href="/assets/08-æŠ½è±¡ç±».html-cc98c54c.js" as="script"><link rel="prefetch" href="/assets/09-æ¥å£.html-792a440e.js" as="script"><link rel="prefetch" href="/assets/10-æšä¸¾.html-dc4d145c.js" as="script"><link rel="prefetch" href="/assets/11-String.html-ddaa6e66.js" as="script"><link rel="prefetch" href="/assets/12-æ—¥æœŸæ—¶é—´.html-f1e81768.js" as="script"><link rel="prefetch" href="/assets/13-é›†åˆç±».html-1f946d66.js" as="script"><link rel="prefetch" href="/assets/14-æ³›å‹.html-7db2330a.js" as="script"><link rel="prefetch" href="/assets/15-æ³¨è§£.html-cdb3b4ad.js" as="script"><link rel="prefetch" href="/assets/16-å¼‚å¸¸å¤„ç†.html-8f34614e.js" as="script"><link rel="prefetch" href="/assets/17-å¤šçº¿ç¨‹.html-18056ca6.js" as="script"><link rel="prefetch" href="/assets/18-IOæµ.html-4372afb9.js" as="script"><link rel="prefetch" href="/assets/19-åå°„.html-cbf15af8.js" as="script"><link rel="prefetch" href="/assets/01-é›†åˆæ¡†æ¶æ¦‚è§ˆ.html-11ce78b8.js" as="script"><link rel="prefetch" href="/assets/02-æºç -ArrayList.html-ded021ce.js" as="script"><link rel="prefetch" href="/assets/03-æºç -HashMap.html-f85b9dff.js" as="script"><link rel="prefetch" href="/assets/01-å¿«é€Ÿå…¥é—¨-HelloWorld.html-26b2dc78.js" as="script"><link rel="prefetch" href="/assets/02-æ ¸å¿ƒå¿…å­¦-SpringApplication.html-4f1b8268.js" as="script"><link rel="prefetch" href="/assets/03-æ ¸å¿ƒå¿…å­¦-å¤–éƒ¨é…ç½®.html-96065495.js" as="script"><link rel="prefetch" href="/assets/04-æ ¸å¿ƒå¿…å­¦-Profiles.html-136ad074.js" as="script"><link rel="prefetch" href="/assets/06-æ ¸å¿ƒå¿…å­¦-æ—¥å¿—è®°å½•.html-ae8edfe2.js" as="script"><link rel="prefetch" href="/assets/07-æ ¸å¿ƒå¿…å­¦-å›½é™…åŒ–.html-4f7a6cc1.js" as="script"><link rel="prefetch" href="/assets/08-æ ¸å¿ƒå¿…å­¦-JSON.html-716ba309.js" as="script"><link rel="prefetch" href="/assets/09-æ ¸å¿ƒå¿…å­¦-å®šæ—¶ä»»åŠ¡.html-c448fd00.js" as="script"><link rel="prefetch" href="/assets/10-æ ¸å¿ƒå¿…å­¦-æµ‹è¯•.html-0254dae6.js" as="script"><link rel="prefetch" href="/assets/11-æ ¸å¿ƒå¿…å­¦-åˆ›å»ºè‡ªå·±çš„è‡ªåŠ¨é…ç½®.html-9219d7d9.js" as="script"><link rel="prefetch" href="/assets/00-cloud-å¯¼è¯­.html-f1aca826.js" as="script"><link rel="prefetch" href="/assets/01-cloud-å¾®æœåŠ¡æ¶æ„çš„å†å²æ¼”è¿›.html-c829a86b.js" as="script"><link rel="prefetch" href="/assets/02-cloud-SpringCloudæ¦‚è¿°.html-7543586d.js" as="script"><link rel="prefetch" href="/assets/03-cloud-å®æˆ˜é¡¹ç›®è¯´æ˜.html-df4b55a0.js" as="script"><link rel="prefetch" href="/assets/05-cloud-æœåŠ¡æ²»ç†.html-185db1c2.js" as="script"><link rel="prefetch" href="/assets/01-æ ¸å¿ƒ-IOC.html-fda7883c.js" as="script"><link rel="prefetch" href="/assets/01-Security-HelloSecurity.html-2cfdca64.js" as="script"><link rel="prefetch" href="/assets/02-Security-æ•´ä½“æ¶æ„.html-3f3a58aa.js" as="script"><link rel="prefetch" href="/assets/03-Security-è®¤è¯.html-50f8ed66.js" as="script"><link rel="prefetch" href="/assets/04-Security-æˆæƒ.html-5d7954c6.js" as="script"><link rel="prefetch" href="/assets/05-Security-OAuth2.html-99fdbb55.js" as="script"><link rel="prefetch" href="/assets/06-Security-Webæ”»å‡»é˜²æŠ¤.html-faeebdec.js" as="script"><link rel="prefetch" href="/assets/07-Security-é›†æˆ.html-9e66f06f.js" as="script"><link rel="prefetch" href="/assets/08-Security-é…ç½®.html-60155ef2.js" as="script"><link rel="prefetch" href="/assets/09-Security-æµ‹è¯•.html-042121af.js" as="script"><link rel="prefetch" href="/assets/01-KIEå…¥é—¨.html-c564d424.js" as="script"><link rel="prefetch" href="/assets/02-Droolsè§„åˆ™å¼•æ“.html-d932cd97.js" as="script"><link rel="prefetch" href="/assets/03-è§„åˆ™è¯­è¨€å‚è€ƒ.html-48b899a9.js" as="script"><link rel="prefetch" href="/assets/04-Droolsé›†æˆSpringBoot.html-69981010.js" as="script"><link rel="prefetch" href="/assets/05-WorkBench.html-6c06ab90.js" as="script"><link rel="prefetch" href="/assets/è§„åˆ™è¯­è¨€-DRL.html-6e9a2ff8.js" as="script"><link rel="prefetch" href="/assets/è§„åˆ™è¯­è¨€-DSL.html-8071d898.js" as="script"><link rel="prefetch" href="/assets/01-å¿«é€Ÿå…¥é—¨.html-82322369.js" as="script"><link rel="prefetch" href="/assets/02-è¯»Excel.html-d5ea6a0f.js" as="script"><link rel="prefetch" href="/assets/03-å†™Excel.html-d6b5b9e0.js" as="script"><link rel="prefetch" href="/assets/04-å¡«å……Excel.html-4bae95b2.js" as="script"><link rel="prefetch" href="/assets/01-å­¦ä¹ ç½‘ç«™æ¨è.html-2d48eece.js" as="script"><link rel="prefetch" href="/assets/02-Gitå‘½ä»¤æ¸…å•.html-fcb654f5.js" as="script"><link rel="prefetch" href="/assets/03-GitHubæ–‡æ¡£.html-36c2709c.js" as="script"><link rel="prefetch" href="/assets/04-GitLabæ–‡æ¡£.html-bc435a59.js" as="script"><link rel="prefetch" href="/assets/05-Gitå¿«é€Ÿå…¥é—¨.html-63f966ab.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼ç®—æ³•-Snowflake_ID.html-0bd516b9.js" as="script"><link rel="prefetch" href="/assets/æ’åº-å†’æ³¡æ’åºï¼ˆBubble_sortï¼‰.html-ae6dd5e7.js" as="script"><link rel="prefetch" href="/assets/æ’åº-å¿«é€Ÿæ’åºï¼ˆQuick_Sortï¼‰.html-0ecdb7be.js" as="script"><link rel="prefetch" href="/assets/æ’åº-æ’å…¥æ’åºï¼ˆInsertion_sortï¼‰.html-126e41fa.js" as="script"><link rel="prefetch" href="/assets/æ’åº-é€‰æ‹©æ’åºï¼ˆSelection_sortï¼‰.html-a56f461c.js" as="script"><link rel="prefetch" href="/assets/01-Linuxæ¦‚è¿°.html-5ecd476c.js" as="script"><link rel="prefetch" href="/assets/02-Linuxå®‰è£…ä¸Šæ‰‹.html-f4f93ce3.js" as="script"><link rel="prefetch" href="/assets/03-LinuxåŸºæœ¬å‘½ä»¤.html-479af89b.js" as="script"><link rel="prefetch" href="/assets/404.html-6297c376.js" as="script"><link rel="prefetch" href="/assets/index.html-212f325e.js" as="script"><link rel="prefetch" href="/assets/index.html-bfe20a2c.js" as="script"><link rel="prefetch" href="/assets/index.html-dd82a3d8.js" as="script"><link rel="prefetch" href="/assets/index.html-22fa99d8.js" as="script"><link rel="prefetch" href="/assets/index.html-f79655e7.js" as="script"><link rel="prefetch" href="/assets/index.html-be90ee37.js" as="script"><link rel="prefetch" href="/assets/index.html-a4406380.js" as="script"><link rel="prefetch" href="/assets/index.html-16d8ead3.js" as="script"><link rel="prefetch" href="/assets/index.html-1706bfa4.js" as="script"><link rel="prefetch" href="/assets/index.html-b7d180ce.js" as="script"><link rel="prefetch" href="/assets/index.html-63b9e4b7.js" as="script"><link rel="prefetch" href="/assets/index.html-5190e02b.js" as="script"><link rel="prefetch" href="/assets/index.html-8f988524.js" as="script"><link rel="prefetch" href="/assets/index.html-6553ad6b.js" as="script"><link rel="prefetch" href="/assets/index.html-1bc865ae.js" as="script"><link rel="prefetch" href="/assets/index.html-4e1bd50c.js" as="script"><link rel="prefetch" href="/assets/index.html-6aab0649.js" as="script"><link rel="prefetch" href="/assets/index.html-eac64704.js" as="script"><link rel="prefetch" href="/assets/index.html-240368ca.js" as="script"><link rel="prefetch" href="/assets/index.html-15ccd56b.js" as="script"><link rel="prefetch" href="/assets/disable.html-bd0e46b8.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-201a46f5.js" as="script"><link rel="prefetch" href="/assets/markdown.html-80696976.js" as="script"><link rel="prefetch" href="/assets/page.html-90b3c8e1.js" as="script"><link rel="prefetch" href="/assets/index.html-9bcb8a28.js" as="script"><link rel="prefetch" href="/assets/index.html-18002ea0.js" as="script"><link rel="prefetch" href="/assets/index.html-92f11359.js" as="script"><link rel="prefetch" href="/assets/baz.html-af8bb83b.js" as="script"><link rel="prefetch" href="/assets/index.html-588fdcc9.js" as="script"><link rel="prefetch" href="/assets/ray.html-dd4f381d.js" as="script"><link rel="prefetch" href="/assets/Docker.html-d95efed6.js" as="script"><link rel="prefetch" href="/assets/Git.html-d2b1bb17.js" as="script"><link rel="prefetch" href="/assets/Homebrew.html-f6ea081b.js" as="script"><link rel="prefetch" href="/assets/JDK.html-996a402c.js" as="script"><link rel="prefetch" href="/assets/Linux.html-0f749299.js" as="script"><link rel="prefetch" href="/assets/MacOS.html-2c6a4038.js" as="script"><link rel="prefetch" href="/assets/Maven.html-8c3aa0b3.js" as="script"><link rel="prefetch" href="/assets/01-Javaä»‹ç».html-7729143a.js" as="script"><link rel="prefetch" href="/assets/02-ç¯å¢ƒæ­å»º.html-b94763a7.js" as="script"><link rel="prefetch" href="/assets/03-IDEå¼€å‘å·¥å…·.html-a6817e38.js" as="script"><link rel="prefetch" href="/assets/04-æ•°æ®ç±»å‹.html-38b4e584.js" as="script"><link rel="prefetch" href="/assets/05-æµç¨‹æ§åˆ¶.html-efcc84a8.js" as="script"><link rel="prefetch" href="/assets/06-æ•°ç»„.html-43b97b9c.js" as="script"><link rel="prefetch" href="/assets/07-é¢å‘å¯¹è±¡.html-672f0b4e.js" as="script"><link rel="prefetch" href="/assets/08-æŠ½è±¡ç±».html-fa26016b.js" as="script"><link rel="prefetch" href="/assets/09-æ¥å£.html-2e570dc4.js" as="script"><link rel="prefetch" href="/assets/10-æšä¸¾.html-72d18700.js" as="script"><link rel="prefetch" href="/assets/11-String.html-b97a5354.js" as="script"><link rel="prefetch" href="/assets/12-æ—¥æœŸæ—¶é—´.html-6c3ad250.js" as="script"><link rel="prefetch" href="/assets/13-é›†åˆç±».html-17e09079.js" as="script"><link rel="prefetch" href="/assets/14-æ³›å‹.html-11740442.js" as="script"><link rel="prefetch" href="/assets/15-æ³¨è§£.html-56882890.js" as="script"><link rel="prefetch" href="/assets/16-å¼‚å¸¸å¤„ç†.html-d77dfe7e.js" as="script"><link rel="prefetch" href="/assets/17-å¤šçº¿ç¨‹.html-4968d9a9.js" as="script"><link rel="prefetch" href="/assets/18-IOæµ.html-48fd3a62.js" as="script"><link rel="prefetch" href="/assets/19-åå°„.html-5d3aa3d1.js" as="script"><link rel="prefetch" href="/assets/01-é›†åˆæ¡†æ¶æ¦‚è§ˆ.html-967b8ba2.js" as="script"><link rel="prefetch" href="/assets/02-æºç -ArrayList.html-c4bdcdfa.js" as="script"><link rel="prefetch" href="/assets/03-æºç -HashMap.html-7cb17ed6.js" as="script"><link rel="prefetch" href="/assets/01-å¿«é€Ÿå…¥é—¨-HelloWorld.html-188f2970.js" as="script"><link rel="prefetch" href="/assets/02-æ ¸å¿ƒå¿…å­¦-SpringApplication.html-3e537c7c.js" as="script"><link rel="prefetch" href="/assets/03-æ ¸å¿ƒå¿…å­¦-å¤–éƒ¨é…ç½®.html-0391e2f5.js" as="script"><link rel="prefetch" href="/assets/04-æ ¸å¿ƒå¿…å­¦-Profiles.html-ba993730.js" as="script"><link rel="prefetch" href="/assets/06-æ ¸å¿ƒå¿…å­¦-æ—¥å¿—è®°å½•.html-f59135d3.js" as="script"><link rel="prefetch" href="/assets/07-æ ¸å¿ƒå¿…å­¦-å›½é™…åŒ–.html-72b42be4.js" as="script"><link rel="prefetch" href="/assets/08-æ ¸å¿ƒå¿…å­¦-JSON.html-2cacee00.js" as="script"><link rel="prefetch" href="/assets/09-æ ¸å¿ƒå¿…å­¦-å®šæ—¶ä»»åŠ¡.html-ac41985c.js" as="script"><link rel="prefetch" href="/assets/10-æ ¸å¿ƒå¿…å­¦-æµ‹è¯•.html-c739b85e.js" as="script"><link rel="prefetch" href="/assets/11-æ ¸å¿ƒå¿…å­¦-åˆ›å»ºè‡ªå·±çš„è‡ªåŠ¨é…ç½®.html-42301c8f.js" as="script"><link rel="prefetch" href="/assets/00-cloud-å¯¼è¯­.html-0a66cb1d.js" as="script"><link rel="prefetch" href="/assets/01-cloud-å¾®æœåŠ¡æ¶æ„çš„å†å²æ¼”è¿›.html-e0c75ef9.js" as="script"><link rel="prefetch" href="/assets/02-cloud-SpringCloudæ¦‚è¿°.html-f5594879.js" as="script"><link rel="prefetch" href="/assets/03-cloud-å®æˆ˜é¡¹ç›®è¯´æ˜.html-8e178440.js" as="script"><link rel="prefetch" href="/assets/05-cloud-æœåŠ¡æ²»ç†.html-191cc808.js" as="script"><link rel="prefetch" href="/assets/01-æ ¸å¿ƒ-IOC.html-dfd8645a.js" as="script"><link rel="prefetch" href="/assets/01-Security-HelloSecurity.html-c3980c6f.js" as="script"><link rel="prefetch" href="/assets/02-Security-æ•´ä½“æ¶æ„.html-6af76034.js" as="script"><link rel="prefetch" href="/assets/03-Security-è®¤è¯.html-b304e25d.js" as="script"><link rel="prefetch" href="/assets/04-Security-æˆæƒ.html-bc2fa325.js" as="script"><link rel="prefetch" href="/assets/05-Security-OAuth2.html-ed4bd1c8.js" as="script"><link rel="prefetch" href="/assets/06-Security-Webæ”»å‡»é˜²æŠ¤.html-7168098e.js" as="script"><link rel="prefetch" href="/assets/07-Security-é›†æˆ.html-a1a946cb.js" as="script"><link rel="prefetch" href="/assets/08-Security-é…ç½®.html-2f4d2574.js" as="script"><link rel="prefetch" href="/assets/09-Security-æµ‹è¯•.html-893d2d46.js" as="script"><link rel="prefetch" href="/assets/01-KIEå…¥é—¨.html-fda1b20a.js" as="script"><link rel="prefetch" href="/assets/02-Droolsè§„åˆ™å¼•æ“.html-6f77280a.js" as="script"><link rel="prefetch" href="/assets/03-è§„åˆ™è¯­è¨€å‚è€ƒ.html-3d7248e9.js" as="script"><link rel="prefetch" href="/assets/04-Droolsé›†æˆSpringBoot.html-796352f3.js" as="script"><link rel="prefetch" href="/assets/05-WorkBench.html-c123deb2.js" as="script"><link rel="prefetch" href="/assets/è§„åˆ™è¯­è¨€-DRL.html-2af03ffb.js" as="script"><link rel="prefetch" href="/assets/è§„åˆ™è¯­è¨€-DSL.html-010569c2.js" as="script"><link rel="prefetch" href="/assets/01-å¿«é€Ÿå…¥é—¨.html-b760a94d.js" as="script"><link rel="prefetch" href="/assets/02-è¯»Excel.html-a07061a1.js" as="script"><link rel="prefetch" href="/assets/03-å†™Excel.html-584252a2.js" as="script"><link rel="prefetch" href="/assets/04-å¡«å……Excel.html-c56cea8f.js" as="script"><link rel="prefetch" href="/assets/01-å­¦ä¹ ç½‘ç«™æ¨è.html-574058d0.js" as="script"><link rel="prefetch" href="/assets/02-Gitå‘½ä»¤æ¸…å•.html-3d3336cf.js" as="script"><link rel="prefetch" href="/assets/03-GitHubæ–‡æ¡£.html-44317a1d.js" as="script"><link rel="prefetch" href="/assets/04-GitLabæ–‡æ¡£.html-2f2b01c7.js" as="script"><link rel="prefetch" href="/assets/05-Gitå¿«é€Ÿå…¥é—¨.html-cee5eaa6.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼ç®—æ³•-Snowflake_ID.html-0bc9a74e.js" as="script"><link rel="prefetch" href="/assets/æ’åº-å†’æ³¡æ’åºï¼ˆBubble_sortï¼‰.html-fae410d1.js" as="script"><link rel="prefetch" href="/assets/æ’åº-å¿«é€Ÿæ’åºï¼ˆQuick_Sortï¼‰.html-d02363db.js" as="script"><link rel="prefetch" href="/assets/æ’åº-æ’å…¥æ’åºï¼ˆInsertion_sortï¼‰.html-7efce1d6.js" as="script"><link rel="prefetch" href="/assets/æ’åº-é€‰æ‹©æ’åºï¼ˆSelection_sortï¼‰.html-50302f8c.js" as="script"><link rel="prefetch" href="/assets/01-Linuxæ¦‚è¿°.html-1a3ba019.js" as="script"><link rel="prefetch" href="/assets/02-Linuxå®‰è£…ä¸Šæ‰‹.html-7b637931.js" as="script"><link rel="prefetch" href="/assets/03-LinuxåŸºæœ¬å‘½ä»¤.html-d4fbf2b2.js" as="script"><link rel="prefetch" href="/assets/404.html-b10f6432.js" as="script"><link rel="prefetch" href="/assets/index.html-e75a1ed6.js" as="script"><link rel="prefetch" href="/assets/index.html-8719687e.js" as="script"><link rel="prefetch" href="/assets/index.html-0c94c342.js" as="script"><link rel="prefetch" href="/assets/index.html-4cb35189.js" as="script"><link rel="prefetch" href="/assets/index.html-5ed53dd2.js" as="script"><link rel="prefetch" href="/assets/index.html-35b6fb91.js" as="script"><link rel="prefetch" href="/assets/index.html-cfa04701.js" as="script"><link rel="prefetch" href="/assets/index.html-6db625f4.js" as="script"><link rel="prefetch" href="/assets/index.html-5e5e758f.js" as="script"><link rel="prefetch" href="/assets/index.html-adffcd88.js" as="script"><link rel="prefetch" href="/assets/index.html-0787a469.js" as="script"><link rel="prefetch" href="/assets/index.html-a13adb06.js" as="script"><link rel="prefetch" href="/assets/index.html-dfb454d7.js" as="script"><link rel="prefetch" href="/assets/index.html-21bbf71a.js" as="script"><link rel="prefetch" href="/assets/index.html-fce1788f.js" as="script"><link rel="prefetch" href="/assets/index.html-83bf3b28.js" as="script"><link rel="prefetch" href="/assets/index.html-83a45dfc.js" as="script"><link rel="prefetch" href="/assets/index.html-b84486d7.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-1464cdb9.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/"><img class="vp-nav-logo light" src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-11-03-091254.gif" alt="JavGo"><img class="vp-nav-logo dark" src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-11-03-091254.gif" alt="JavGo"><span class="vp-site-name hide-in-pad">JavGo</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="ä¸»é¡µ" class="vp-link nav-link nav-link" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://theme-hope.vuejs.press/zh/" rel="noopener noreferrer" target="_blank" aria-label="APIï½œæ–‡æ¡£" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>APIï½œæ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="åœ¨çº¿å·¥å…·"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>åœ¨çº¿å·¥å…·</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Bar</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="Baz" class="vp-link nav-link nav-link" href="/guide/bar/baz.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Baz<!----></a></li><li class="dropdown-subitem"><a aria-label="..." class="vp-link nav-link nav-link" href="/guide/bar/"><span class="font-icon icon fa-fw fa-sm fas fa-ellipsis" style=""></span>...<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Foo</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="Ray" class="vp-link nav-link nav-link" href="/guide/foo/ray.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Ray<!----></a></li><li class="dropdown-subitem"><a aria-label="..." class="vp-link nav-link nav-link" href="/guide/foo/"><span class="font-icon icon fa-fw fa-sm fas fa-ellipsis" style=""></span>...<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/javgocn/javgocn" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="ä¸»é¡µ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä¸»é¡µ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><span class="vp-sidebar-title">Java</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">æ ¸å¿ƒåŸºç¡€</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">é›†åˆæ¡†æ¶</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading active"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Spring</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Spring Boot</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><!----><span class="vp-sidebar-title">Spring Cloud</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a aria-label="00-cloud-å¯¼è¯­" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/Spring/SpringCloud/00-cloud-%E5%AF%BC%E8%AF%AD.html"><!---->00-cloud-å¯¼è¯­<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="01-cloud-å¾®æœåŠ¡æ¶æ„çš„å†å²æ¼”è¿›" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/Spring/SpringCloud/01-cloud-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E7%9A%84%E5%8E%86%E5%8F%B2%E6%BC%94%E8%BF%9B.html"><!---->01-cloud-å¾®æœåŠ¡æ¶æ„çš„å†å²æ¼”è¿›<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="02-cloud-SpringCloudæ¦‚è¿°" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/Spring/SpringCloud/02-cloud-SpringCloud%E6%A6%82%E8%BF%B0.html"><!---->02-cloud-SpringCloudæ¦‚è¿°<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="03-cloud-å®æˆ˜é¡¹ç›®è¯´æ˜" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/Spring/SpringCloud/03-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E8%AF%B4%E6%98%8E.html"><!---->03-cloud-å®æˆ˜é¡¹ç›®è¯´æ˜<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="04-cloud-å®æˆ˜é¡¹ç›®æ­å»º" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html"><!---->04-cloud-å®æˆ˜é¡¹ç›®æ­å»º<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1.æ­å»ºå¼€å‘ç¯å¢ƒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_1-æ­å»ºå¼€å‘ç¯å¢ƒ"><!---->1.æ­å»ºå¼€å‘ç¯å¢ƒ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1.1 ç¯å¢ƒå‡†å¤‡ï¼šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ“ä½œç³»ç»Ÿ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_1-1-ç¯å¢ƒå‡†å¤‡-é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ“ä½œç³»ç»Ÿ"><!---->1.1 ç¯å¢ƒå‡†å¤‡ï¼šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ“ä½œç³»ç»Ÿ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.2 Homebrewï¼šMac ä¸Šçš„è½¯ä»¶ç®¡ç†ç¥å™¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_1-2-homebrew-mac-ä¸Šçš„è½¯ä»¶ç®¡ç†ç¥å™¨"><!---->1.2 Homebrewï¼šMac ä¸Šçš„è½¯ä»¶ç®¡ç†ç¥å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.3 Java å’Œ Mavenï¼šé«˜æ•ˆ Java å¼€å‘çš„å…³é”®" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_1-3-java-å’Œ-maven-é«˜æ•ˆ-java-å¼€å‘çš„å…³é”®"><!---->1.3 Java å’Œ Mavenï¼šé«˜æ•ˆ Java å¼€å‘çš„å…³é”®<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.4 IntelliJ IDEAï¼šJava å¼€å‘çš„åˆ©å™¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_1-4-intellij-idea-java-å¼€å‘çš„åˆ©å™¨"><!---->1.4 IntelliJ IDEAï¼šJava å¼€å‘çš„åˆ©å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.5 Lombokï¼šä»£ç ç®€åŒ–ç¥å™¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_1-5-lombok-ä»£ç ç®€åŒ–ç¥å™¨"><!---->1.5 Lombokï¼šä»£ç ç®€åŒ–ç¥å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.6 MySQL åŠå…¶å¯è§†åŒ–å·¥å…·ï¼šæ„å»ºé«˜æ•ˆæ•°æ®ç¯å¢ƒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_1-6-mysql-åŠå…¶å¯è§†åŒ–å·¥å…·-æ„å»ºé«˜æ•ˆæ•°æ®ç¯å¢ƒ"><!---->1.6 MySQL åŠå…¶å¯è§†åŒ–å·¥å…·ï¼šæ„å»ºé«˜æ•ˆæ•°æ®ç¯å¢ƒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.7 æ¶ˆæ¯ä¸­é—´ä»¶ï¼šRabbitMQ çš„å®‰è£…ä¸é…ç½®" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_1-7-æ¶ˆæ¯ä¸­é—´ä»¶-rabbitmq-çš„å®‰è£…ä¸é…ç½®"><!---->1.7 æ¶ˆæ¯ä¸­é—´ä»¶ï¼šRabbitMQ çš„å®‰è£…ä¸é…ç½®<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.8 å­˜å‚¨ç³»ç»Ÿï¼šRedis çš„å®‰è£…ä¸é…ç½®" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_1-8-å­˜å‚¨ç³»ç»Ÿ-redis-çš„å®‰è£…ä¸é…ç½®"><!---->1.8 å­˜å‚¨ç³»ç»Ÿï¼šRedis çš„å®‰è£…ä¸é…ç½®<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.æ­å»ºä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_2-æ­å»ºä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡"><!---->2.æ­å»ºä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="2.1 æ·»åŠ  Maven ä¾èµ–é¡¹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_2-1-æ·»åŠ -maven-ä¾èµ–é¡¹"><!---->2.1 æ·»åŠ  Maven ä¾èµ–é¡¹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.4 æ­å»º coupon-template-api æ¨¡å—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_2-4-æ­å»º-coupon-template-api-æ¨¡å—"><!---->2.4 æ­å»º coupon-template-api æ¨¡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.5 æ­å»º coupon-template-dao æ¨¡å—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_2-5-æ­å»º-coupon-template-dao-æ¨¡å—"><!---->2.5 æ­å»º coupon-template-dao æ¨¡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.6 æ­å»º coupon-template-impl æ¨¡å—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_2-6-æ­å»º-coupon-template-impl-æ¨¡å—"><!---->2.6 æ­å»º coupon-template-impl æ¨¡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.æ­å»ºä¼˜æƒ åˆ¸è®¡ç®—æœåŠ¡" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_3-æ­å»ºä¼˜æƒ åˆ¸è®¡ç®—æœåŠ¡"><!---->3.æ­å»ºä¼˜æƒ åˆ¸è®¡ç®—æœåŠ¡<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="3.1 æ­å»º coupon-calculation-api æ¨¡å—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_3-1-æ­å»º-coupon-calculation-api-æ¨¡å—"><!---->3.1 æ­å»º coupon-calculation-api æ¨¡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.2 æ­å»º coupon-calculation-impl æ¨¡å—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_3-2-æ­å»º-coupon-calculation-impl-æ¨¡å—"><!---->3.2 æ­å»º coupon-calculation-impl æ¨¡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.æ­å»ºç”¨æˆ·æœåŠ¡" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_4-æ­å»ºç”¨æˆ·æœåŠ¡"><!---->4.æ­å»ºç”¨æˆ·æœåŠ¡<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="4.1 æ­å»º coupon-customer-api æ¨¡å—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_4-1-æ­å»º-coupon-customer-api-æ¨¡å—"><!---->4.1 æ­å»º coupon-customer-api æ¨¡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.2 æ­å»º coupon-customer-dao æ¨¡å—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_4-2-æ­å»º-coupon-customer-dao-æ¨¡å—"><!---->4.2 æ­å»º coupon-customer-dao æ¨¡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.3 æ­å»º coupon-customer-impl æ¨¡å—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_4-3-æ­å»º-coupon-customer-impl-æ¨¡å—"><!---->4.3 æ­å»º coupon-customer-impl æ¨¡å—<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.é¡¹ç›®æ€»ç»“" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/md/Spring/SpringCloud/04-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#_5-é¡¹ç›®æ€»ç»“"><!---->5.é¡¹ç›®æ€»ç»“<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="05-cloud-æœåŠ¡æ²»ç†" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/Spring/SpringCloud/05-cloud-%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86.html"><!---->05-cloud-æœåŠ¡æ²»ç†<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Spring Framework</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Spring Security</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">å‘½ä»¤æ‰‹å†Œ</span><!----></p><ul class="vp-sidebar-links"><li><!--[--><a aria-label="Docker" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/Docker.html"><!---->Docker<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Git" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/Git.html"><!---->Git<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Homebrew" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/Homebrew.html"><!---->Homebrew<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="JDK" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/JDK.html"><!---->JDK<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Linux" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/Linux.html"><!---->Linux<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="MacOS" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/MacOS.html"><!---->MacOS<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Maven" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/md/%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/Maven.html"><!---->Maven<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">å¸¸ç”¨æ¡†æ¶</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Drools</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Easy Excel</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">å¸¸ç”¨ç±»åº“</span><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">å¼€å‘å·¥å…·</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Git</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">æ•°æ®åº“</span><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">æ–¹æ³•è®º</span><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">æ ¸å¿ƒåŸºç¡€</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">å¸¸è§ç®—æ³•</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">æ¶ˆæ¯å¼•æ“</span><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">éƒ¨ç½²ç›¸å…³</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Linux</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">å…«è‚¡æ–‡</span><!----></p><ul class="vp-sidebar-links"></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->04-cloud-å®æˆ˜é¡¹ç›®æ­å»º</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://www.javgo.cn" target="_blank" rel="noopener noreferrer">Mr.JavGo</a></span><span property="author" content="Mr.JavGo"></span></span><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-11-10T16:14:41.000Z"></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 65 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT65M"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_1-æ­å»ºå¼€å‘ç¯å¢ƒ">1.æ­å»ºå¼€å‘ç¯å¢ƒ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-1-ç¯å¢ƒå‡†å¤‡-é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ“ä½œç³»ç»Ÿ">1.1 ç¯å¢ƒå‡†å¤‡ï¼šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ“ä½œç³»ç»Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-2-homebrew-mac-ä¸Šçš„è½¯ä»¶ç®¡ç†ç¥å™¨">1.2 Homebrewï¼šMac ä¸Šçš„è½¯ä»¶ç®¡ç†ç¥å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-3-java-å’Œ-maven-é«˜æ•ˆ-java-å¼€å‘çš„å…³é”®">1.3 Java å’Œ Mavenï¼šé«˜æ•ˆ Java å¼€å‘çš„å…³é”®</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-4-intellij-idea-java-å¼€å‘çš„åˆ©å™¨">1.4 IntelliJ IDEAï¼šJava å¼€å‘çš„åˆ©å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-5-lombok-ä»£ç ç®€åŒ–ç¥å™¨">1.5 Lombokï¼šä»£ç ç®€åŒ–ç¥å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-6-mysql-åŠå…¶å¯è§†åŒ–å·¥å…·-æ„å»ºé«˜æ•ˆæ•°æ®ç¯å¢ƒ">1.6 MySQL åŠå…¶å¯è§†åŒ–å·¥å…·ï¼šæ„å»ºé«˜æ•ˆæ•°æ®ç¯å¢ƒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-7-æ¶ˆæ¯ä¸­é—´ä»¶-rabbitmq-çš„å®‰è£…ä¸é…ç½®">1.7 æ¶ˆæ¯ä¸­é—´ä»¶ï¼šRabbitMQ çš„å®‰è£…ä¸é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-8-å­˜å‚¨ç³»ç»Ÿ-redis-çš„å®‰è£…ä¸é…ç½®">1.8 å­˜å‚¨ç³»ç»Ÿï¼šRedis çš„å®‰è£…ä¸é…ç½®</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_2-æ­å»ºä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡">2.æ­å»ºä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_2-1-æ·»åŠ -maven-ä¾èµ–é¡¹">2.1 æ·»åŠ  Maven ä¾èµ–é¡¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_2-4-æ­å»º-coupon-template-api-æ¨¡å—">2.4 æ­å»º coupon-template-api æ¨¡å—</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_2-5-æ­å»º-coupon-template-dao-æ¨¡å—">2.5 æ­å»º coupon-template-dao æ¨¡å—</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_2-6-æ­å»º-coupon-template-impl-æ¨¡å—">2.6 æ­å»º coupon-template-impl æ¨¡å—</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_3-æ­å»ºä¼˜æƒ åˆ¸è®¡ç®—æœåŠ¡">3.æ­å»ºä¼˜æƒ åˆ¸è®¡ç®—æœåŠ¡</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_3-1-æ­å»º-coupon-calculation-api-æ¨¡å—">3.1 æ­å»º coupon-calculation-api æ¨¡å—</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_3-2-æ­å»º-coupon-calculation-impl-æ¨¡å—">3.2 æ­å»º coupon-calculation-impl æ¨¡å—</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_4-æ­å»ºç”¨æˆ·æœåŠ¡">4.æ­å»ºç”¨æˆ·æœåŠ¡</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_4-1-æ­å»º-coupon-customer-api-æ¨¡å—">4.1 æ­å»º coupon-customer-api æ¨¡å—</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_4-2-æ­å»º-coupon-customer-dao-æ¨¡å—">4.2 æ­å»º coupon-customer-dao æ¨¡å—</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_4-3-æ­å»º-coupon-customer-impl-æ¨¡å—">4.3 æ­å»º coupon-customer-impl æ¨¡å—</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_5-é¡¹ç›®æ€»ç»“">5.é¡¹ç›®æ€»ç»“</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h2 id="_1-æ­å»ºå¼€å‘ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#_1-æ­å»ºå¼€å‘ç¯å¢ƒ" aria-hidden="true">#</a> 1.æ­å»ºå¼€å‘ç¯å¢ƒ</h2><p>â€œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨â€â€”â€”è¿™ä¸ªå¤ä»£çš„æ ¼è¨€åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­ä¾ç„¶é€‚ç”¨ã€‚å¼€å‘ç¯å¢ƒçš„æ­å»ºæ˜¯è¿›è¡Œé«˜æ•ˆè½¯ä»¶å¼€å‘çš„åŸºç¡€ï¼Œç¡®ä¿åœ¨é¡¹ç›®å®æ–½è¿‡ç¨‹ä¸­ç³»ç»Ÿè¿è¡Œçš„ç¨³å®šæ€§ä¸ä¸€è‡´æ€§ã€‚åœ¨æ·±å…¥é¡¹ç›®å®æˆ˜ä¹‹å‰ï¼Œå…³é”®åœ¨äºå»ºç«‹ä¸€ä¸ªå¥å…¨ä¸”å¯é çš„å¼€å‘ç¯å¢ƒï¼Œä»¥é¿å…åæœŸç”±äºç¯å¢ƒé…ç½®ä¸å½“å¸¦æ¥çš„ç§ç§é—®é¢˜å’ŒæŒ‘æˆ˜ã€‚</p><ol><li><p><strong>å¼€å‘ç¯å¢ƒçš„ç»Ÿä¸€æ ‡å‡†åŒ–</strong></p><p>é¦–å…ˆï¼Œç»Ÿä¸€çš„å¼€å‘ç¯å¢ƒé…ç½®æ˜¯ä¿éšœé¡¹ç›®å›¢é˜Ÿåä½œé¡ºç•…çš„é‡è¦å› ç´ ã€‚æˆ‘ä»¬éœ€ç¡®ä¿å„å¼€å‘ç»„ä»¶ï¼Œå¦‚ Javaã€Maven å’Œå…¶ä»–ç›¸å…³ä¸­é—´ä»¶çš„ç‰ˆæœ¬ç»Ÿä¸€ã€‚ç‰ˆæœ¬çš„ç»Ÿä¸€æœ‰åŠ©äºå‡å°‘å› ç¯å¢ƒå·®å¼‚å¯¼è‡´çš„é—®é¢˜ï¼Œå¦‚å…¼å®¹æ€§é—®é¢˜æˆ–åŠŸèƒ½å·®å¼‚ï¼Œä»è€Œä¿è¯é¡¹ç›®çš„è¿›åº¦å’Œè´¨é‡ã€‚</p></li><li><p><strong>å…³é”®ä¸­é—´ä»¶çš„é€‰æ‹©ä¸æ­å»º</strong></p><p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€‰ç”¨äº†å¤šä¸ªé‡è¦çš„ä¸­é—´ä»¶ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº Spring Cloud çš„æ ¸å¿ƒç»„ä»¶å¦‚ Nacosã€Sentinelã€Zipkin å’Œ Seataã€‚é€‰æ‹©è¿™äº›ä¸­é—´ä»¶æ˜¯ä¸ºäº†æé«˜é¡¹ç›®çš„å¯é æ€§ã€ç›‘æ§èƒ½åŠ›åŠåˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†ã€‚æˆ‘ä»¬å°†åœ¨åç»­ç« èŠ‚ä¸­é€ä¸€æ·±å…¥ä»‹ç»è¿™äº›ä¸­é—´ä»¶çš„ä½œç”¨ã€å®‰è£…è¿‡ç¨‹å’Œé…ç½®æ–¹æ³•ã€‚</p></li><li><p><strong>é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰å’Œæ•°æ®åº“çš„è®¾ç½®</strong></p><p>æˆ‘ä»¬è¿˜éœ€è¦æ­å»ºé›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ï¼Œå®‰è£…æ•°æ®åº“ï¼Œå¹¶å¯¼å…¥å¿…è¦çš„æ•°æ®åº“è„šæœ¬ã€‚ä¸€ä¸ªé«˜æ•ˆçš„ IDE å¯ä»¥æå¤§æé«˜å¼€å‘æ•ˆç‡ï¼Œè€Œé€‚å½“é…ç½®çš„æ•°æ®åº“æ˜¯ç¡®ä¿æ•°æ®å­˜å–æ•ˆç‡å’Œå®‰å…¨çš„å…³é”®ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šæ¢è®¨å¦‚ä½•å®‰è£…å’Œé…ç½®ä¸€äº›å¸¸ç”¨çš„ä¸­é—´ä»¶ï¼Œä»¥ä¾¿æ›´å¥½åœ°æ”¯æŒåç»­çš„å¼€å‘å·¥ä½œã€‚</p></li></ol><p>OKï¼Œä¸è¯´åºŸè¯äº†ï¼Œæˆ‘ä»¬æ­£å¼å¼€å§‹ï¼</p><h3 id="_1-1-ç¯å¢ƒå‡†å¤‡-é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ“ä½œç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#_1-1-ç¯å¢ƒå‡†å¤‡-é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ“ä½œç³»ç»Ÿ" aria-hidden="true">#</a> 1.1 ç¯å¢ƒå‡†å¤‡ï¼šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ“ä½œç³»ç»Ÿ</h3><p>é€‰æ‹©ä¸€ä¸ªé€‚åˆçš„æ“ä½œç³»ç»Ÿæ˜¯å¼€å‘è¿‡ç¨‹ä¸­çš„ç¬¬ä¸€æ­¥ã€‚é’ˆå¯¹ Java å¼€å‘ï¼Œå¼ºçƒˆæ¨è <strong>Mac ç¬”è®°æœ¬æˆ–è€…åŸºäº Linux çš„æ“ä½œç³»ç»Ÿ</strong>ã€‚Linux ç³»ç»Ÿç”±äºå…¶ç¨³å®šæ€§ã€çµæ´»æ€§ä»¥åŠä¸ç”Ÿäº§ç¯å¢ƒçš„ä¸€è‡´æ€§ï¼Œè¢«å¹¿æ³›è®¤ä¸ºæ˜¯æœåŠ¡å™¨ç«¯åº”ç”¨å’Œå¼€å‘çš„é¦–é€‰ã€‚è€Œ Mac ç³»ç»Ÿï¼Œå‡­å€Ÿå…¶ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒå’Œå¯¹å¼€å‘è€…å‹å¥½çš„ç¯å¢ƒï¼ŒåŒæ ·æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p><p>å¦‚æœä½ ç›®å‰æ˜¯ Windows ç”¨æˆ·ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼å¯ä»¥è·å¾—ç±»ä¼¼ Linux çš„å¼€å‘ä½“éªŒï¼š</p><ol><li><strong>å®‰è£…åŒç³»ç»Ÿ</strong>ï¼šè¿™æ˜¯æœ€æ¥è¿‘çœŸå® Linux ç³»ç»Ÿçš„ä½“éªŒï¼Œä½†å¯èƒ½éœ€è¦é¢å¤–çš„åˆ†åŒºæˆ–ç¡¬ç›˜ç©ºé—´ã€‚</li><li><strong>ä½¿ç”¨ Cygwin æˆ– Ubuntu è™šæ‹Ÿæœº</strong>ï¼šè¿™äº›å·¥å…·å¯ä»¥åœ¨ Windows ç³»ç»Ÿä¸­æ¨¡æ‹Ÿå‡º Linux ç¯å¢ƒï¼Œæ–¹ä¾¿ä¸”é«˜æ•ˆã€‚</li></ol><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°†ä»‹ç»å¦‚ä½•åœ¨ Mac ç³»ç»Ÿä¸Šé…ç½®å¼€å‘ç¯å¢ƒã€‚å°½ç®¡è¿™é‡Œä»¥ Mac ç³»ç»Ÿä¸ºä¾‹ï¼Œä½†ç›¸åŒçš„æ­¥éª¤ä¹Ÿé€‚ç”¨äº Linuxï¼Œåªæ˜¯å®‰è£…æ–¹å¼å¯èƒ½ç•¥æœ‰ä¸åŒã€‚Windows ç”¨æˆ·å¯ä»¥å‚è€ƒå®˜æ–¹ä¸‹è½½é“¾æ¥è¿›è¡Œç›¸åº”è½¯ä»¶çš„å®‰è£…ã€‚</p><h3 id="_1-2-homebrew-mac-ä¸Šçš„è½¯ä»¶ç®¡ç†ç¥å™¨" tabindex="-1"><a class="header-anchor" href="#_1-2-homebrew-mac-ä¸Šçš„è½¯ä»¶ç®¡ç†ç¥å™¨" aria-hidden="true">#</a> 1.2 Homebrewï¼šMac ä¸Šçš„è½¯ä»¶ç®¡ç†ç¥å™¨</h3><p>Homebrew æ˜¯ Mac ä¸Šçš„ä¸€æ¬¾å¼ºå¤§çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå®ƒå¯ä»¥å¤§å¤§ç®€åŒ–è½¯ä»¶çš„å®‰è£…å’Œç®¡ç†è¿‡ç¨‹ã€‚ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ­¥éª¤åœ¨ Mac ä¸Šå®‰è£… Homebrewã€‚</p><p>é¦–å…ˆï¼Œè®¿é—® <a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">Homebrew å®˜æ–¹ç½‘ç«™<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æŸ¥çœ‹è¯¦ç»†çš„å®‰è£…æŒ‡å—ã€‚</p><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-023042.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>/bin/bash <span class="token parameter variable">-c</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span class="token variable">)</span></span>&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç”±äºæŸäº›ç½‘ç»œç¯å¢ƒçš„é™åˆ¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°å®‰è£…é€Ÿåº¦ç¼“æ…¢çš„é—®é¢˜ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆï¼š</p><ol><li><strong>ä½¿ç”¨ VPN</strong>ï¼šè¿™å¯ä»¥æœ‰æ•ˆæé«˜ä¸‹è½½é€Ÿåº¦ï¼Œä½†å¯èƒ½éœ€è¦é¢å¤–çš„è´¹ç”¨æˆ–é…ç½®ã€‚</li><li><strong>åˆ‡æ¢åˆ°å›½å†…é•œåƒæº</strong>ï¼šå¦‚æ¸…åå¤§å­¦æˆ–ä¸­å›½ç§‘æŠ€å¤§å­¦çš„é•œåƒã€‚å®˜æ–¹å®‰è£…æ–‡æ¡£ä¸­æœ‰è¯¦ç»†çš„æ›¿æ¢æ–¹æ³•ã€‚</li></ol><p>å®‰è£…å®Œæˆåï¼Œæ‰§è¡Œ <code>brew -v</code> æ¥éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸã€‚ä½ åº”è¯¥èƒ½çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºä¿¡æ¯ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>âœ  ~ brew <span class="token parameter variable">-v</span>
Homebrew <span class="token number">4.0</span>.28-67-ge9ac36a
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ‰äº† Homebrewï¼Œä½ å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨ <code>brew install</code> å‘½ä»¤å®‰è£…æ‰€éœ€è½¯ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨å›½å†…é•œåƒæ—¶ï¼Œè¯·æ³¨æ„æŸäº›è½¯ä»¶æˆ–ä¾èµ–é¡¹å¯èƒ½å› ç½‘ç»œé—®é¢˜å®‰è£…å¤±è´¥ï¼Œæ­¤æ—¶å¯ä»¥å°è¯•æ ¹æ®é”™è¯¯æ—¥å¿—å•ç‹¬å®‰è£…æœ‰é—®é¢˜çš„ä¾èµ–ç„¶åå†å°è¯•å®‰è£…ç›®æ ‡è½¯ä»¶ã€‚</p><h3 id="_1-3-java-å’Œ-maven-é«˜æ•ˆ-java-å¼€å‘çš„å…³é”®" tabindex="-1"><a class="header-anchor" href="#_1-3-java-å’Œ-maven-é«˜æ•ˆ-java-å¼€å‘çš„å…³é”®" aria-hidden="true">#</a> 1.3 Java å’Œ Mavenï¼šé«˜æ•ˆ Java å¼€å‘çš„å…³é”®</h3><p>Java å’Œ Maven æ˜¯ Java å¼€å‘çš„æ ¸å¿ƒå·¥å…·ï¼Œå…¶ç‰ˆæœ¬é€‰æ‹©å’Œé…ç½®ç›´æ¥å½±å“åˆ°å¼€å‘çš„æ•ˆç‡å’Œé¡¹ç›®çš„ç¨³å®šæ€§ã€‚ä»¥ä¸‹å°†è¯¦ç»†ä»‹ç»å¦‚ä½•é…ç½®è¿™ä¸¤ä¸ªå·¥å…·ï¼Œç¡®ä¿ä¸€ä¸ªé¡ºç•…çš„å¼€å‘æµç¨‹ã€‚</p><p>Java å’Œ Maven ç‰ˆæœ¬é€‰æ‹©ï¼š</p><ul><li><strong>JDK 8</strong>ï¼šè¿™æ˜¯ Java é•¿æœŸæ”¯æŒçš„ç‰ˆæœ¬ä¹‹ä¸€ï¼Œå¹¿æ³›ç”¨äºä¼ä¸šçº§åº”ç”¨ã€‚ä½ å¯ä»¥ä» <a href="https://www.oracle.com/sg/java/technologies/javase/javase8u211-later-archive-downloads.html" target="_blank" rel="noopener noreferrer">Oracle å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ä¸‹è½½ JDK 8 çš„æœ€æ–°å°ç‰ˆæœ¬ã€‚å°½ç®¡è¾ƒæ—§ï¼Œä½†å…¶ç¨³å®šæ€§å’Œå¹¿æ³›çš„åº”ç”¨æ”¯æŒæ˜¯é€‰æ‹©å®ƒçš„ä¸»è¦åŸå› ã€‚</li><li><strong>Maven ç‰ˆæœ¬</strong>ï¼šå»ºè®®ä½¿ç”¨ Maven 3.6 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œä»¥ç¡®ä¿ä¸ç°ä»£ Java ç”Ÿæ€çš„å…¼å®¹æ€§ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ Maven 3.9.3ï¼Œå¯ä» <a href="https://maven.apache.org/download.cgi" target="_blank" rel="noopener noreferrer">Maven å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ä¸‹è½½ã€‚</li></ul><p>ç”±äº Maven ä¸­å¤®ä»“åº“åœ¨å›½å†…è®¿é—®å¯èƒ½å—é™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½® <code>settings.xml</code> æ¥æŒ‡å®šå›½å†…çš„é•œåƒä»“åº“ï¼Œä»¥æé«˜ä¾èµ–åŒ…çš„ä¸‹è½½é€Ÿåº¦ã€‚è¿™é‡Œä»‹ç»ä¸¤ä¸ªå¸¸ç”¨çš„å›½å†…é•œåƒï¼š</p><p><strong>é˜¿é‡Œäº‘é•œåƒ</strong>ï¼šé€Ÿåº¦å¿«ï¼Œè¦†ç›–å¹¿æ³›ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>aliyunmaven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>é˜¿é‡Œäº‘å…¬å…±ä»“åº“<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>https://maven.aliyun.com/repository/public<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>åä¸ºäº‘é•œåƒ</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªé«˜é€Ÿä¸”ç¨³å®šçš„æ›¿ä»£é€‰é¡¹ï¼Œæˆ‘åœ¨è¿™é‡Œä½¿ç”¨åä¸ºäº‘é•œåƒã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>huaweicloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>https://repo.huaweicloud.com/repository/maven/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼ŒJava å’Œ Maven çš„åŸºæœ¬é…ç½®å°±å®Œæˆäº†ã€‚</p><h3 id="_1-4-intellij-idea-java-å¼€å‘çš„åˆ©å™¨" tabindex="-1"><a class="header-anchor" href="#_1-4-intellij-idea-java-å¼€å‘çš„åˆ©å™¨" aria-hidden="true">#</a> 1.4 IntelliJ IDEAï¼šJava å¼€å‘çš„åˆ©å™¨</h3><p>IntelliJ IDEA æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”æµè¡Œçš„ Java é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ï¼Œç”± JetBrains å¼€å‘ã€‚å®ƒä¸ä»…æ”¯æŒ Javaï¼Œè¿˜æ”¯æŒå¤šç§å…¶ä»–ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶ã€‚ä»¥ä¸‹æ˜¯å…¶å®‰è£…æ­¥éª¤ï¼š</p><ol><li><strong>ä¸‹è½½</strong>ï¼šå‰å¾€ <a href="https://www.jetbrains.com/zh-cn/idea/download" target="_blank" rel="noopener noreferrer">JetBrains å®˜æ–¹ç½‘ç«™<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ä¸‹è½½ IntelliJ IDEAã€‚ä½ å¯ä»¥é€‰æ‹©å…è´¹çš„ç¤¾åŒºç‰ˆï¼Œæˆ–æ˜¯å…·æœ‰æ›´å¤šç‰¹æ€§çš„ä»˜è´¹å•†ä¸šç‰ˆã€‚</li><li><strong>å®‰è£…</strong>ï¼šæ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿï¼Œæ‰§è¡Œå®‰è£…ç¨‹åºã€‚è¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©å®‰è£…ä½ç½®ã€åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼ç­‰ã€‚</li><li><strong>é…ç½®</strong>ï¼šåˆæ¬¡å¯åŠ¨ IntelliJ IDEA åï¼Œä½ ä¼šè¢«å¼•å¯¼å®Œæˆä¸€äº›åŸºç¡€é…ç½®ï¼Œæ¯”å¦‚ç•Œé¢ä¸»é¢˜ã€ç¼–è¾‘å™¨è®¾ç½®ç­‰ã€‚</li><li><strong>æ¿€æ´»</strong>ï¼šå¦‚æœä½ ä½¿ç”¨å•†ä¸šç‰ˆï¼Œéœ€è¦è¿›è¡Œæ¿€æ´»ã€‚å­¦ç”Ÿå’Œæ•™å¸ˆå¯é€šè¿‡æ•™è‚²é‚®ç®±ç”³è¯·å…è´¹çš„å•†ä¸šç‰ˆæˆæƒã€‚</li></ol><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-024538.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-5-lombok-ä»£ç ç®€åŒ–ç¥å™¨" tabindex="-1"><a class="header-anchor" href="#_1-5-lombok-ä»£ç ç®€åŒ–ç¥å™¨" aria-hidden="true">#</a> 1.5 Lombokï¼šä»£ç ç®€åŒ–ç¥å™¨</h3><p>Lombok æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„ Java åº“ï¼Œç”¨äºè‡ªåŠ¨åŒ–å¸¸è§çš„æ¨¡æ¿ä»£ç ï¼Œå¦‚ gettersã€settersã€equalsã€hashCode å’Œ toString æ–¹æ³•ã€‚</p><p>åœ¨ IntelliJ IDEA ä¸­ï¼Œå®‰è£… Lombok éå¸¸ç®€å•ã€‚åªéœ€åœ¨ IDEA çš„æ’ä»¶å¸‚åœºä¸­æœç´¢å¹¶å®‰è£… Lombok æ’ä»¶å³å¯ï¼š</p><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-024723.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ¥ç€å¯ç”¨æ³¨è§£å¤„ç†å™¨ï¼Œåœ¨ â€œSettingsâ€ ä¸­ï¼Œè¿›å…¥ â€œBuild, Execution, Deploymentâ€ &gt; â€œCompilerâ€ &gt; â€œAnnotation Processorsâ€ã€‚ç¡®ä¿å‹¾é€‰ â€œEnable annotation processingâ€ï¼š</p><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-10-29-121745.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä¸ºäº†åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Lombokï¼Œç¡®ä¿ä½ çš„ <code>pom.xml</code> æˆ– <code>build.gradle</code> æ–‡ä»¶ä¸­åŠ å…¥äº† Lombok ä¾èµ–ã€‚Maven ç¤ºä¾‹ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>æœ€æ–°ç‰ˆæœ¬<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-6-mysql-åŠå…¶å¯è§†åŒ–å·¥å…·-æ„å»ºé«˜æ•ˆæ•°æ®ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#_1-6-mysql-åŠå…¶å¯è§†åŒ–å·¥å…·-æ„å»ºé«˜æ•ˆæ•°æ®ç¯å¢ƒ" aria-hidden="true">#</a> 1.6 MySQL åŠå…¶å¯è§†åŒ–å·¥å…·ï¼šæ„å»ºé«˜æ•ˆæ•°æ®ç¯å¢ƒ</h3><p>æˆ‘ä»¬å°†ä½¿ç”¨ MySQL ä½œä¸ºæ ¸å¿ƒæ•°æ®åº“ã€‚å¦‚æœä½ çš„ç³»ç»Ÿä¸­å·²ç»å®‰è£…äº† MariaDBï¼Œæ— éœ€æ‹…å¿ƒï¼Œå› ä¸º MariaDB æ˜¯ MySQL çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œç”± MySQL çš„åˆ›å§‹äººä¹‹ä¸€å¼€å‘ï¼Œå¹¶ä¿æŒä¸ MySQL çš„é«˜åº¦å…¼å®¹æ€§ã€‚</p><p>å®‰è£… MySQL éå¸¸ç®€ä¾¿ã€‚Mac ç”¨æˆ·å¯ä»¥é€šè¿‡ Homebrew è¿›è¡Œå®‰è£…ï¼Œåªéœ€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>brew <span class="token function">install</span> mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Windows æˆ– Linux ç”¨æˆ·å¯è®¿é—® <a href="https://dev.mysql.com/downloads/mysql" target="_blank" rel="noopener noreferrer">MySQL å®˜æ–¹ç½‘ç«™<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œä¸‹è½½ç›¸åº”å¹³å°çš„ç¤¾åŒºç‰ˆå®‰è£…åŒ…ã€‚ç¤¾åŒºç‰ˆå·²å……åˆ†æ»¡è¶³æˆ‘ä»¬å®æˆ˜é¡¹ç›®çš„éœ€æ±‚ã€‚</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-025049.png" style="zoom:33%;"><p>å®Œæˆå®‰è£…åï¼Œå¯ä»¥ç”¨ä»¥ä¸‹ä»»ä¸€æ–¹æ³•å¯åŠ¨ MySQLï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ä½¿ç”¨ mysql.server å¯åŠ¨</span>
mysql.server start

<span class="token comment"># ä½¿ç”¨ brew services å¯åŠ¨ï¼ˆæ¨èï¼‰</span>
brew services start mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ ·åœ°ï¼Œè¦å…³é—­ MySQLï¼Œå¯ç”¨å¯¹åº”çš„å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ä½¿ç”¨ mysql.server åœæ­¢</span>
mysql.server stop

<span class="token comment"># ä½¿ç”¨ brew services åœæ­¢ï¼ˆæ¨èï¼‰</span>
brew services stop mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>TIPï¼šä½¿ç”¨ <code>brew services</code> ç®¡ç† MySQL æœåŠ¡æ—¶ï¼Œ<code>brew services stop mysql</code> ä¸ä»…èƒ½æ–¹ä¾¿åœ°åœæ­¢æœåŠ¡ï¼Œè¿˜å¯é˜²æ­¢ç³»ç»Ÿé‡å¯æ—¶ MySQL è‡ªåŠ¨å¯åŠ¨ã€‚</p></blockquote><p>ä¸ºéªŒè¯ MySQL æ˜¯å¦æ­£ç¡®å®‰è£…ï¼Œå°è¯•ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç™»å½•ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¿™é‡Œä½¿ç”¨é»˜è®¤çš„ root ç”¨æˆ·ç™»å½•ï¼ˆåˆå§‹å¯†ç ä¸ºç©ºï¼‰ã€‚ç™»å½•æˆåŠŸåï¼Œä¼šè§åˆ°ç±»ä¼¼ä¸‹æ–¹çš„ç•Œé¢ï¼Œè¡¨ç¤º MySQL å®‰è£…å¹¶è¿è¡Œæ­£å¸¸ï¼š</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-030049.png" style="zoom:50%;"><p>ç™»å½•åï¼Œå»ºè®®ç«‹å³ä¿®æ”¹ root ç”¨æˆ·çš„å¯†ç ï¼Œæé«˜æ•°æ®åº“å®‰å…¨æ€§ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">&#39;root&#39;</span><span class="token variable">@&#39;localhost&#39;</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;æ–°å¯†ç &#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç»§ MySQL å®‰è£…åï¼Œä¸ºäº†æ›´é«˜æ•ˆåœ°ç®¡ç†æ•°æ®åº“ï¼Œæˆ‘æ¨èä½¿ç”¨ DataGripï¼Œå®ƒæ˜¯ JetBrains å¼€å‘çš„ä¸€æ¬¾å¼ºå¤§çš„æ•°æ®åº“ç®¡ç†å·¥å…·ã€‚DataGrip æ”¯æŒ MySQL ä»¥åŠå¤šç§å…¶ä»–æ•°æ®åº“ï¼Œæä¾›ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå¦‚ä»£ç è‡ªåŠ¨å®Œæˆã€åˆ†æå’Œé‡æ„ç­‰ã€‚</p><p>è®¿é—® <a href="https://www.jetbrains.com/zh-cn/datagrip/download" target="_blank" rel="noopener noreferrer">DataGrip å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œé€‰æ‹©é€‚åˆä½ æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬ä¸‹è½½ï¼š</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-025527.png" style="zoom:33%;"><p>å®‰è£…å¹¶å¯åŠ¨ DataGrip åï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ªæ•°æ®æºæ¥è¿æ¥æœ¬åœ°çš„ MySQL æ•°æ®åº“ï¼š</p><ol><li>åœ¨ DataGrip ä¸­ï¼Œç‚¹å‡» &quot;æ·»åŠ æ•°æ®æº&quot;ã€‚</li><li>é€‰æ‹© MySQLã€‚</li><li>è¾“å…¥æ•°æ®åº“è¿æ¥è¯¦æƒ…ï¼š <ul><li><strong>ç”¨æˆ·å</strong>ï¼šrootï¼ˆæˆ–ä½ çš„è‡ªå®šä¹‰ç”¨æˆ·åï¼‰</li><li><strong>å¯†ç </strong>ï¼šï¼ˆç•™ç©ºæˆ–è¾“å…¥ä½ è®¾ç½®çš„å¯†ç ï¼‰</li><li><strong>JDBC URL</strong>ï¼š<code>jdbc:mysql://localhost:3306</code></li></ul></li><li>ç¡®ä¿å·²å®‰è£… MySQL JDBC é©±åŠ¨ã€‚å¦‚æœæœªå®‰è£…ï¼ŒDataGrip é€šå¸¸ä¼šæç¤ºä¸‹è½½ã€‚</li></ol><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-032416.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å®Œæˆè¿™äº›æ­¥éª¤åï¼Œç‚¹å‡» &quot;æµ‹è¯•è¿æ¥&quot; æ£€æŸ¥æ˜¯å¦èƒ½å¤ŸæˆåŠŸè¿æ¥åˆ°æ•°æ®åº“ã€‚è¿æ¥æˆåŠŸæ„å‘³ç€ä½ ç°åœ¨å¯ä»¥é€šè¿‡ DataGrip æ¥ç®¡ç† MySQL æ•°æ®åº“ï¼Œè¿›è¡ŒæŸ¥è¯¢ã€ç¼–è¾‘ã€ç®¡ç†æ•°æ®è¡¨ç­‰æ“ä½œã€‚</p><p>åœ¨å®æˆ˜é¡¹ç›®å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåœ¨ MySQL ä¸­æ„å»ºé¡¹ç›®æ‰€éœ€çš„æ•°æ®åº“å’Œæ•°æ®è¡¨ã€‚è¿™ä¸ªè¿‡ç¨‹å¯¹äºæ•´ä¸ªé¡¹ç›®çš„æ•°æ®ç®¡ç†è‡³å…³é‡è¦ã€‚</p><p><strong>åˆ›å»ºæ•°æ®åº“</strong>ï¼šæˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªåä¸º <code>coupon_db</code> çš„æ•°æ®åº“ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰ä¸ä¼˜æƒ åˆ¸ç›¸å…³çš„æ•°æ®ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- åˆ›å»ºæ•°æ®åº“ coupon_db</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> coupon_db<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>åˆ›å»º <code>coupon_template</code> æ•°æ®è¡¨</strong>ï¼šè¯¥è¡¨ç”¨äºå­˜å‚¨ä¼˜æƒ åˆ¸æ¨¡æ¿çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ä¼˜æƒ åˆ¸åç§°ã€ç±»å‹ã€é€‚ç”¨é—¨åº—ç­‰ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- å¦‚æœå­˜åœ¨åŒåè¡¨åˆ™åˆ é™¤ï¼Œç„¶ååˆ›å»º coupon_template æ•°æ®è¡¨</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>coupon_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>coupon_template<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>coupon_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>coupon_template<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
     <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span>                   <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¸»é”®&#39;</span><span class="token punctuation">,</span>
     <span class="token identifier"><span class="token punctuation">`</span>available<span class="token punctuation">`</span></span>        <span class="token keyword">boolean</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">false</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¼˜æƒ åˆ¸å¯ç”¨çŠ¶æ€ï¼Œé»˜è®¤ä¸º false è¡¨ç¤ºä¸èƒ½ä½¿ç”¨&#39;</span><span class="token punctuation">,</span>
     <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span>              <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¼˜æƒ åˆ¸åç§°&#39;</span><span class="token punctuation">,</span>
     <span class="token identifier"><span class="token punctuation">`</span>description<span class="token punctuation">`</span></span>     <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¼˜æƒ åˆ¸è¯¦ç»†ä¿¡æ¯&#39;</span><span class="token punctuation">,</span>
     <span class="token identifier"><span class="token punctuation">`</span>type<span class="token punctuation">`</span></span>                <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¼˜æƒ åˆ¸ç±»å‹&#39;</span><span class="token punctuation">,</span>
     <span class="token identifier"><span class="token punctuation">`</span>shop_id<span class="token punctuation">`</span></span>           <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;é€‚ç”¨çš„é—¨åº—ï¼Œç©ºä»£è¡¨å…¨åœºé€‚ç”¨&#39;</span><span class="token punctuation">,</span>
     <span class="token identifier"><span class="token punctuation">`</span>created_time<span class="token punctuation">`</span></span>   <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;2023-09-17 00:00:00&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;åˆ›å»ºæ—¶é—´&#39;</span><span class="token punctuation">,</span>
     <span class="token identifier"><span class="token punctuation">`</span>rule<span class="token punctuation">`</span></span>                 <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä½¿ç”¨è§„åˆ™&#39;</span><span class="token punctuation">,</span>
     
     <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_shop_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>shop_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">&#39;ä¼˜æƒ åˆ¸æ¨¡æ¿&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>åˆ›å»º <code>coupon</code> æ•°æ®è¡¨</strong>ï¼šæ­¤è¡¨è®°å½•ç”¨æˆ·é¢†å–çš„ä¼˜æƒ åˆ¸ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·IDã€é¢†åˆ¸æ—¶é—´ã€ä¼˜æƒ åˆ¸çŠ¶æ€ç­‰ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- å¦‚æœå­˜åœ¨åŒåè¡¨åˆ™åˆ é™¤ï¼Œç„¶ååˆ›å»º coupon æ•°æ®è¡¨</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>coupon_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>coupon<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>coupon_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>coupon<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span>                    <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¸»é”®&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>template_id<span class="token punctuation">`</span></span>    <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;0&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¼˜æƒ åˆ¸æ¨¡ç‰ˆID&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span>           <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;0&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ç”¨æˆ·ID&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>created_time<span class="token punctuation">`</span></span>  <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;2023-09-17 00:00:00&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;é¢†åˆ¸æ—¶é—´&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span>              <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;0&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¼˜æƒ åˆ¸çŠ¶æ€&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>shop_id<span class="token punctuation">`</span></span>          <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;å†—ä½™å­—æ®µï¼Œæ–¹ä¾¿æŸ¥æ‰¾&#39;</span><span class="token punctuation">,</span>

    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_user_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_template_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>template_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">10</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">&#39;é¢†åˆ°çš„ä¼˜æƒ åˆ¸&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Š SQL è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªä¸“æ³¨äºä¼˜æƒ åˆ¸ç›¸å…³æ•°æ®çš„æ•°æ®åº“å’Œä¸¤ä¸ªä¸»è¦æ•°æ®è¡¨ã€‚<code>coupon_template</code> è¡¨æ ¼ç”¨äºå®šä¹‰ä¼˜æƒ åˆ¸çš„åŸºæœ¬æ¨¡æ¿ï¼Œè€Œ <code>coupon</code> è¡¨æ ¼è®°å½•äº†å…·ä½“çš„ä¼˜æƒ åˆ¸å‘æ”¾æƒ…å†µã€‚ç¡®ä¿åœ¨æ‰§è¡Œè¿™äº›è„šæœ¬å‰ï¼ŒMySQL æœåŠ¡æ­£åœ¨è¿è¡Œã€‚</p><blockquote><p>âœï¸ æ•°æ®è¡¨è®¾è®¡è¦ç‚¹ï¼š</p><ul><li><strong>æ•°æ®ç±»å‹é€‰æ‹©</strong>ï¼šåˆç†é€‰æ‹©æ•°æ®ç±»å‹èƒ½å¤Ÿä¼˜åŒ–å­˜å‚¨ç©ºé—´å’ŒæŸ¥è¯¢æ•ˆç‡ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ <code>int</code> ç±»å‹è¡¨ç¤ºä¸»é”®ï¼Œ<code>varchar</code> å­˜å‚¨å­—ç¬¦ä¸²ã€‚</li><li><strong>å†—ä½™å­—æ®µ</strong>ï¼š<code>coupon</code> è¡¨ä¸­çš„ <code>shop_id</code> ä½œä¸ºå†—ä½™å­—æ®µï¼Œä¾¿äºå¿«é€ŸæŸ¥è¯¢ä¼˜æƒ åˆ¸é€‚ç”¨é—¨åº—ï¼Œè¿™å‡å°‘äº†ä¸ <code>coupon_template</code> è¡¨çš„è”åˆæŸ¥è¯¢éœ€æ±‚ã€‚</li><li><strong>é»˜è®¤å€¼ä¸æ³¨é‡Š</strong>ï¼šè¡¨ä¸­å­—æ®µçš„é»˜è®¤å€¼åŠæ³¨é‡Šçš„è®¾ç½®å¢å¼ºäº†æ•°æ®çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚</li></ul></blockquote><h3 id="_1-7-æ¶ˆæ¯ä¸­é—´ä»¶-rabbitmq-çš„å®‰è£…ä¸é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-7-æ¶ˆæ¯ä¸­é—´ä»¶-rabbitmq-çš„å®‰è£…ä¸é…ç½®" aria-hidden="true">#</a> 1.7 æ¶ˆæ¯ä¸­é—´ä»¶ï¼šRabbitMQ çš„å®‰è£…ä¸é…ç½®</h3><p>RabbitMQ æ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„æ¶ˆæ¯ä¸­é—´ä»¶ä¹‹ä¸€ã€‚åç»­ Spring Cloud é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†ç»“åˆ Stream ç»„ä»¶å’Œ RabbitMQ æ¥å®ç°å¼‚æ­¥æ¶ˆæ¯ä¼ é€’ã€‚</p><p><strong>å¯¹äº Mac ç”¨æˆ·</strong>ï¼šä½¿ç”¨ Homebrew å¿«é€Ÿå®‰è£… RabbitMQ çš„å‘½ä»¤å¾ˆæ–¹ä¾¿ï¼Œå¦‚ä¸‹å‘½ä»¤å°†è‡ªåŠ¨å®‰è£… RabbitMQ çš„æœ€æ–°ç¨³å®šç‰ˆæœ¬ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>brew <span class="token function">install</span> rabbitmq
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>é Mac ç”¨æˆ·æˆ–æ‰‹åŠ¨å®‰è£…</strong>ï¼šè®¿é—® <a href="https://www.rabbitmq.com/" target="_blank" rel="noopener noreferrer">RabbitMQ å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ä¸‹è½½ç›¸åº”çš„å®‰è£…åŒ…ã€‚</p><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-031755.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>å¯åŠ¨ RabbitMQ</strong>ï¼šå¯åŠ¨ RabbitMQ æœåŠ¡çš„å‘½ä»¤æ ¹æ®å®‰è£…æ–¹å¼ç•¥æœ‰ä¸åŒã€‚å¦‚æœé€šè¿‡ Homebrew å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rabbitmq-server
<span class="token comment"># æˆ–è€…ï¼ˆæ¨èï¼‰</span>
brew services start rabbitmq
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>TIPï¼šå¦‚æœæ˜¯æ‰‹åŠ¨å®‰è£…ï¼Œç¡®ä¿ RabbitMQ çš„å®‰è£…è·¯å¾„å·²æ·»åŠ è‡³ PATH ç¯å¢ƒå˜é‡ã€‚</p></blockquote><p><strong>å…³é—­ RabbitMQ</strong>ï¼šæ­£ç¡®å…³é—­ RabbitMQ æœåŠ¡æ˜¯éå¸¸é‡è¦çš„ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†é‡è¦æ•°æ®å’Œé…ç½®æ—¶ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rabbitmqctl stop
<span class="token comment"># æˆ–è€…ï¼ˆæ¨èï¼‰</span>
brew services stop rabbitmq
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>TIPï¼šç¡®ä¿åœ¨åœæ­¢ RabbitMQ ä¹‹å‰ä¿å­˜æ‰€æœ‰çš„é‡è¦æ•°æ®å’Œé…ç½®ï¼Œä»¥é˜²æ•°æ®ä¸¢å¤±æˆ–é…ç½®è¢«é‡ç½®ã€‚</p></blockquote><p>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <code>http://localhost:15672/</code> è®¿é—® RabbitMQ çš„ç®¡ç†ç•Œé¢ï¼Œé»˜è®¤ç«¯å£ä¸º <code>15672</code>ã€‚é»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç å‡ä¸º <code>guest</code>ã€‚</p><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-043816.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ç™»å½•æˆåŠŸåï¼Œä½ å¯ä»¥çœ‹åˆ° RabbitMQ çš„ç®¡ç†ç•Œé¢ï¼Œå®ƒæä¾›äº†å…³äºæ¶ˆæ¯ã€é˜Ÿåˆ—ç­‰çš„è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯å’Œç®¡ç†é€‰é¡¹ã€‚</p><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-043834.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>è‡³æ­¤ï¼Œä½ å·²ç»æˆåŠŸå®‰è£…å¹¶è¿è¡Œäº† RabbitMQã€‚</p><blockquote><p>æ³¨æ„ï¼š</p><ul><li><strong>æ›´æ–° RabbitMQ</strong>ï¼šå¦‚æœä¹‹å‰å·²ç»å®‰è£…äº† RabbitMQï¼Œä½†éæœ€æ–°ç‰ˆæœ¬ï¼Œå»ºè®®æ›´æ–°åˆ°æœ€æ–°ç¨³å®šç‰ˆæœ¬ï¼Œä»¥ä¾¿ä½¿ç”¨æ‰€æœ‰æœ€æ–°åŠŸèƒ½å’Œæ’ä»¶ã€‚</li><li><strong>æ•°æ®å’Œé…ç½®çš„ä¿å­˜</strong>ï¼šåœ¨åœæ­¢ RabbitMQ æœåŠ¡ä¹‹å‰ï¼Œç¡®ä¿å·²ç»ä¿å­˜äº†æ‰€æœ‰é‡è¦çš„æ•°æ®å’Œé…ç½®ï¼Œä»¥é¿å…æ•°æ®ä¸¢å¤±æˆ–é…ç½®è¢«é‡ç½®ã€‚</li></ul></blockquote><h3 id="_1-8-å­˜å‚¨ç³»ç»Ÿ-redis-çš„å®‰è£…ä¸é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-8-å­˜å‚¨ç³»ç»Ÿ-redis-çš„å®‰è£…ä¸é…ç½®" aria-hidden="true">#</a> 1.8 å­˜å‚¨ç³»ç»Ÿï¼šRedis çš„å®‰è£…ä¸é…ç½®</h3><p>Redis æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ key-value å­˜å‚¨ç³»ç»Ÿï¼Œå¹¿æ³›åº”ç”¨äºç¼“å­˜ã€ä¼šè¯ç®¡ç†ç­‰åœºæ™¯ã€‚åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Redis æ¥å®ç°ç½‘å…³å±‚çš„é™æµåŠŸèƒ½ã€‚</p><p><strong>é€šè¿‡ Homebrew å®‰è£…</strong>ï¼šå¯¹äº Mac ç”¨æˆ·ï¼Œä½¿ç”¨ Homebrew å®‰è£… Redis éå¸¸æ–¹ä¾¿ï¼Œä»¥ä¸‹å‘½ä»¤å°†å®‰è£… Redis çš„æœ€æ–°ç‰ˆæœ¬ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>brew <span class="token function">install</span> redis
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æ‰‹åŠ¨å®‰è£…</strong>ï¼šä¹Ÿå¯ä»¥é€‰æ‹©æ‰‹åŠ¨å®‰è£… Redisï¼Œè®¿é—® <a href="https://redis.io/download" target="_blank" rel="noopener noreferrer">Redis å®˜æ–¹ç½‘ç«™<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ä¸‹è½½æºç åŒ…ã€‚</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-044049.png" style="zoom:33%;"><p>ç„¶åæŒ‰ç…§å®˜æ–¹<a href="https://redis.io/docs/getting-started/installation/" target="_blank" rel="noopener noreferrer">å®‰è£…æŒ‡å—<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>è¿›è¡Œæœ¬åœ°ç¼–è¯‘å’Œå®‰è£…ï¼š</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-044136.png" style="zoom:29%;"><p><strong>å¯åŠ¨å’Œåœæ­¢ Redis æœåŠ¡</strong>ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å¯åŠ¨ Redis æœåŠ¡</span>
brew services start redis

<span class="token comment"># åœæ­¢ Redis æœåŠ¡</span>
brew services stop redis
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œ <code>redis-cli</code> è¿æ¥è‡³é»˜è®¤çš„ Redis æœåŠ¡åœ°å€ï¼ˆlocalhost:6379ï¼‰ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>âœ  ~ redis-cli
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ Redis æ§åˆ¶å°ä¸­ï¼Œå¯ä»¥æ‰§è¡Œ Redis å‘½ä»¤ä»¥æµ‹è¯•å’Œç®¡ç†æ‚¨çš„ Redis å®ä¾‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> <span class="token builtin class-name">test</span> <span class="token number">955</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get <span class="token builtin class-name">test</span>
<span class="token string">&quot;955&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ç„¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ DataGrip è¿æ¥ Redis æ•°æ®åº“ï¼Œè¿›è¡Œæ›´ç›´è§‚çš„æ•°æ®ç®¡ç†å’Œæ“ä½œï¼š</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-044757.png" style="zoom:50%;"><p>è¿æ¥ä¿¡æ¯åŸºæœ¬ä¿æŒé»˜è®¤å³å¯ï¼š</p><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-044901.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æ‰€æœ‰å¿…è¦å·¥å…·çš„å®‰è£…ã€‚åœ¨æ¥ä¸‹æ¥çš„ Spring Cloud å¾®æœåŠ¡å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬è¿˜å°†ä»‹ç»å’Œä½¿ç”¨æ›´å¤šçš„ä¸­é—´ä»¶å’Œå·¥å…·ã€‚</p><blockquote><p>ğŸš€ <strong>ä¸‹ä¸€æ­¥ï¼šSpring Boot å¿«é€Ÿå…¥é—¨</strong></p><p>å·²ç»é…ç½®å¥½åŸºç¡€ç¯å¢ƒåï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ·±å…¥åˆ° Spring Boot çš„å­¦ä¹ å’Œåº”ç”¨ä¸­äº†ï¼è®©æˆ‘ä»¬å¼€å§‹ Spring Boot çš„æ—…ç¨‹å§ï¼**åŠ æ²¹ï¼**ğŸ”¥</p></blockquote><h2 id="_2-æ­å»ºä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_2-æ­å»ºä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡" aria-hidden="true">#</a> 2.æ­å»ºä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡</h2><p>åœ¨æœ¬èŠ‚ï¼Œæˆ‘ä»¬å°†è¯¦ç»†æ¢ç´¢å¦‚ä½•ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªåŸºäº Spring Boot çš„ä¼˜æƒ åˆ¸å¹³å°ï¼Œç‰¹åˆ«èšç„¦äºä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡ï¼ˆ<code>coupon-template-serv</code>ï¼‰çš„æ„å»ºè¿‡ç¨‹ã€‚è¿™ä¸€æœåŠ¡æ˜¯ä¼˜æƒ åˆ¸å¹³å°çš„æ ¸å¿ƒï¼Œå› ä¸ºä¼˜æƒ åˆ¸çš„ç”Ÿæˆä¸ç®¡ç†éƒ½ä¾èµ–äºæ¨¡æ¿ã€‚</p><p>é¡¹ç›®ç»“æ„æ¦‚è§ˆï¼š</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-11-01-160815.png" style="zoom:67%;"><p>æˆ‘ä»¬çš„ä¼˜æƒ åˆ¸å¹³å°é¡¹ç›®ï¼ˆ<code>coupon-center</code>ï¼‰åŒ…å«å››ä¸ªä¸»è¦å­æ¨¡å—ï¼Œå®ƒä»¬åœ¨ Maven ç®¡ç†ä¸‹å½¢æˆä¸€ä¸ªå±‚æ¬¡åˆ†æ˜çš„ç»“æ„ï¼š</p><ol><li><strong>coupon-template-serv</strong>ï¼šæ­¤æ¨¡å—è´Ÿè´£åˆ›å»ºã€æŸ¥æ‰¾ã€å…‹éš†å’Œåˆ é™¤ä¼˜æƒ åˆ¸æ¨¡æ¿ã€‚</li><li><strong>coupon-calculation-serv</strong>ï¼šå¤„ç†ä¼˜æƒ åçš„è®¢å•ä»·æ ¼è®¡ç®—ï¼Œä»¥åŠè¯„ä¼°å„ç±»ä¼˜æƒ åˆ¸çš„ä¼˜æƒ ç¨‹åº¦ã€‚</li><li><strong>coupon-customer-serv</strong>ï¼šä¸ç”¨æˆ·ç›¸å…³çš„æœåŠ¡ï¼ŒåŒ…æ‹¬é¢†å–ä¼˜æƒ åˆ¸ã€æ¨¡æ‹Ÿè®¡ç®—ä¼˜æƒ ã€åˆ é™¤ä¼˜æƒ åˆ¸å’Œè®¢å•å¤„ç†ã€‚</li><li><strong>middleware</strong>ï¼šå­˜å‚¨è·¨ä¸šåŠ¡çš„ã€å¹³å°çº§ç»„ä»¶ã€‚</li></ol><p>æ¯ä¸ªä»¥ <code>-serv</code> ç»“å°¾çš„å­æ¨¡å—è¿›ä¸€æ­¥ç»†åˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªå­æ¨¡å—ï¼Œç¡®ä¿èŒè´£å•ä¸€ï¼Œä»£ç ç®¡ç†æ¸…æ™°ï¼š</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-11-01-161047.png" style="zoom:67%;"><ul><li><strong>coupon-template-api</strong>ï¼šåŒ…å«å…¬å…±ç±»å’Œå¤–éƒ¨æ¥å£ï¼Œå¦‚ Request å’Œ Response å¯¹è±¡ã€‚</li><li><strong>coupon-template-dao</strong>ï¼šå®šä¹‰æ•°æ®åº“å®ä½“å’Œæ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰ã€‚</li><li><strong>coupon-template-impl</strong>ï¼šå…·ä½“å®ç°æœåŠ¡çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å’Œ REST APIã€‚</li></ul><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å…·ä½“ä»‹ç»å¦‚ä½•é…ç½®å’Œå¯åŠ¨ <code>coupon-template-serv</code> æ¨¡å—ï¼ŒåŒ…æ‹¬æ•°æ®åº“é…ç½®ã€æ ¸å¿ƒä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡ REST API å¯¹å¤–æä¾›æœåŠ¡ã€‚</p><h3 id="_2-1-æ·»åŠ -maven-ä¾èµ–é¡¹" tabindex="-1"><a class="header-anchor" href="#_2-1-æ·»åŠ -maven-ä¾èµ–é¡¹" aria-hidden="true">#</a> 2.1 æ·»åŠ  Maven ä¾èµ–é¡¹</h3><p>åœ¨æ„å»ºåŸºäº Maven çš„ Spring Boot é¡¹ç›®æ—¶ï¼Œåˆç†çš„ä¾èµ–ç®¡ç†ç­–ç•¥å¯¹äºé¡¹ç›®çš„ç»“æ„å’Œåç»­ç»´æŠ¤è‡³å…³é‡è¦ã€‚ä»¥ä¸‹å†…å®¹å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨å¤šæ¨¡å—é¡¹ç›®ä¸­æ·»åŠ å’Œé…ç½® Maven ä¾èµ–é¡¹ï¼Œä»¥åŠå®ƒä»¬åœ¨é¡¹ç›®ä¸­çš„å±‚çº§å…³ç³»ã€‚</p><h4 id="_2-1-1-ç¼–å†™-part01-springboot-quick-ä¾èµ–é¡¹" tabindex="-1"><a class="header-anchor" href="#_2-1-1-ç¼–å†™-part01-springboot-quick-ä¾èµ–é¡¹" aria-hidden="true">#</a> 2.1.1 ç¼–å†™ part01-springboot-quick ä¾èµ–é¡¹</h4><p>åœ¨æˆ‘ä»¬çš„å®æˆ˜é¡¹ç›® <code>part01-springboot-quick</code> ä¸­ï¼Œå®ƒä½œä¸ºé¡¶å±‚é¡¹ç›®ï¼Œä¸»è¦æ‰¿æ‹…ç€å®šä¹‰å…¬å…± Maven ä¾èµ–ç‰ˆæœ¬çš„è´£ä»»ï¼Œç±»ä¼¼äºä¸€ä¸ªå…¬å¸çš„æˆ˜ç•¥ç®¡ç†å±‚ï¼ŒæŒ‡æ˜å¤§æ–¹å‘è€Œä¸æ¶‰è¶³å…·ä½“ä¸šåŠ¡ã€‚è¿™äº›é…ç½®å‡åœ¨é¡¹ç›®çš„ <code>pom.xml</code> æ–‡ä»¶ä¸­æŒ‡å®šã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.4.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.javgo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ch0-springboot-monolithic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>ch0-springboot-monolithic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>http://maven.apache.org<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- å­æ¨¡å— --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modules</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>coupon-template-serv<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>coupon-calculation-serv<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>coupon-customer-serv<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>middleware<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modules</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- å±æ€§ --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- ä¾èµ–ç®¡ç† --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- Spring Cloud ç‰ˆæœ¬ --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2020.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!-- Spring Cloud Alibaba ç‰ˆæœ¬ --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2021.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!-- Apache Commons --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-lang3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-collections4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>commons-codec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-codec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!-- Alibaba FastJson --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.31<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!-- Lombok --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.18.20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!-- Jakarta Bean Validation --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>jakarta.validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jakarta.validation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!-- Google Guava --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.google.guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>16.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä»½ <code>pom.xml</code> æ–‡ä»¶ä¸­ï¼Œé‡ç‚¹å…³æ³¨ä»¥ä¸‹ä¸‰ä¸ªæ ‡ç­¾ï¼š</p><ol><li><p><strong>&lt; parent &gt; æ ‡ç­¾</strong></p><p>é€šè¿‡ <code>&lt;parent&gt;</code> æ ‡ç­¾çš„é…ç½®ï¼Œæˆ‘ä»¬ç¡®å®šäº†é¡¶å±‚é¡¹ç›®çš„çˆ¶ä¾èµ–ä¸º <code>spring-boot-starter-parent</code>ï¼Œå®ƒä¸ºæˆ‘ä»¬çš„å­æ¨¡å—æä¾›äº†æ‰€éœ€çš„ Spring Boot ç»„ä»¶ç‰ˆæœ¬ï¼Œè¿™æ ·çš„åšæ³•åˆ©äºä¿æŒä¾èµ–çš„ä¸€è‡´æ€§å’Œç®€åŒ–ç®¡ç†ã€‚</p></li><li><p><strong>&lt; packaging &gt; æ ‡ç­¾</strong></p><p>è¿™é‡Œæˆ‘ä»¬æŒ‡å®š <code>&lt;packaging&gt;</code> çš„å€¼ä¸º <code>pom</code>ï¼Œæ„å‘³ç€è¯¥æ¨¡å—èšç„¦äºç­–ç•¥æ€§çš„å®šä¹‰ï¼ŒåŒ…æ‹¬å­æ¨¡å—çš„æ•´åˆå’Œä¾èµ–ç‰ˆæœ¬ç®¡ç†ï¼Œè€Œä¸åŒ…å«å…·ä½“çš„ä¸šåŠ¡é€»è¾‘å®ç°ã€‚</p></li><li><p><strong>&lt; dependencyManagement &gt; æ ‡ç­¾</strong></p><p>ä¸ <code>&lt;parent&gt;</code> ç±»ä¼¼ï¼Œ<code>&lt;dependencyManagement&gt;</code> ç”¨äºé›†ä¸­ç®¡ç†é¡¹ç›®ä¾èµ–ç‰ˆæœ¬ã€‚è¿™æ ·ï¼Œå­æ¨¡å—åœ¨å£°æ˜ä¾èµ–æ—¶ï¼Œåªéœ€æŒ‡å‡º <code>groupId</code> å’Œ <code>artifactId</code>ï¼Œæ— éœ€æŒ‡å®šç‰ˆæœ¬ï¼Œé¿å…äº†ç‰ˆæœ¬å†²çªå’Œæ··ä¹±ã€‚</p></li></ol><h4 id="_2-1-2-ç¼–å†™-coupon-template-serv-ä¾èµ–é¡¹" tabindex="-1"><a class="header-anchor" href="#_2-1-2-ç¼–å†™-coupon-template-serv-ä¾èµ–é¡¹" aria-hidden="true">#</a> 2.1.2 ç¼–å†™ coupon-template-serv ä¾èµ–é¡¹</h4><p>æ¥ä¸‹æ¥æ˜¯ <code>coupon-template-serv</code> å­æ¨¡å—çš„ä¾èµ–é…ç½®ã€‚ä½œä¸º <code>part01-springboot-quick</code> çš„ç›´æ¥å­æ¨¡å—ï¼Œå®ƒçš„ <code>pom.xml</code> é…ç½®åŒæ ·å°† <code>&lt;packaging&gt;</code> ç±»å‹è®¾ä¸º <code>pom</code>ï¼Œå¹¶ä¸”ä¸»è¦å†…å®¹é›†ä¸­åœ¨ç¡®å®šå…¶çˆ¶æ¨¡å—ï¼Œå¹¶å®šä¹‰ä¸‹å±‚å­æ¨¡å—çš„é…ç½®ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.javgo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ch0-springboot-monolithic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-template-serv<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>coupon-template-serv<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>http://maven.apache.org<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modules</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>coupon-template-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>coupon-template-impl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>coupon-template-dao<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modules</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®Œæˆäº†é¡¶çº§æ¨¡å—å’Œç›´æ¥å­æ¨¡å—çš„ä¾èµ–é…ç½®åï¼Œæˆ‘ä»¬çš„ä¸‹ä¸€æ­¥æ˜¯æ„å»º <code>coupon-template-serv</code> ä¸‹å±çš„ä¸‰ä¸ªå­æ¨¡å—ï¼š</p><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-081052.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä»¥ <code>coupon-template-api</code> å­æ¨¡å—ä¸ºèµ·ç‚¹ï¼Œå…¶ä¸»è¦èŒè´£æ˜¯æä¾›æ¥å£çš„è¯·æ±‚å’Œå“åº”ç±»æ¨¡æ¿ï¼Œå®ƒæ˜¯å…¶ä»–ä¸¤ä¸ªæ¨¡å—å…±äº«èµ„æºçš„åŸºç¡€ï¼Œæˆ‘ä»¬å°†ç€æ‰‹äºæ­¤æ¨¡å—çš„æ„å»ºå·¥ä½œã€‚</p><h3 id="_2-4-æ­å»º-coupon-template-api-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_2-4-æ­å»º-coupon-template-api-æ¨¡å—" aria-hidden="true">#</a> 2.4 æ­å»º coupon-template-api æ¨¡å—</h3><h4 id="_2-4-1-æ¦‚è§ˆ" tabindex="-1"><a class="header-anchor" href="#_2-4-1-æ¦‚è§ˆ" aria-hidden="true">#</a> 2.4.1 æ¦‚è§ˆ</h4><p><code>coupon-template-api</code> æ¨¡å—æ‹…ä»»äº†æ•´ä¸ªæœåŠ¡ä¸­<strong>å…±äº«æ•°æ®ç±»å‹å’Œæ¥å£è§„èŒƒ</strong>çš„è§’è‰²ã€‚å®ƒåŒ…å«äº†æ‰€æœ‰çš„ REST API æ¶ˆæ¯ä¼ è¾“å¯¹è±¡ï¼ˆDTOï¼‰ï¼Œä¾‹å¦‚è¯·æ±‚å’Œå“åº”å¯¹è±¡ï¼Œè¿™äº›éƒ½æ˜¯ä»¥ POJOï¼ˆPlain Old Java Objectï¼‰ç±»çš„å½¢å¼å®ç°çš„ã€‚åœ¨å¾®æœåŠ¡ä½“ç³»ä¸­ï¼Œè¿™æ ·åšå¯ä»¥é¿å…åœ¨æœåŠ¡ä¹‹é—´å…±äº«å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘ï¼Œä»è€Œä¿ƒè¿›æœåŠ¡çš„ç‹¬ç«‹æ€§å’Œå¯é‡ç”¨æ€§ã€‚</p><h4 id="_2-4-2-ä¾èµ–é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-4-2-ä¾èµ–é…ç½®" aria-hidden="true">#</a> 2.4.2 ä¾èµ–é…ç½®</h4><p>åœ¨è¿™ä¸ªæ¨¡å—çš„ <code>pom.xml</code> ä¸­ï¼Œæˆ‘ä»¬åŠ å…¥äº†è‹¥å¹²ä¾¿äºå¼€å‘çš„å·¥å…·ç±»åº“ï¼Œå¦‚ <code>lombok</code>ï¼ˆç”¨äºç®€åŒ–å¯¹è±¡çš„åˆ›å»ºå’Œç®¡ç†ï¼‰ï¼Œ<code>guava</code>ï¼ˆæä¾›é¢å¤–çš„é›†åˆå¤„ç†èƒ½åŠ›ï¼‰ï¼Œä»¥åŠ <code>validation-api</code>ï¼ˆç”¨äºæ•°æ®æœ‰æ•ˆæ€§æ ¡éªŒï¼‰ã€‚</p><p>ä¸‹é¢æ˜¯è¿™äº›ä¾èµ–é¡¹çš„å…·ä½“é…ç½®ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Apache Commons --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-lang3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-collections4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>commons-codec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-codec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Alibaba FastJson --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Lombok --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Jakarta Validation --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>jakarta.validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jakarta.validation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Google Guava --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.google.guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-3-æ ¸å¿ƒç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-4-3-æ ¸å¿ƒç»„ä»¶" aria-hidden="true">#</a> 2.4.3 æ ¸å¿ƒç»„ä»¶</h4><!----><p>åœ¨ <code>cn.javgo.coupon.calculation.template.api.constant</code> åŒ…ä¸­ï¼Œ<code>CouponType </code>æšä¸¾å®šä¹‰äº†ä¸€ç³»åˆ—çš„ä¼˜æƒ åˆ¸ç±»å‹ã€‚ä¸ºäº†å¢åŠ ä»£ç çš„<strong>é²æ£’æ€§</strong>ï¼Œè¿™é‡Œè¿˜è®¾è®¡äº†ä¸€ä¸ªç‰¹æ®Šçš„æšä¸¾å€¼ <code>UNKNOWN</code>ï¼Œç”¨äºå¤„ç†æ— æ•ˆçš„è¾“å…¥ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·ç±»å‹æšä¸¾
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">CouponType</span> <span class="token punctuation">{</span>
    <span class="token function">UNKNOWN</span><span class="token punctuation">(</span><span class="token string">&quot;unknown&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">MONEY_OFF</span><span class="token punctuation">(</span><span class="token string">&quot;æ»¡å‡åˆ¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">DISCOUNT</span><span class="token punctuation">(</span><span class="token string">&quot;æŠ˜æ‰£åˆ¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">RANDOM_DISCOUNT</span><span class="token punctuation">(</span><span class="token string">&quot;éšæœºæŠ˜æ‰£åˆ¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">LONELY_NIGHT_MONEY_OFF</span><span class="token punctuation">(</span><span class="token string">&quot;æ™šé—´åŒå€æ»¡å‡åˆ¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> desc<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> code<span class="token punctuation">;</span>


    <span class="token doc-comment comment">/**
     * å°†ç»™å®šçš„ä»£ç è½¬æ¢ä¸ºç›¸åº”çš„ä¼˜æƒ åˆ¸ç±»å‹
     *
     * <span class="token keyword">@param</span> <span class="token parameter">code</span> ä¼˜æƒ åˆ¸ç±»å‹çš„ä»£ç 
     * <span class="token keyword">@return</span> è½¬æ¢åçš„ä¼˜æƒ åˆ¸ç±»å‹
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CouponType</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">CouponType</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>bean <span class="token operator">-&gt;</span> bean<span class="token punctuation">.</span>code<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// é˜²å¾¡æ€§ç¼–ç¨‹ï¼šå¤„ç†æ¶æ„è¯·æ±‚ä¸­æ•…æ„è¾“å…¥çš„é”™è¯¯ä»£ç </span>
                <span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token constant">UNKNOWN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><!----><p><code>TemplateRule </code>ç±»ä½äº <code>cn.javgo.coupon.calculation.template.api.beans.rules</code> åŒ…ä¸‹ï¼Œæè¿°äº†ä¼˜æƒ åˆ¸æ¨¡æ¿çš„ä¸¤ä¸ªåŸºæœ¬è§„åˆ™ï¼šé¢†å–è§„åˆ™å’Œä½¿ç”¨è§„åˆ™ã€‚è¿™äº›è§„åˆ™å¯¹äºç†è§£å’Œæ‰§è¡Œä¼˜æƒ åˆ¸çš„è¡Œä¸ºè‡³å…³é‡è¦ã€‚</p><ol><li><strong>é¢†åˆ¸è§„åˆ™</strong>ï¼šæè¿°äº†æ¯ä¸ªç”¨æˆ·å¯ä»¥é¢†å–çš„ä¼˜æƒ åˆ¸æ•°é‡å’Œä¼˜æƒ åˆ¸çš„è¿‡æœŸæ—¶é—´ã€‚</li><li><strong>ä¼˜æƒ åˆ¸çš„è®¡ç®—è§„åˆ™</strong>ï¼šæè¿°äº†ä¼˜æƒ åˆ¸çš„å…·ä½“æŠ˜æ‰£è§„åˆ™ã€‚</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·é¢†å–è§„åˆ™
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TemplateRule</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * ä¼˜æƒ å·æŠ˜æ‰£è§„åˆ™
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Discount</span> discount<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ä¼˜æƒ å·é¢†å–é™åˆ¶
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> limitation<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ä¼˜æƒ å·è¿‡æœŸæ—¶é—´
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> deadline<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><!----><p><code>Discount </code>ç±»å®šä¹‰äº†å…·ä½“çš„æŠ˜æ‰£é€»è¾‘ï¼Œè¿™é‡Œä½¿ç”¨ <code>Long</code> ç±»å‹ä»¥åˆ†ä¸ºå•ä½è¡¨ç¤ºé‡‘é¢ï¼Œä»¥é¿å…æµ®ç‚¹æ•°è®¡ç®—çš„ç²¾åº¦é—®é¢˜ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ è§„åˆ™
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Discount</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * ä¼˜æƒ é‡‘é¢
     * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
     * æ³¨æ„ï¼šå¯¹äºä¸åŒçš„ä¼˜æƒ å·æœ‰ä¸åŒçš„å«ä¹‰<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
     * 1ã€æ»¡å‡åŠµï¼šæ»¡è¶³ä¸€å®šé‡‘é¢åå¯ä»¥å‡å»çš„é‡‘é¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
     * 2ã€æŠ˜æ‰£åŠµï¼šæŠ˜æ‰£æ¯”ä¾‹ï¼Œå¦‚ 90 è¡¨ç¤ºæ‰“9æŠ˜<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
     * 3ã€éšæœºç«‹å‡åŠµï¼šéšæœºå‡å»çš„é‡‘é¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
     * 4ã€æ™šé—´å‘æ”¾åŠµï¼šæ™šé—´ä¼˜æƒ å·ç¿»å€
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> quota<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ä¼˜æƒ æ¡ä»¶ï¼šä½¿ç”¨ä¼˜æƒ å·çš„æœ€ä½é‡‘é¢ï¼Œå•ä½ï¼šåˆ†
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> threshold<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><!----><p><code>CouponTemplateInfo </code>ç±»æä¾›äº†æ¨¡æ¿çš„åŸºç¡€æè¿°ï¼Œå¹¶ä½¿ç”¨äº† <code>jakarta.validation-api</code> ä¸­çš„æ ¡éªŒæ³¨è§£ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·æ¨¡æ¿ä¿¡æ¯
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponTemplateInfo</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸»é”®&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@NotNull</span>
  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ å·æ¨¡æ¿åç§°&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@NotNull</span>
  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ å·æ¨¡æ¿æè¿°&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> desc<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@NotNull</span>
  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ å·æ¨¡æ¿ç±»å‹&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> type<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;åº—é“ºid&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> shopId<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@NotNull</span>
  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ å·æ¨¡æ¿è§„åˆ™&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">TemplateRule</span> templateRule<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;æ˜¯å¦å¯ç”¨&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Boolean</span> available<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><!----><blockquote><p>æ­¤å¤–ï¼Œæ¨¡å—ä¸­è¿˜åŒ…æ‹¬äº†å¦‚åˆ†é¡µæŸ¥è¯¢å’Œæœç´¢ä¼˜æƒ åˆ¸æ¨¡æ¿æ‰€éœ€çš„å‚æ•°ç±»ç­‰ã€‚è¿™äº›ç±»è¿›ä¸€æ­¥å¢å¼ºäº†æœåŠ¡çš„åŠŸèƒ½ã€‚</p></blockquote><p>ç”Ÿæˆçš„ä¼˜æƒ åˆ¸åˆ™ä½¿ç”¨å¦ä¸€ä¸ªå¯¹è±¡ <code>CouponInfo</code> æ¥å°è£…ã€‚<code>CouponInfo</code> å¯¹è±¡åŒ…å«äº†ä¼˜æƒ åˆ¸çš„æ¨¡æ¿ä¿¡æ¯ã€é¢†åˆ¸ç”¨æˆ·IDã€é€‚ç”¨é—¨åº— ID ç­‰å…³é”®å±æ€§ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·ä¿¡æ¯ï¼ˆåŸºäº <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">CouponTemplateInfo</span></span><span class="token punctuation">}</span> ç”Ÿæˆï¼‰
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponInfo</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸»é”®&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ å·æ¨¡æ¿ID&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> templateId<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ç”¨æˆ·ID&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;åº—é“ºID&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> shopId<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ å·çŠ¶æ€&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ å·æ¨¡æ¿ä¿¡æ¯&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">CouponTemplateInfo</span> templateInfo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ†é¡µæŸ¥è¯¢ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯å‚æ•°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * åˆ†é¡µæŸ¥è¯¢ä¼˜æƒ å·æ¨¡æ¿
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PagedCouponTemplateInfo</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ å·æ¨¡æ¿åˆ—è¡¨&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplateInfo</span><span class="token punctuation">&gt;</span></span> couponTemplateInfoList<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;å½“å‰é¡µ&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> page<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;æ€»é¡µæ•°&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">long</span> total<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¼˜æƒ åˆ¸æ¨¡æ¿æœç´¢å‚æ•°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·æ¨¡ç‰ˆæŸ¥è¯¢å‚æ•°
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TemplateSearchParams</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;ä¼˜æƒ å·ID&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;ä¼˜æƒ å·åç§°&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;ä¼˜æƒ å·ç±»å‹&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> type<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;é—¨åº—ID&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> shopId<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ˜¯å¦å¯ç”¨&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Boolean</span> available<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;é¡µç &quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> page<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ¯é¡µå¤§å°&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> pageSize<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>coupon-template-api </code> æ¨¡å—ä¸ºæˆ‘ä»¬æä¾›äº†æ ‡å‡†åŒ–çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œä½¿å¾—å…¶ä»–æœåŠ¡èƒ½å¤ŸåŸºäºè¿™äº›æ ¼å¼æ„å»ºè‡ªå·±çš„é€»è¾‘ã€‚éšç€æ¨¡å—çš„è¿›ä¸€æ­¥ä¸°å¯Œï¼Œå®ƒå°†æˆä¸ºä¿è¯å¾®æœåŠ¡é—´é€šä¿¡ä¸€è‡´æ€§å’Œå‡è½»è€¦åˆçš„å…³é”®ã€‚</p><p>åœ¨å®Œæˆ <code>coupon-template-api</code> æ¨¡å—åï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°†èšç„¦äº <code>coupon-template-dao</code> æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—è´Ÿè´£å®ç°æ•°æ®è®¿é—®é€»è¾‘ï¼ŒåŒ…æ‹¬ä¸æ•°æ®åº“çš„äº¤äº’å’Œæ•°æ®æŒä¹…åŒ–ã€‚</p><h3 id="_2-5-æ­å»º-coupon-template-dao-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_2-5-æ­å»º-coupon-template-dao-æ¨¡å—" aria-hidden="true">#</a> 2.5 æ­å»º coupon-template-dao æ¨¡å—</h3><h4 id="_2-5-1-ä¾èµ–é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-5-1-ä¾èµ–é…ç½®" aria-hidden="true">#</a> 2.5.1 ä¾èµ–é…ç½®</h4><p>åœ¨åŠ¨æ‰‹å®ç° <code>coupon-template-dao </code>æ¨¡å—å‰ï¼Œç¡®è®¤å·²ç»æ·»åŠ äº†ä»¥ä¸‹å…³é”®ä¾èµ–é¡¹è‡³ <code>pom.xml</code> æ–‡ä»¶ï¼š</p><ul><li><strong>coupon-template-api</strong>: å¼•å…¥è¯¥æ¨¡å—ä»¥ä½¿ç”¨ API å±‚å®šä¹‰çš„å…¬å…±ç±»ã€‚</li><li><strong>spring-boot-starter-data-jpa</strong>: åˆ©ç”¨ Spring Data JPA ç®€åŒ–æ•°æ®æŒä¹…åŒ–æ“ä½œã€‚</li><li><strong>mysql-connector-java</strong>: ç¡®ä¿æ‰€ç”¨ MySQL é©±åŠ¨ä¸æ•°æ®åº“ç‰ˆæœ¬å…¼å®¹ã€‚</li></ul><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--
        æŒä¹…å±‚ï¼ˆPersistence Layerï¼‰æ˜¯åº”ç”¨ç¨‹åºä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œè´Ÿè´£ç®¡ç†å’Œå­˜å‚¨æ•°æ®ã€‚åœ¨å®é™…æƒ…å†µä¸‹ï¼ŒæŒä¹…å±‚ä¸åº”è¯¥ç›´æ¥ä¾èµ–äº API å±‚
        ï¼ˆApplication Programming Interface Layerï¼‰ï¼Œå› ä¸ºè¿™ä¸¤å±‚çš„åŠŸèƒ½åˆ†ç¦»åº”è¯¥æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ã€‚ç„¶è€Œï¼Œä¸ºäº†ç®€åŒ–ç¤ºä¾‹ï¼Œè¿™é‡Œå‡è®¾
        æŒä¹…å±‚ç›´æ¥ä¾èµ–äº API å±‚çš„ POJO ç±»ï¼ˆPlain Old Java Objectï¼Œç®€å•çš„ Java å¯¹è±¡ï¼‰ã€‚

        åœ¨å®é™…å¼€å‘ä¸­ï¼ŒæŒä¹…å±‚åº”è¯¥å®šä¹‰è‡ªå·±çš„ DTOï¼ˆData Transfer Objectï¼‰ï¼Œå³æ•°æ®ä¼ è¾“å¯¹è±¡ã€‚ä¸Šå±‚æ¨¡å—å¯ä»¥é€šè¿‡è½¬æ¢å™¨ï¼ˆconverterï¼‰å°†
        API å±‚çš„ POJO ç±»è½¬æ¢æˆé€‚åˆæŒä¹…å±‚ä½¿ç”¨çš„ DTOã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼ŒæŒä¹…å±‚çš„ DTO å¯ä»¥çµæ´»ä¿®æ”¹ï¼Œè€Œä¸ä¼šå½±å“åˆ° API å±‚çš„ POJO ç±»ã€‚
        å› ä¸º API å±‚çš„ POJO ç±»æ˜¯åº”ç”¨ç¨‹åºçš„å¤–éƒ¨æ¥å£ï¼Œä¸åº”è¯¥é¢‘ç¹ä¿®æ”¹ã€‚

        æ€»ä¹‹ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼ŒæŒä¹…å±‚åº”è¯¥ä¸ API å±‚è§£è€¦åˆï¼Œå¹¶ä¸”é€šè¿‡è‡ªå®šä¹‰ DTO è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚è¿™æ ·åšå¯ä»¥æé«˜åº”ç”¨ç¨‹åºçš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
    --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-template-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Spring Data JPA --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-jpa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Spring Boot Validation --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- MySQL --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.21<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-5-2-å®ä½“å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_2-5-2-å®ä½“å®šä¹‰" aria-hidden="true">#</a> 2.5.2 å®ä½“å®šä¹‰</h4><p>åœ¨ <code>cn.javgo.template.dao.model</code> åŒ…ä¸‹åˆ›å»º <code>CouponTemplate</code> ç±»ï¼Œè¯¥ç±»è¡¨ç¤ºæ•°æ®åº“ä¸­ <code>coupon_template</code> è¡¨çš„å®ä½“ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·æ¨¡ç‰ˆå®ä½“
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token annotation punctuation">@Entity</span> <span class="token comment">// å®ä½“</span>
<span class="token annotation punctuation">@EntityListeners</span><span class="token punctuation">(</span><span class="token class-name">AuditingEntityListener</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">// å®¡è®¡</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;coupon_template&quot;</span><span class="token punctuation">)</span> <span class="token comment">// è¡¨å</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponTemplate</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span><span class="token constant">IDENTITY</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;description&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> description<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">CouponTypeConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponType</span> category<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;rule&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">RuleConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">TemplateRule</span> templateRule<span class="token punctuation">;</span>

    <span class="token comment">// å¦‚æœä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºå…¨åº—é€šç”¨ä¼˜æƒ å·</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;shop_id&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> shopId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;available&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> available<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@CreatedDate</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;created_time&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> createdTime<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ JPA æ³¨è§£å¯ä»¥å°†ç±»å±æ€§æ˜ å°„åˆ°æ•°æ®åº“è¡¨å­—æ®µï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æ ¸å¿ƒæ³¨è§£åŠå…¶ä½œç”¨çš„æ¦‚è¿°ï¼š</p><table><thead><tr><th>æ³¨è§£</th><th>æè¿°</th></tr></thead><tbody><tr><td>@Entity</td><td>æŒ‡æ˜è¯¥ç±»ä¸ºå®ä½“ç±»ï¼Œå®ƒå°†æ˜ å°„åˆ°æ•°æ®åº“è¡¨ã€‚</td></tr><tr><td>@Table</td><td>æ˜ç¡®æŒ‡å‡ºå®ä½“å¯¹åº”äºæ•°æ®åº“ä¸­çš„å“ªä¸ªè¡¨ã€‚</td></tr><tr><td>@ID</td><td>æ ‡è®°ä¸€ä¸ªå­—æ®µä½œä¸ºå”¯ä¸€çš„ä¸»é”®ã€‚</td></tr><tr><td>@GeneratedValue</td><td>æŒ‡å®šä¸»é”®ç”Ÿæˆç­–ç•¥ï¼Œå¦‚è‡ªå¢ã€‚</td></tr><tr><td>@Column</td><td>å°†å®ä½“çš„å±æ€§æ˜ å°„åˆ°è¡¨çš„ç‰¹å®šåˆ—ï¼Œå¹¶å¯å®šä¹‰åˆ—çš„ç‰¹æ€§ï¼ˆå¦‚éç©ºï¼‰ã€‚</td></tr><tr><td>@CreatedDate</td><td>è‡ªåŠ¨è®°å½•å®ä½“åˆ›å»ºçš„æ—¶é—´ã€‚</td></tr><tr><td>@Convert</td><td>å½“æ•°æ®åº“å­—æ®µä¸å®ä½“å±æ€§ä¸æ˜¯ç›´æ¥æ˜ å°„å…³ç³»æ—¶ï¼Œä½¿ç”¨è¯¥æ³¨è§£æŒ‡å®šä¸€ä¸ªå®ç°äº† <code>AttributeConverter&lt;X,Y&gt;</code> æ¥å£çš„è½¬æ¢å™¨ã€‚</td></tr></tbody></table><blockquote><p>âš ï¸ æ³¨æ„ï¼š</p><p>å°½ç®¡ JPA æä¾›äº†å¼ºå¤§çš„å…³ç³»æ˜ å°„åŠŸèƒ½ï¼ˆå¦‚ @ManyToOne å’Œ @OneToOneï¼‰ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹è¿‡åº¦ä½¿ç”¨è¿™äº›å…³ç³»å¯èƒ½ä¼šå½±å“æ€§èƒ½ï¼Œç”±äºå¯èƒ½å¯¼è‡´å¤æ‚çš„ SQL è¯­å¥å’Œå¤§é‡çš„æ•°æ®åº“æ“ä½œã€‚æ¨èåœ¨å®é™…å¼€å‘ä¸­å°½å¯èƒ½é¿å…çº§è”æŸ¥è¯¢ï¼Œé€šè¿‡ä¸šåŠ¡é€»è¾‘é‡æ„æˆ–æŸ¥è¯¢ä¼˜åŒ–æ¥å‡è½»æ•°æ®åº“è´Ÿæ‹…ã€‚</p></blockquote><p>åœ¨éœ€è¦å°†ç‰¹å®šçš„æ•°æ®åº“åˆ—å€¼è½¬æ¢ä¸º Java å¯¹è±¡æ—¶ï¼Œå®šä¹‰ç›¸åº”çš„ <code>AttributeConverter</code> å®ç°ç±»å³å¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·ç±»å‹è½¬æ¢å™¨
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponTypeConverter</span> <span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponType</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">CouponType</span> attribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> attribute<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CouponType</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CouponType</span><span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>dbData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-5-3-æ•°æ®è®¿é—®å¯¹è±¡-dao" tabindex="-1"><a class="header-anchor" href="#_2-5-3-æ•°æ®è®¿é—®å¯¹è±¡-dao" aria-hidden="true">#</a> 2.5.3 æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰</h4><p>ä¸ºäº†ä¸æ•°æ®åº“äº¤äº’ï¼Œæˆ‘ä»¬å°†å®šä¹‰ DAO æ¥å£ã€‚ä¾‹å¦‚ï¼Œ<code>CouponTemplateDAO </code>å¯ä»¥é€šè¿‡ç»§æ‰¿ <code>JpaRepository</code> æ¥å£ï¼Œæä¾›å¯¹ <code>CouponTemplate</code> å®ä½“çš„ CRUD æ“ä½œã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬é¿å…äº†ç¼–å†™å¤§é‡çš„ SQL è¯­å¥ï¼ŒåŒæ—¶ Spring Data JPA æä¾›çš„æ–¹æ³•å·²ç»è¶³å¤Ÿåº”å¯¹å¤§å¤šæ•°æ•°æ®è®¿é—®éœ€æ±‚ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·æ¨¡ç‰ˆ Dao ( ç¬¬ä¸€ä¸ªæ³›å‹ï¼šå®ä½“ç±»ï¼Œç¬¬äºŒä¸ªæ³›å‹ï¼šä¸»é”®ç±»å‹ )
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CouponTemplateDao</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplate</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æ ¹æ®åº—é“ºidæŸ¥è¯¢ä¼˜æƒ å·æ¨¡ç‰ˆ
     *
     * <span class="token keyword">@param</span> <span class="token parameter">shopId</span> åº—é“ºid
     * <span class="token keyword">@return</span> ä¼˜æƒ å·æ¨¡ç‰ˆåˆ—è¡¨
     */</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplate</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAllByShopId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> shopId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ ¹æ®ç»™å®šçš„idåˆ—è¡¨å’Œåˆ†é¡µä¿¡æ¯ï¼ŒæŸ¥æ‰¾æ‰€æœ‰çš„ä¼˜æƒ åˆ¸æ¨¡æ¿
     *
     * <span class="token keyword">@param</span> <span class="token parameter">ids</span>      ä¼˜æƒ åˆ¸idåˆ—è¡¨
     * <span class="token keyword">@param</span> <span class="token parameter">pageable</span> åˆ†é¡µä¿¡æ¯
     * <span class="token keyword">@return</span> åŒ…å«åŒ¹é…çš„ä¼˜æƒ åˆ¸æ¨¡æ¿çš„åˆ†é¡µå¯¹è±¡
     */</span>
    <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplate</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAllByIdIn</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">,</span> <span class="token class-name">Pageable</span> pageable<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ ¹æ®å•†åº—IDå’Œå¯ç”¨çŠ¶æ€è®¡æ•°
     *
     * <span class="token keyword">@param</span> <span class="token parameter">shopId</span>    å•†åº—ID
     * <span class="token keyword">@param</span> <span class="token parameter">available</span> å¯ç”¨çŠ¶æ€
     * <span class="token keyword">@return</span> è®¡æ•°
     */</span>
    <span class="token class-name">Integer</span> <span class="token function">countByShopIdAndAvailable</span><span class="token punctuation">(</span><span class="token class-name">Long</span> shopId<span class="token punctuation">,</span> <span class="token class-name">Boolean</span> available<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * å°†ä¼˜æƒ åˆ¸æ¨¡æ¿è®¾ç½®ä¸ºä¸å¯ç”¨
     *
     * <span class="token keyword">@return</span> æ›´æ–°æˆåŠŸæ—¶è¿”å›ä¿®æ”¹çš„è¡Œæ•°
     * @Modifying è¡¨ç¤ºè¯¥æ³¨è§£ç”¨äºä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®
     * @Query è¡¨ç¤ºè¯¥æ³¨è§£ç”¨äºæ‰§è¡Œä¸€ä¸ª JPA æŸ¥è¯¢è¯­å¥
     */</span>
    <span class="token annotation punctuation">@Modifying</span>
    <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;update CouponTemplate c set c.available = 0 where c.id = :id&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">int</span> <span class="token function">makeCouponUnavailable</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> shopId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ <code>coupon-template-dao</code> æ¨¡å—ä¸­ï¼Œæ‚¨å¯èƒ½å¥½å¥‡å¦‚ä½•å®ç°å¢åŠ ã€åˆ é™¤å’Œä¿®æ”¹åŠŸèƒ½ï¼Œå› ä¸ºä»£ç ç¤ºä¾‹ä¸­ä¸»è¦å±•ç¤ºäº†æŸ¥è¯¢æ“ä½œã€‚å®é™…ä¸Šï¼Œè¿™äº›åŸºç¡€çš„æ•°æ®åº“æ“ä½œæ–¹æ³•éƒ½éšå«åœ¨ <code>CouponTemplateDao</code> ç»§æ‰¿çš„ <code>JpaRepository</code> æ¥å£å†…ã€‚</p><p><code>JpaRepository </code>æ¥å£æ˜¯ Spring Data JPA çš„å¿ƒè„ï¼Œå®ƒæä¾›äº†åŒ…æ‹¬ï¼š</p><ul><li><code>save()</code>: æ·»åŠ æˆ–æ›´æ–°æ•°æ®</li><li><code>delete()</code>: åˆ é™¤æ•°æ®</li><li><code>findOne()</code>, <code>findAll()</code>: æŸ¥è¯¢æ•°æ®</li></ul><p>ç­‰ç­‰ä¸€ç³»åˆ—æ ‡å‡†çš„æ•°æ®æ“ä½œæ–¹æ³•ã€‚</p><p>é™¤äº†åŸºæœ¬çš„ CRUD åŠŸèƒ½ï¼Œ<code>JpaRepository </code>è¿˜æä¾›äº†å¤šæ ·åŒ–çš„æŸ¥è¯¢æ–¹å¼ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>åŸºäºæ–¹æ³•åç§°çš„æŸ¥è¯¢</strong>ï¼šå¯ä»¥é€šè¿‡åœ¨æ¥å£æ–¹æ³•ä¸­å£°æ˜æŸ¥è¯¢æ¡ä»¶çš„æ–¹å¼æ¥æ„å»ºæŸ¥è¯¢ã€‚</li><li><strong>åŸºäº Example çš„æŸ¥è¯¢</strong>ï¼šä½¿ç”¨ä¸€ä¸ªå®ä½“å¯¹è±¡ä½œä¸ºæŸ¥è¯¢æ¨¡æ¿ã€‚</li><li><strong>è‡ªå®šä¹‰æŸ¥è¯¢</strong>ï¼šé€šè¿‡ <code>@Query</code> æ³¨è§£æ¥å®šä¹‰ SQL æˆ– JPQL æŸ¥è¯¢è¯­å¥ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œä½¿ç”¨åŸºäºæ–¹æ³•åç§°çš„æŸ¥è¯¢æ–¹å¼å¯ä»¥è¿™æ ·å®šä¹‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplate</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAllByShopId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> shopId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨ Spring Data JPA ä¸­ï¼Œè¿™ç§æŸ¥è¯¢æ–¹å¼çš„ä¼˜åŠ¿åœ¨äºå…¶ &quot;<strong>çº¦å®šä¼˜äºé…ç½®</strong>&quot; çš„è®¾è®¡ç†å¿µï¼Œç®€åŒ–äº†æŸ¥è¯¢æ“ä½œã€‚ä½ åªéœ€è¦æŒ‰è§„åˆ™æ„é€ æ–¹æ³•åç§°ï¼Œæ¡†æ¶å°±èƒ½ä¸ºä½ ç”Ÿæˆ SQLã€‚</p><p>ä½†éœ€éµå®ˆå‘½åè§„åˆ™ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><strong>èµ·å§‹è¯</strong>ï¼ˆå¦‚<code>find</code>ã€<code>count</code>ï¼‰</li><li><strong>å±æ€§åç§°</strong>ï¼ˆéœ€ä¸å®ä½“å±æ€§åŒ¹é…ï¼‰</li><li><strong>è¿æ¥è¯</strong>ï¼ˆå¦‚<code>And</code>ã€<code>Or</code>ï¼‰</li></ul><p>åŸºäºæ–¹æ³•åç§°çš„æŸ¥è¯¢åœ¨ç®€å•åœºæ™¯ä¸‹æ˜“äºä½¿ç”¨ï¼Œä½†å¯èƒ½éš¾ä»¥åº”å¯¹å¤æ‚æŸ¥è¯¢ã€‚å¯¹äºæ›´å¤æ‚çš„æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>@Query</code> æ³¨è§£æ¥è‡ªå®šä¹‰ SQL è¯­å¥ï¼Œå¦‚ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;update CouponTemplate c set c.available = false where c.id = :id&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">int</span> <span class="token function">makeCouponUnavailable</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…é‡‡ç”¨ Example æŸ¥è¯¢ï¼Œåˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ¨¡æ¿å®ä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">CouponTemplate</span> couponTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CouponTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
couponTemplate<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸åç§°&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplate</span><span class="token punctuation">&gt;</span></span> results <span class="token operator">=</span> templateDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>couponTemplate<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æ¨¡æ¿å¯¹è±¡çš„å±æ€§è¿›è¡ŒæŸ¥è¯¢ã€‚</p><p>OKï¼Œæœ‰äº† API å’Œ Dao å±‚çš„åŸºç¡€ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å°†è¿›å…¥ä¸šåŠ¡é€»è¾‘å±‚çš„å¼€å‘ï¼Œå³ <code>coupon-template-impl</code> æ¨¡å—ã€‚åœ¨è¿™ä¸€å±‚ä¸­ï¼Œæˆ‘ä»¬ä¼šåˆ©ç”¨å·²ç»æ­å»ºå¥½çš„ç»“æ„æ¥å®ç°å…·ä½“çš„ä¸šåŠ¡åŠŸèƒ½ã€‚</p><h3 id="_2-6-æ­å»º-coupon-template-impl-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_2-6-æ­å»º-coupon-template-impl-æ¨¡å—" aria-hidden="true">#</a> 2.6 æ­å»º coupon-template-impl æ¨¡å—</h3><h4 id="_2-6-1-ä¾èµ–é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-6-1-ä¾èµ–é…ç½®" aria-hidden="true">#</a> 2.6.1 ä¾èµ–é…ç½®</h4><p>å½“æˆ‘ä»¬å¼€å§‹æ­å»º <code>coupon-template-impl</code> æ¨¡å—æ—¶ï¼Œæˆ‘ä»¬å°†å…¶å®šä¹‰ä¸ºå®ç°ä¸šåŠ¡é€»è¾‘çš„æ ¸å¿ƒã€‚å®ƒå°†ä¾èµ–äºä¹‹å‰æ„å»ºçš„ <code>coupon-template-api</code> å’Œ <code>coupon-template-dao</code> æ¨¡å—ï¼ŒåŒæ—¶ï¼Œè¿˜ä¼šå¼•å…¥ä¸€äº›å¤–éƒ¨ä¾èµ–æ¥å¢å¼ºåŠŸèƒ½ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- API æ¨¡å— --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-template-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- DAO æ¨¡å— --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-template-dao<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Alibaba FastJson --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Spring Boot Web --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Apache Commons Codec --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>commons-codec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-codec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Google Guava --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.google.guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Spring Boot Actuator å¯¹å¾®æœåŠ¡ç«¯ç‚¹è¿›è¡Œç®¡ç†å’Œé…ç½®ç›‘æ§ --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-6-2-å®šä¹‰-service-å±‚æ¥å£" tabindex="-1"><a class="header-anchor" href="#_2-6-2-å®šä¹‰-service-å±‚æ¥å£" aria-hidden="true">#</a> 2.6.2 å®šä¹‰ Service å±‚æ¥å£</h4><p>é¦–å…ˆï¼Œå®šä¹‰ <code>CouponTemplateService</code> æ¥å£æ˜¯å…³é”®ï¼Œè¿™ä¸ªæ¥å£ä¼šè§„å®šäº†å‡ ä¸ªä¸»è¦æ–¹æ³•ï¼š</p><ul><li>åˆ›å»ºä¼˜æƒ åˆ¸æ¨¡æ¿</li><li>æŸ¥è¯¢ä¼˜æƒ åˆ¸æ¨¡æ¿</li><li>ä¿®æ”¹ä¼˜æƒ åˆ¸æ¨¡æ¿çŠ¶æ€</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·æ¨¡ç‰ˆæœåŠ¡æ¥å£
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CouponTemplateService</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * åˆ›å»ºä¼˜æƒ åˆ¸æ¨¡æ¿
     *
     * <span class="token keyword">@param</span> <span class="token parameter">couponTemplateInfo</span> ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯
     * <span class="token keyword">@return</span> åˆ›å»ºçš„ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯
     */</span>
    <span class="token class-name">CouponTemplateInfo</span> <span class="token function">createCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">CouponTemplateInfo</span> couponTemplateInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * å…‹éš†ä¼˜æƒ åˆ¸æ¨¡æ¿
     *
     * <span class="token keyword">@param</span> <span class="token parameter">templateId</span> æ¨¡æ¿ID
     * <span class="token keyword">@return</span> å…‹éš†çš„ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯
     */</span>
    <span class="token class-name">CouponTemplateInfo</span> <span class="token function">cloneCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">Long</span> templateId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æœç´¢ä¼˜æƒ åˆ¸æ¨¡æ¿
     *
     * <span class="token keyword">@param</span> <span class="token parameter">templateSearchParams</span> æœç´¢å‚æ•°
     * <span class="token keyword">@return</span> æœç´¢åˆ°çš„ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯
     */</span>
    <span class="token class-name">PagedCouponTemplateInfo</span> <span class="token function">searchCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">TemplateSearchParams</span> templateSearchParams<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * åŠ è½½ä¼˜æƒ åˆ¸æ¨¡æ¿
     *
     * <span class="token keyword">@param</span> <span class="token parameter">id</span> æ¨¡æ¿ID
     * <span class="token keyword">@return</span> åŠ è½½çš„ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯
     */</span>
    <span class="token class-name">CouponTemplateInfo</span> <span class="token function">loadCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * åˆ é™¤ä¼˜æƒ åˆ¸æ¨¡æ¿
     *
     * <span class="token keyword">@param</span> <span class="token parameter">id</span> æ¨¡æ¿ID
     */</span>
    <span class="token keyword">void</span> <span class="token function">deleteCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ ¹æ®æ¨¡æ¿IDåˆ—è¡¨è·å–ä¼˜æƒ åˆ¸æ¨¡æ¿Map
     *
     * <span class="token keyword">@param</span> <span class="token parameter">ids</span> æ¨¡æ¿IDåˆ—è¡¨
     * <span class="token keyword">@return</span> ä¼˜æƒ åˆ¸æ¨¡æ¿Map
     */</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">CouponTemplateInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCouponTemplateMap</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-6-3-å®ç°-service-å±‚é€»è¾‘" tabindex="-1"><a class="header-anchor" href="#_2-6-3-å®ç°-service-å±‚é€»è¾‘" aria-hidden="true">#</a> 2.6.3 å®ç° Service å±‚é€»è¾‘</h4><p><code>CouponTemplateServiceImpl </code>ç±»å°†å®ç°ä¸Šè¿°æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚é€šè¿‡ä¸ <code>CouponTemplateDao</code> äº¤äº’ï¼ŒService å±‚èƒ½å¤Ÿå®ç°å¯¹ä¼˜æƒ åˆ¸æ¨¡æ¿çš„ CRUD æ“ä½œã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·æ¨¡æ¿æœåŠ¡å®ç°
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponTemplateServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">CouponTemplateService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponTemplateDao</span> couponTemplateDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CouponTemplateInfo</span> <span class="token function">createCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">CouponTemplateInfo</span> couponTemplateInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å•ä¸ªå•†æˆ·æœ€å¤šå¯ä»¥åˆ›å»º 100 å¼ ä¼˜æƒ å·æ¨¡ç‰ˆ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>couponTemplateInfo<span class="token punctuation">.</span><span class="token function">getShopId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Integer</span> count <span class="token operator">=</span> couponTemplateDao<span class="token punctuation">.</span><span class="token function">countByShopIdAndAvailable</span><span class="token punctuation">(</span>couponTemplateInfo<span class="token punctuation">.</span><span class="token function">getShopId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è¯¥åº—é“ºä¼˜æƒ å·æ¨¡æ¿æ•°é‡è¶…è¿‡100&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">&quot;è¯¥åº—é“ºä¼˜æƒ å·æ¨¡æ¿æ•°é‡è¶…è¿‡100&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">CouponTemplate</span> couponTemplate <span class="token operator">=</span> <span class="token class-name">CouponTemplate</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span>couponTemplateInfo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span>couponTemplateInfo<span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">templateRule</span><span class="token punctuation">(</span>couponTemplateInfo<span class="token punctuation">.</span><span class="token function">getTemplateRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span>couponTemplateInfo<span class="token punctuation">.</span><span class="token function">getAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">shopId</span><span class="token punctuation">(</span>couponTemplateInfo<span class="token punctuation">.</span><span class="token function">getShopId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">category</span><span class="token punctuation">(</span><span class="token class-name">CouponType</span><span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>couponTemplateInfo<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">CouponTemplate</span> template <span class="token operator">=</span> couponTemplateDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>couponTemplate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CouponTemplateConverter</span><span class="token punctuation">.</span><span class="token function">converterTemplateInfo</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CouponTemplateInfo</span> <span class="token function">cloneCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">Long</span> templateId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;cloneCouponTemplate templateId: {}&quot;</span><span class="token punctuation">,</span> templateId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å‡†å¤‡æ‹·è´æºå’Œç›®æ ‡å¯¹è±¡</span>
        <span class="token class-name">CouponTemplate</span> source <span class="token operator">=</span> couponTemplateDao<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>templateId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;æ— æ•ˆçš„ä¼˜æƒ å·æ¨¡ç‰ˆID&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CouponTemplate</span> target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CouponTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æµ…æ‹·è´</span>
        <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å…¶ä»–æ•°æ®å¤„ç†</span>
        target<span class="token punctuation">.</span><span class="token function">setAvailable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        target<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å­˜å‚¨å¹¶è¿”å›</span>
        couponTemplateDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CouponTemplateConverter</span><span class="token punctuation">.</span><span class="token function">converterTemplateInfo</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PagedCouponTemplateInfo</span> <span class="token function">searchCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">TemplateSearchParams</span> templateSearchParams<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ›å»º JPA Example æŸ¥è¯¢æ¡ä»¶</span>
        <span class="token class-name">CouponTemplate</span> example <span class="token operator">=</span> <span class="token class-name">CouponTemplate</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">shopId</span><span class="token punctuation">(</span>templateSearchParams<span class="token punctuation">.</span><span class="token function">getShopId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">category</span><span class="token punctuation">(</span><span class="token class-name">CouponType</span><span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>templateSearchParams<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span>templateSearchParams<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span>templateSearchParams<span class="token punctuation">.</span><span class="token function">getAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°è£…åˆ†é¡µæŸ¥è¯¢å‚æ•°</span>
        <span class="token class-name">PageRequest</span> pageRequest <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>templateSearchParams<span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> templateSearchParams<span class="token punctuation">.</span><span class="token function">getPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplate</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> couponTemplateDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">,</span> pageRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplateInfo</span><span class="token punctuation">&gt;</span></span> couponTemplateInfoList <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">CouponTemplateConverter</span><span class="token operator">::</span><span class="token function">converterTemplateInfo</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">PagedCouponTemplateInfo</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">couponTemplateInfoList</span><span class="token punctuation">(</span>couponTemplateInfoList<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>templateSearchParams<span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">total</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getTotalElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CouponTemplateInfo</span> <span class="token function">loadCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplate</span><span class="token punctuation">&gt;</span></span> couponTemplate <span class="token operator">=</span> couponTemplateDao<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> couponTemplate<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">CouponTemplateConverter</span><span class="token operator">::</span><span class="token function">converterTemplateInfo</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteCouponTemplate</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> rows <span class="token operator">=</span> couponTemplateDao<span class="token punctuation">.</span><span class="token function">makeCouponUnavailable</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rows <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">&quot;æ— æ•ˆçš„ä¼˜æƒ å·æ¨¡ç‰ˆID&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">CouponTemplateInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCouponTemplateMap</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponTemplate</span><span class="token punctuation">&gt;</span></span> couponTemplateList <span class="token operator">=</span> couponTemplateDao<span class="token punctuation">.</span><span class="token function">findAllById</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> couponTemplateList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">CouponTemplateConverter</span><span class="token operator">::</span><span class="token function">converterTemplateInfo</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">CouponTemplateInfo</span><span class="token operator">::</span><span class="token function">getId</span><span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token punctuation">.</span><span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-6-4-è½¬æ¢ç±»çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_2-6-4-è½¬æ¢ç±»çš„ä½¿ç”¨" aria-hidden="true">#</a> 2.6.4 è½¬æ¢ç±»çš„ä½¿ç”¨</h4><p>åœ¨å®ç°è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šä½¿ç”¨åˆ°å„ç§è½¬æ¢ç±»ï¼ˆDTOsã€VOsç­‰ï¼‰æ¥åœ¨ä¸åŒå±‚ï¼ˆControllerã€Serviceã€DAOï¼‰é—´ä¼ è¾“æ•°æ®ã€‚è¿™äº›è½¬æ¢ç±»é€šå¸¸è´Ÿè´£å°†æ•°æ®åº“å®ä½“è½¬æ¢ä¸ºå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨çš„æ•°æ®æ¨¡å‹ï¼Œæˆ–è€…åä¹‹ã€‚</p><p>æ¶‰åŠåˆ°çš„è½¬æ¢ç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·æ¨¡æ¿è½¬æ¢å™¨
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponTemplateConverter</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CouponTemplateInfo</span> <span class="token function">converterTemplateInfo</span><span class="token punctuation">(</span><span class="token class-name">CouponTemplate</span> couponTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CouponTemplateInfo</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>couponTemplate<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span>couponTemplate<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span>couponTemplate<span class="token punctuation">.</span><span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>couponTemplate<span class="token punctuation">.</span><span class="token function">getCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">shopId</span><span class="token punctuation">(</span>couponTemplate<span class="token punctuation">.</span><span class="token function">getShopId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">templateRule</span><span class="token punctuation">(</span>couponTemplate<span class="token punctuation">.</span><span class="token function">getTemplateRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span>couponTemplate<span class="token punctuation">.</span><span class="token function">getAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-6-5-æ„å»º-controller" tabindex="-1"><a class="header-anchor" href="#_2-6-5-æ„å»º-controller" aria-hidden="true">#</a> 2.6.5 æ„å»º Controller</h4><p>æ¥ç€ï¼Œåˆ›å»º <code>CouponTemplateController</code> ç±»æ¥æä¾› RESTful æœåŠ¡ã€‚é€šè¿‡ä½¿ç”¨ Spring MVC çš„æ³¨è§£ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å°†åç«¯æœåŠ¡ä»¥ API çš„å½¢å¼æä¾›ç»™å®¢æˆ·ç«¯æˆ–å‰ç«¯ã€‚</p><p>æ§åˆ¶å™¨é€šå¸¸ä½¿ç”¨ä»¥ä¸‹æ³¨è§£ï¼š</p><table><thead><tr><th>æ³¨è§£</th><th>æè¿°</th></tr></thead><tbody><tr><td>@RestController</td><td>å£°æ˜è¿™æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œå¹¶å°†å…¶åŠ è½½åˆ° Spring ä¸Šä¸‹æ–‡ä¸­ã€‚</td></tr><tr><td>@RequestMapping</td><td>å®šä¹‰ç±»çº§åˆ«çš„è·¯ç”±ä¿¡æ¯ã€‚</td></tr><tr><td>@PostMapping/@GetMapping/@PutMapping</td><td>å®šä¹‰å…·ä½“çš„ HTTP æ“ä½œå’Œè·¯ç”±ã€‚</td></tr></tbody></table><p>ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·æ¨¡æ¿æ§åˆ¶å™¨
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/template&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponTemplateController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponTemplateService</span> couponTemplateService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/addTemplate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CouponTemplateInfo</span> <span class="token function">addTemplate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">CouponTemplateInfo</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Create coupon template: data={}&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> couponTemplateService<span class="token punctuation">.</span><span class="token function">createCouponTemplate</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/cloneTemplate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CouponTemplateInfo</span> <span class="token function">cloneTemplate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> templateId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Clone coupon template: data={}&quot;</span><span class="token punctuation">,</span> templateId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> couponTemplateService<span class="token punctuation">.</span><span class="token function">cloneCouponTemplate</span><span class="token punctuation">(</span>templateId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/getTemplate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CouponTemplateInfo</span> <span class="token function">getTemplate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Load template, id={}&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> couponTemplateService<span class="token punctuation">.</span><span class="token function">loadCouponTemplate</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/getBatch&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">CouponTemplateInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTemplateInBatch</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;ids&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;getTemplateInBatch: {}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> couponTemplateService<span class="token punctuation">.</span><span class="token function">getCouponTemplateMap</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/search&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">PagedCouponTemplateInfo</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">TemplateSearchParams</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;search templates, payload={}&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> couponTemplateService<span class="token punctuation">.</span><span class="token function">searchCouponTemplate</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/deleteTemplate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteTemplate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Load template, id={}&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        couponTemplateService<span class="token punctuation">.</span><span class="token function">deleteCouponTemplate</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-6-6-å¯åŠ¨ç±»çš„åˆ›å»º" tabindex="-1"><a class="header-anchor" href="#_2-6-6-å¯åŠ¨ç±»çš„åˆ›å»º" aria-hidden="true">#</a> 2.6.6 å¯åŠ¨ç±»çš„åˆ›å»º</h4><p>æœ€åï¼Œæˆ‘ä»¬åˆ›å»ºäº†<code>Application</code>ç±»ï¼Œè¿™æ˜¯æ•´ä¸ªåº”ç”¨çš„å…¥å£ç‚¹ã€‚<code>@SpringBootApplication</code> æ³¨è§£å°†è§¦å‘ Spring Boot çš„è‡ªåŠ¨é…ç½®æœºåˆ¶ã€‚</p><p>è¿™ä¸ªæ³¨è§£è¿˜è´Ÿè´£æ‰«æå¯åŠ¨ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…ä¸­çš„ç»„ä»¶ï¼Œå¹¶åœ¨ Spring ä¸Šä¸‹æ–‡ä¸­è‡ªåŠ¨æ³¨å†Œå®ƒä»¬ã€‚å¦‚æœéœ€è¦åŒ…å«å…¶ä»–è·¯å¾„ä¸‹çš„ç»„ä»¶ï¼Œ<code>@ComponentScan </code>æ³¨è§£å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŒ‡å®šé‚£äº›è·¯å¾„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableJpaAuditing</span> <span class="token comment">// å¯ç”¨ JPA çš„å®¡è®¡åŠŸèƒ½</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;cn.javgo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-6-7-é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-6-7-é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> 2.6.7 é…ç½®æ–‡ä»¶</h4><p>å®Œæˆä»£ç ç¼–å†™åï¼Œæ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯åˆ›å»ºå’Œé…ç½® <code>.properties </code>æ–‡ä»¶ã€‚è¿™ä¸ªé…ç½®æ–‡ä»¶åœ¨ <code>src/main/resources</code> ç›®å½•ä¸‹æ˜¯é¡¹ç›®çš„å…³é”®éƒ¨åˆ†ï¼Œå› ä¸ºå®ƒåŒ…å«äº†è¿æ¥æ•°æ®åº“å’Œå„ç§æœåŠ¡çš„å¿…è¦å‚æ•°ã€‚</p><p>é…ç½®æ–‡ä»¶çš„æ’°å†™ä¸ä»…éœ€è¦ç²¾ç¡®ï¼Œè¿˜éœ€è¦è€ƒè™‘åˆ°å¯è¯»æ€§å’Œæœªæ¥çš„å¯ç»´æŠ¤æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æ¨èçš„æœ€ä½³å®è·µï¼š</p><ul><li>ä½¿ç”¨æ¸…æ™°çš„æ³¨é‡Šæ¥æè¿°æ¯ä¸ªé…ç½®é¡¹çš„ä½œç”¨ï¼Œç‰¹åˆ«æ˜¯é‚£äº›ä¸å¸¸è§æˆ–å®¹æ˜“å¼•èµ·æ··æ·†çš„å‚æ•°ã€‚</li><li>ä¸ºäº†ä¿è¯åœ¨ä¸åŒç¯å¢ƒä¸‹çš„å…¼å®¹æ€§ï¼Œä¾‹å¦‚å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒï¼Œå¯ä»¥é‡‡ç”¨ <code>application-{profile}.properties</code> çš„æ–¹å¼æ¥ç®¡ç†ä¸åŒçš„é…ç½®ã€‚</li><li>å¯¹äº JDBC è¿æ¥å­—ç¬¦ä¸²ï¼Œç¡®ä¿å…¶æ ¼å¼å’Œå‚æ•°ä¸ä½ ä½¿ç”¨çš„æ•°æ®åº“ç‰ˆæœ¬å…¼å®¹ã€‚å¦‚æœä½¿ç”¨ MySQL 8.xï¼Œä¸è¦å¿˜è®°åŒ…æ‹¬å¦‚ <code>serverTimezone</code> çš„å¿…è¦å‚æ•°ã€‚</li><li>é‰´äºå®‰å…¨è€ƒè™‘ï¼Œæ•æ„Ÿä¿¡æ¯ï¼ˆæ¯”å¦‚æ•°æ®åº“å¯†ç ã€API å¯†é’¥ç­‰ï¼‰ä¸åº”è¯¥ç›´æ¥ç¡¬ç¼–ç åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚è€ƒè™‘ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–åŠ å¯†å·¥å…·æ¥ç®¡ç†è¿™äº›æ•æ„Ÿæ•°æ®ã€‚</li></ul><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># æœåŠ¡å™¨ç«¯å£</span>
<span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">20000</span>

<span class="token comment"># æ˜¯å¦åœ¨é”™è¯¯ä¿¡æ¯ä¸­åŒ…å«æ¶ˆæ¯</span>
<span class="token key attr-name">server.error.include-message</span><span class="token punctuation">=</span><span class="token value attr-value">always</span>

<span class="token comment"># åº”ç”¨åç§°</span>
<span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">coupon-template-serv</span>

<span class="token comment"># æ•°æ®åº“é©±åŠ¨ç±»å</span>
<span class="token key attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span>
<span class="token comment"># æ•°æ®åº“è¿æ¥URL</span>
<span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://127.0.0.1:3306/coupon_db?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false&amp;allowPublicKeyRetrieval=true&amp;zeroDateTimeBehavior=convertToNull&amp;serverTimezone=UTC</span>
<span class="token comment"># æ•°æ®åº“ç”¨æˆ·å</span>
<span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token comment"># æ•°æ®åº“å¯†ç </span>
<span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>

<span class="token comment"># æ•°æ®æºç±»å‹</span>
<span class="token key attr-name">spring.datasource.type</span><span class="token punctuation">=</span><span class="token value attr-value">com.zaxxer.hikari.HikariDataSource</span>
<span class="token comment"># æ•°æ®æºè¿æ¥æ± åç§°</span>
<span class="token key attr-name">spring.datasource.hikari.pool-name</span><span class="token punctuation">=</span><span class="token value attr-value">CouponHikari</span>
<span class="token comment"># è¿æ¥è¶…æ—¶æ—¶é—´</span>
<span class="token key attr-name">spring.datasource.hikari.connection-timeout</span><span class="token punctuation">=</span><span class="token value attr-value">5000</span>
<span class="token comment"># ç©ºé—²è¶…æ—¶æ—¶é—´</span>
<span class="token key attr-name">spring.datasource.hikari.idle-timeout</span><span class="token punctuation">=</span><span class="token value attr-value">30000</span>
<span class="token comment"># æœ€å¤§è¿æ¥æ± å¤§å°</span>
<span class="token key attr-name">spring.datasource.hikari.maximum-pool-size</span><span class="token punctuation">=</span><span class="token value attr-value">10</span>
<span class="token comment"># æœ€å°è¿æ¥æ± å¤§å°</span>
<span class="token key attr-name">spring.datasource.hikari.minimum-idle</span><span class="token punctuation">=</span><span class="token value attr-value">5</span>
<span class="token comment"># è¿æ¥ç”Ÿå‘½å‘¨æœŸ</span>
<span class="token key attr-name">spring.datasource.hikari.max-lifetime</span><span class="token punctuation">=</span><span class="token value attr-value">60000</span>
<span class="token comment"># è‡ªåŠ¨æäº¤</span>
<span class="token key attr-name">spring.datasource.hikari.auto-commit</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>

<span class="token comment"># æ˜¯å¦æ˜¾ç¤º Hibernate SQL è¯­å¥</span>
<span class="token key attr-name">spring.jpa.show-sql</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># JPA ç”ŸæˆDDLçš„æ–¹å¼</span>
<span class="token key attr-name">spring.jpa.hibernate.ddl-auto</span><span class="token punctuation">=</span><span class="token value attr-value">none</span>
<span class="token comment"># Hibernate SQL è¯­å¥æ ¼å¼åŒ–</span>
<span class="token key attr-name">spring.jpa.properties.hibernate.format_sql</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># Hibernate SQL è¯­å¥æ˜¾ç¤º</span>
<span class="token key attr-name">spring.jpa.properties.hibernate.show_sql</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># æ˜¯å¦åœ¨è§†å›¾ä¸­æ‰“å¼€ JPA è¿æ¥</span>
<span class="token key attr-name">spring.jpa.open-in-view</span><span class="token punctuation">=</span><span class="token value attr-value">false</span>

<span class="token comment"># æ—¥å¿—çº§åˆ«</span>
<span class="token key attr-name">logging.level.cn.javgo.coupon</span><span class="token punctuation">=</span><span class="token value attr-value">debug</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ä¼˜æƒ åˆ¸å¹³å°çš„é¦–ä¸ªæ¨¡å— <code>coupon-template-serv</code> å·²ç»æ„å»ºå®Œæˆã€‚ä½ å¯ä»¥åœ¨æœ¬åœ°å¯åŠ¨é¡¹ç›®ï¼Œå¹¶ä½¿ç”¨ Postman å·¥å…·è¿›è¡Œæµ‹è¯•ã€‚ä½ ä¹Ÿå¯ä»¥è‡ªè¡ŒåŠ å…¥ Swaggerï¼š</p><figure><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-17-134423.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2-6-8-æ¨¡å—å°ç»“" tabindex="-1"><a class="header-anchor" href="#_2-6-8-æ¨¡å—å°ç»“" aria-hidden="true">#</a> 2.6.8 æ¨¡å—å°ç»“</h4><p>åœ¨æœ¬æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬å®Œæˆäº† <code>coupon-template-serv</code> çš„æ­å»ºï¼Œè¿™æ˜¯ä¼˜æƒ åˆ¸å¹³å°çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ã€‚æˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•æœ‰æ•ˆåˆ©ç”¨ Spring Boot çš„åŠŸèƒ½ï¼Œç®€åŒ–äº†æœåŠ¡çš„å®ç°ï¼Œå¹¶ä»‹ç»äº†å¦‚ä½•é€šè¿‡ Spring Data JPA é«˜æ•ˆåœ°æ“ä½œæ•°æ®åº“ã€‚</p><p>å…³é”®æŠ€æœ¯ç‚¹å›é¡¾ï¼š</p><ul><li>ä½¿ç”¨ <code>spring-data-jpa</code> è¿›è¡Œæ•°æ®åº“æ“ä½œï¼Œå®ç°äº† CRUD åŠŸèƒ½ï¼Œå¹¶é€šè¿‡å®ƒä½“éªŒåˆ°äº† Spring çš„ â€œçº¦å®šä¼˜äºé…ç½®â€ çš„ç†å¿µã€‚</li><li>å¼ºè°ƒäº†ä»£ç çš„é˜²å¾¡æ€§ç¼–ç¨‹ã€è‡ªåŠ¨åŒ–ç”Ÿæˆã€å’Œç²¾ç¡®çš„é‡‘é¢è®¡ç®—ç­‰ç¼–ç æŠ€å·§ã€‚</li><li>æ¢è®¨äº†æ•°æ®æ ¡éªŒçš„ç®€åŒ–æ–¹æ³•å’Œé¿å…çº§è”å…³ç³»çš„å¸¸è§é™·é˜±ã€‚</li></ul><p>é€šè¿‡ä»¥ä¸Šçš„æ¢ç´¢å’Œå­¦ä¹ ï¼Œä½ ç°åœ¨åº”è¯¥å¯¹æ„å»ºä¸€ä¸ªæ¨¡å—åŒ–ã€å¯æ‰©å±•çš„ Spring Boot åº”ç”¨æœ‰äº†æ·±å…¥çš„ç†è§£ã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ­å»º<code>coupon-calculation-serv</code> å’Œ <code>coupon-customer-serv</code> æ¨¡å—ï¼Œè¿›ä¸€æ­¥æ‰©å±•æˆ‘ä»¬çš„ä¼˜æƒ åˆ¸å¹³å°ã€‚</p><h2 id="_3-æ­å»ºä¼˜æƒ åˆ¸è®¡ç®—æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_3-æ­å»ºä¼˜æƒ åˆ¸è®¡ç®—æœåŠ¡" aria-hidden="true">#</a> 3.æ­å»ºä¼˜æƒ åˆ¸è®¡ç®—æœåŠ¡</h2><p>é€šè¿‡å‰é¢çš„ç« èŠ‚ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡ <code>coupon-template-serv</code> çš„æ­å»ºï¼Œå¹¶å¯¹ Spring Boot æœ‰äº†æ›´æ·±å±‚æ¬¡çš„ç†è§£ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·±å…¥å¼€å‘ä¼˜æƒ åˆ¸ç³»ç»Ÿçš„ä¸¤ä¸ªå…³é”®ç»„ä»¶ï¼š<code>coupon-calculation-serv</code>ï¼ˆè´Ÿè´£ä¼˜æƒ è®¡ç®—ï¼‰å’Œ<code>coupon-customer-serv</code>ï¼ˆå‘ç”¨æˆ·æä¾›æœåŠ¡ï¼‰ã€‚åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œä¸­é—´ä»¶æ¨¡å— <code>middleware</code> çš„è¯¦ç»†æ¢è®¨å°†æ”¾åœ¨æ¶‰åŠ Spring Cloud çš„éƒ¨åˆ†è¿›è¡Œã€‚</p><p>æˆ‘ä»¬çš„ç¬¬ä¸€æ­¥æ˜¯å»ºç«‹ <code>coupon-calculation-serv</code>ï¼Œä¸€ä¸ªä¸“æ³¨äºä¸ºè®¢å•æä¾›ä¼˜æƒ è®¡ç®—çš„æœåŠ¡æ¥å£ã€‚<code>coupon-calculation-serv</code> ä½œä¸ºå…¸å‹çš„è®¡ç®—å¯†é›†å‹æœåŠ¡ï¼Œå…¶ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><ol><li>ä¸å—ç½‘ç»œ I/O å’Œç£ç›˜ç©ºé—´é™åˆ¶ï¼›</li><li>åœ¨è¿è¡Œæ—¶ä¸»è¦æ¶ˆè€— CPU å’Œå†…å­˜ç­‰è®¡ç®—èµ„æºã€‚</li></ol><p>åœ¨æ„å»ºå¤§å‹åº”ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæŠŠ<strong>è®¡ç®—å¯†é›†å‹æœåŠ¡å’Œ I/O æˆ–å­˜å‚¨å¯†é›†å‹æœåŠ¡åˆ†ç¦»</strong>å¼€ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¼˜åŒ–èµ„æºä½¿ç”¨æ•ˆç‡ã€‚ä»¥ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜ï¼Œå‡è®¾æˆ‘ä»¬åŒæ—¶è¿è¡Œä¸€ä¸ªè®¡ç®—å¯†é›†å‹çš„å¾®æœåŠ¡ A å’Œä¸€ä¸ª I/O å¯†é›†å‹çš„å¾®æœåŠ¡ Bã€‚åœ¨é«˜æµé‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæœåŠ¡ A åˆ†é…æ›´å¤šçš„ CPU å’Œå†…å­˜èµ„æºæ¥åº”å¯¹å‹åŠ›ï¼›å¯¹äºæœåŠ¡ Bï¼Œåˆ™å¯ä»¥å¢åŠ äº‘å­˜å‚¨èµ„æºã€‚è¿™æ · â€œ<strong>æŒ‰éœ€åˆ†é…</strong>â€ çš„ç­–ç•¥èƒ½å¤Ÿæœ‰æ•ˆåœ°æé«˜èµ„æºä½¿ç”¨ç‡ã€‚</p><p>å¦‚æœæˆ‘ä»¬å°†æœåŠ¡ A å’Œ B åˆå¹¶åœ¨ä¸€èµ·ï¼Œå°±ä¼šå¤±å»å¯¹èµ„æºåˆ†é…çš„ç²¾ç¡®æ§åˆ¶ï¼Œå…¨é“¾è·¯å‹åŠ›æµ‹è¯•ä¹Ÿæ— æ³•å‡†ç¡®è¯„ä¼°æ€§èƒ½æŒ‡æ ‡ï¼Œä»è€Œå¯èƒ½é€ æˆèµ„æºçš„æµªè´¹ã€‚å› æ­¤ï¼Œæˆ‘å»ºè®®å°†ä¼˜æƒ è®¡ç®—æœåŠ¡ç‹¬ç«‹å‡ºæ¥ï¼Œä»¥å®ç°æ›´åˆç†çš„èµ„æºé…ç½®ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬ç€æ‰‹æ„å»º <code>coupon-calculation-serv</code>ã€‚å®ƒå°†åŒ…å«å¤šä¸ªå­æ¨¡å—ï¼Œç±»ä¼¼äº <code>coupon-template-serv</code> çš„ç»“æ„ï¼ŒåŒ…æ‹¬ API å±‚å’Œä¸šåŠ¡é€»è¾‘å±‚ã€‚API å±‚è´Ÿè´£å®šä¹‰å…¬å…±çš„ POJO ç±»ï¼Œè€Œä¸šåŠ¡é€»è¾‘å±‚åˆ™ä¸“æ³¨äºä¼˜æƒ è®¡ç®—é€»è¾‘çš„å®ç°ã€‚ç”±äºä¼˜æƒ è®¡ç®—æœåŠ¡ä¸æ¶‰åŠæ•°æ®åº“æ“ä½œï¼Œæˆ‘ä»¬å°†ä¸åŒ…å« DAO æ¨¡å—ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆä» <code>coupon-calculation-api</code> å­æ¨¡å—å…¥æ‰‹ï¼Œè¿™æ˜¯æ•´ä¸ªæœåŠ¡çš„æ¥å£å±‚ã€‚</p><h3 id="_3-1-æ­å»º-coupon-calculation-api-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_3-1-æ­å»º-coupon-calculation-api-æ¨¡å—" aria-hidden="true">#</a> 3.1 æ­å»º coupon-calculation-api æ¨¡å—</h3><p>ä¸ºäº†ä½¿ <code>coupon-calculation-serv</code> èƒ½å¤Ÿè®¡ç®—è®¢å•çš„ä¼˜æƒ ä»·æ ¼ï¼Œå®ƒéœ€è¦çŸ¥é“å½“å‰è®¢å•ä½¿ç”¨äº†å“ªäº›ä¼˜æƒ åˆ¸ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å¼•å…¥å°è£…ä¼˜æƒ åˆ¸ä¿¡æ¯çš„ Java ç±»<code>CouponInfo</code>ï¼Œè¯¥ç±»ä½äº <code>coupon-template-api</code> åŒ…ä¸­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åœ¨ <code>coupon-calculation-api</code> ä¸­æ·»åŠ  <code>coupon-template-api</code> çš„ä¾èµ–é¡¹ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-template-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¾èµ–é¡¹æ·»åŠ å®Œæ¯•åï¼Œæˆ‘ä»¬ç»§ç»­å®šä¹‰ç”¨äºå°è£…è®¢å•ä¿¡æ¯çš„ <code>ShoppingCart </code>ç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å°è£…è®¢å•ä¿¡æ¯
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShoppingCart</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * å•†å“ä¿¡æ¯
     */</span>
    <span class="token annotation punctuation">@NotEmpty</span>
    <span class="token keyword">private</span> <span class="token class-name">Product</span> product<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ä¼˜æƒ åˆ¸ID
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> couponId<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * è®¢å•æ€»ä»·
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> cost<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ä¼˜æƒ åˆ¸ä¿¡æ¯åˆ—è¡¨
     * è¯´æ˜ï¼šç›®å‰ä»…æ”¯æŒå•å¼ ä¼˜æƒ åˆ¸ï¼Œä½†æ˜¯ä¸ºäº†ä»¥åçš„æ‰©å±•è€ƒè™‘ï¼Œä½ å¯ä»¥æ·»åŠ å¤šä¸ªä¼˜æƒ åˆ¸çš„è®¡ç®—é€»è¾‘
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponInfo</span><span class="token punctuation">&gt;</span></span> couponInfos<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ç”¨æˆ·ID
     */</span>
    <span class="token annotation punctuation">@NotNull</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>ShoppingCart</code> è®¢å•ç±»ä½¿ç”¨äº† <code>Product</code> å¯¹è±¡æ¥å°è£…å½“å‰è®¢å•çš„å•†å“åˆ—è¡¨ã€‚<code>Product</code> ç±»ä¸­åŒ…å«äº†å•†å“çš„å•ä»·ã€æ•°é‡ä»¥åŠé—¨åº—IDã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å°è£…å•†å“ä¿¡æ¯
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * ä½ å¯ä»¥è¯•ç€æ­å»ºä¸€ä¸ªå•†å“ä¸­å¿ƒï¼Œç”¨æ¥å­˜å‚¨å•†å“ä¿¡æ¯ï¼Œé€æ­¥å®Œå–„è¿™ä¸ªåº”ç”¨
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> productId<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * å•†å“çš„ä»·æ ¼
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> price<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * å•†å“åœ¨è´­ç‰©è½¦é‡Œçš„æ•°é‡
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> count<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * å•†å“é”€å”®çš„é—¨åº—
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> shopId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>åœ¨ç”µå•†è¡Œä¸šï¼Œå•†å“æ•°é‡é€šå¸¸ä¸ä»…ä»…æ˜¯æ•´æ•°ã€‚ä¾‹å¦‚ï¼Œå¯¹äºè”¬èœæˆ–è‚‰ç±»è¿™æ ·çš„éæ ‡å‡†å•†å“ï¼Œå®ƒä»¬çš„è®¡é‡å•ä½å¯èƒ½ä¸æ˜¯ â€œä¸ªâ€ã€‚å› æ­¤ï¼Œåœ¨å®é™…çš„é¡¹ç›®ä¸­ï¼Œç‰¹åˆ«æ˜¯é›¶å”®ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œè®¡é‡å•ä½åº”è¯¥å…è®¸å°æ•°ã€‚ä½†ä¸ºäº†ç®€åŒ–æœ¬é¡¹ç›®ï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰å•†å“éƒ½æ˜¯æ ‡å‡†å•†å“ã€‚</p></blockquote><p>åœ¨ä¸‹å•æ—¶ï¼Œå¯èƒ½æœ‰å¤šå¼ ä¼˜æƒ åˆ¸å¯ä¾›é€‰æ‹©ã€‚ä¸ºäº†ç¡®å®šå“ªå¼ ä¼˜æƒ åˆ¸æä¾›çš„æŠ˜æ‰£æœ€å¤§ï¼Œä½ éœ€è¦è¿›è¡Œ â€œ<strong>ä»·æ ¼è¯•ç®—</strong>â€ æ¥æ¨¡æ‹Ÿè®¡ç®—æ¯å¼ ä¼˜æƒ åˆ¸çš„æŠ˜æ‰£é‡‘é¢ã€‚<code>SimulationOrder</code> å’Œ <code>SimulationResponse</code> åˆ†åˆ«ä»£è¡¨äº† â€œä»·æ ¼è¯•ç®—â€ çš„è®¢å•ç±»å’Œè¿”å›çš„è®¡ç®—ç»“æœã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹è¿™ä¸¤ä¸ªç±»çš„ä»£ç ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å°è£…æ¨¡æ‹Ÿè®¢å•ä¿¡æ¯ï¼šç”¨äºè¯•ç®—æœ€ä¼˜çš„ä¼˜æƒ åˆ¸
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimulationOrder</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * å•†å“ä¿¡æ¯åˆ—è¡¨
     */</span>
    <span class="token annotation punctuation">@NotEmpty</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> products<span class="token punctuation">;</span>
    
    <span class="token doc-comment comment">/**
     * ä¼˜æƒ åˆ¸IDåˆ—è¡¨
     */</span>
    <span class="token annotation punctuation">@NotEmpty</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> couponIDs<span class="token punctuation">;</span>
    
    <span class="token doc-comment comment">/**
     * ä¼˜æƒ åˆ¸ä¿¡æ¯åˆ—è¡¨
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponInfo</span><span class="token punctuation">&gt;</span></span> couponInfos<span class="token punctuation">;</span>
    
    <span class="token doc-comment comment">/**
     * ç”¨æˆ·ID
     */</span>
    <span class="token annotation punctuation">@NotNull</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å°è£…æ¨¡æ‹Ÿè®¡ç®—ç»“æœ
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimulationResponse</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æœ€çœé’±çš„ä¼˜æƒ å· ID
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> bestCouponId<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ¯ä¸€ä¸ªä¼˜æƒ å·å¯¹åº”çš„è®¢å•ä»·æ ¼
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> couponToOrderPrice <span class="token operator">=</span> <span class="token class-name">Maps</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³æ­¤ï¼Œ<code>coupon-calculation-api </code>æ¨¡å—çš„æ­å»ºå·²ç»å®Œæˆã€‚ç”±äºè®¡ç®—æœåŠ¡ä¸éœ€è¦è®¿é—®æ•°æ®åº“ï¼Œæˆ‘ä»¬å¯ä»¥è·³è¿‡ dao æ¨¡å—çš„æ­å»ºï¼Œç›´æ¥è¿›å…¥ <code>coupon-calculation-impl</code> ä¸šåŠ¡å±‚çš„ä»£ç å®ç°ã€‚</p><h3 id="_3-2-æ­å»º-coupon-calculation-impl-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_3-2-æ­å»º-coupon-calculation-impl-æ¨¡å—" aria-hidden="true">#</a> 3.2 æ­å»º coupon-calculation-impl æ¨¡å—</h3><h4 id="_3-2-1-ä¾èµ–é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3-2-1-ä¾èµ–é…ç½®" aria-hidden="true">#</a> 3.2.1 ä¾èµ–é…ç½®</h4><p>åœ¨å®ç° <code>coupon-calculation-impl</code> æ¨¡å—ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å…¶ <code>pom.xml </code>ä¸­æ˜ç¡®åŠ å…¥ä¸‰ä¸ªæ ¸å¿ƒä¾èµ–ã€‚è¿™äº›ä¾èµ–é¡¹ï¼Œå°¤å…¶æ˜¯ <code>coupon-template-api</code> å’Œ <code>coupon-calculation-api</code>ï¼Œå°†ä¸ºæˆ‘ä»¬æä¾›å®Œæˆè®¢å•ä¼˜æƒ è®¡ç®—æ‰€éœ€çš„ POJO å¯¹è±¡ã€‚è¿™æ˜¯æ„å»ºä¼˜æƒ è®¡ç®—é€»è¾‘çš„åŸºç¡€ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-template-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-calculation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-2-æ¨¡ç‰ˆè®¾è®¡æ¨¡å¼åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_3-2-2-æ¨¡ç‰ˆè®¾è®¡æ¨¡å¼åˆ†æ" aria-hidden="true">#</a> 3.2.2 æ¨¡ç‰ˆè®¾è®¡æ¨¡å¼åˆ†æ</h4><p>ä¸ºäº†ä¼˜é›…åœ°å®ç°ä¼˜æƒ è®¡ç®—é€»è¾‘ï¼Œæˆ‘é€‰æ‹©äº†<strong>æ¨¡æ¿è®¾è®¡æ¨¡å¼</strong>ã€‚è¯¥æ¨¡å¼é€šè¿‡æŠ½è±¡ç±»å®šä¹‰ç®—æ³•çš„æ¡†æ¶ï¼Œå°†å…·ä½“å®ç°ç•™ç»™å­ç±»å®Œæˆã€‚é‰´äºä¼˜æƒ åˆ¸ç±»å‹çš„å¤šæ ·æ€§ï¼ˆå¦‚æ»¡å‡ã€æŠ˜æ‰£ã€éšæœºç«‹å‡ç­‰ï¼‰ï¼Œå®ƒä»¬çš„è®¡ç®—æµç¨‹å…·æœ‰å…±æ€§ï¼Œä½†æ¯ä¸ªçš„è®¡ç®—ç»†èŠ‚å„ä¸ç›¸åŒï¼Œæ¨¡æ¿è®¾è®¡æ¨¡å¼ä¸ºå¤„ç†è¿™ä¸€é—®é¢˜æä¾›äº†å®Œç¾è§£å†³æ–¹æ¡ˆã€‚</p><p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬çš„è®¡ç®—é€»è¾‘ç±»ç»“æ„å›¾ï¼š</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-11-04-134259.png" style="zoom:50%;"><p>åœ¨æ­¤ç»“æ„ä¸­ï¼Œ<code>RuleTemplate </code> é¡¶å±‚æ¥å£å®šä¹‰äº† <code>calculate</code> æ–¹æ³•ç”¨äºè®¡ç®—ä¼˜æƒ åˆ¸ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ¨¡ç‰ˆæ¨¡å¼ï¼šä¼˜æƒ åˆ¸è®¡ç®—è§„åˆ™æ¥å£
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">RuleTemplate</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—è´­ç‰©è½¦é‡‘é¢
     *
     * <span class="token keyword">@param</span> <span class="token parameter">shoppingCart</span> è´­ç‰©è½¦å¯¹è±¡
     * <span class="token keyword">@return</span> è®¡ç®—åçš„è´­ç‰©è½¦é‡‘é¢
     */</span>
    <span class="token class-name">ShoppingCart</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> shoppingCart<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ª <code>AbstractRuleTemplate</code> æŠ½è±¡ç±»å°è£…é€šç”¨é€»è¾‘ï¼Œå¹¶ä¸ºä¸åŒç±»å‹çš„ä¼˜æƒ åˆ¸å„æä¾›ä¸€ä¸ªå…·ä½“å­ç±»æ¥å®ç°å…¶ç‹¬æœ‰çš„è®¡ç®—é€»è¾‘ã€‚<code>AbstractRuleTemplate </code>ç±»æä¾›äº†ä¸€ä¸ª <code>calculate</code> æ–¹æ³•çš„å®ç°æ¡†æ¶ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ªå¾…å­ç±»å®ç°çš„ <code>calculateNewPrice</code> æŠ½è±¡æ–¹æ³•ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ¨¡ç‰ˆæŠ½è±¡ç±»ï¼šå®ç°é€šç”¨ä¼˜æƒ å·è®¡ç®—è§„åˆ™ä»¥å¤ç”¨ï¼ŒåŒæ—¶æä¾›æŠ½è±¡æ–¹æ³•ç»™å­ç±»å®ç°å„è‡ªçš„è®¡ç®—è§„åˆ™ï¼ˆè®¾è®¡ç­–ç•¥æ¨¡å¼ï¼‰
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/3
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractRuleTemplate</span> <span class="token keyword">implements</span> <span class="token class-name">RuleTemplate</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—ä¼˜æƒ åçš„è´­ç‰©è½¦ä»·æ ¼
     *
     * <span class="token keyword">@param</span> <span class="token parameter">order</span> è´­ç‰©è½¦è®¢å•
     * <span class="token keyword">@return</span> è®¡ç®—åçš„è´­ç‰©è½¦è®¢å•
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ShoppingCart</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è®¡ç®—è®¢å•æ€»é‡‘é¢</span>
        <span class="token keyword">long</span> orderTotalAmount <span class="token operator">=</span> <span class="token function">getTotalPrice</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŒ‰åº—é“ºåˆ†ç»„è®¡ç®—è®¢å•æ€»é‡‘é¢</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> orderTotalAmountGroupByShop <span class="token operator">=</span> <span class="token function">getTotalPriceGroupByShop</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è·å–ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯</span>
        <span class="token class-name">CouponTemplateInfo</span> templateInfo <span class="token operator">=</span> order<span class="token punctuation">.</span><span class="token function">getCouponInfos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTemplateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–ä¼˜æƒ åˆ¸çš„æœ€ä½æ¶ˆè´¹é™åˆ¶</span>
        <span class="token class-name">Long</span> threshold <span class="token operator">=</span> templateInfo<span class="token punctuation">.</span><span class="token function">getTemplateRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDiscount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getThreshold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–ä¼˜æƒ åˆ¸çš„ä½¿ç”¨é™é¢</span>
        <span class="token class-name">Long</span> quota <span class="token operator">=</span> templateInfo<span class="token punctuation">.</span><span class="token function">getTemplateRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDiscount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQuota</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è·å–ä¼˜æƒ åˆ¸æ‰€å±åº—é“ºID</span>
        <span class="token class-name">Long</span> shopId <span class="token operator">=</span> templateInfo<span class="token punctuation">.</span><span class="token function">getShopId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¡ç®—åº—é“ºæ€»é‡‘é¢ï¼ˆå¦‚æœshopIdä¸ºç©ºï¼Œåˆ™ä½¿ç”¨è®¢å•æ€»é‡‘é¢ï¼›å¦åˆ™ä½¿ç”¨æŒ‰åº—é“ºåˆ†ç»„çš„è®¢å•æ€»é‡‘é¢ï¼‰</span>
        <span class="token class-name">Long</span> shopTotalAmount <span class="token operator">=</span> <span class="token punctuation">(</span>shopId <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> orderTotalAmount <span class="token operator">:</span> orderTotalAmountGroupByShop<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>shopId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœåº—é“ºæ€»é‡‘é¢å°äºæœ€ä½æ¶ˆè´¹é™åˆ¶ï¼Œä¸é€‚ç”¨ä¼˜æƒ åˆ¸</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>shopTotalAmount <span class="token operator">&lt;</span> threshold<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;è®¢å•æ€»ä»·å°äºä¼˜æƒ å·çš„æœ€ä½æ¶ˆè´¹é™åˆ¶ï¼Œä¸é€‚ç”¨ä¼˜æƒ å·ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            order<span class="token punctuation">.</span><span class="token function">setCost</span><span class="token punctuation">(</span>orderTotalAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
            order<span class="token punctuation">.</span><span class="token function">setCouponInfos</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> order<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// è®¡ç®—æ–°çš„ä»·æ ¼ï¼ˆæ ¹æ®è®¢å•æ€»é‡‘é¢ã€åº—é“ºæ€»é‡‘é¢å’Œä½¿ç”¨é™é¢ï¼‰</span>
        <span class="token class-name">Long</span> newCost <span class="token operator">=</span> <span class="token function">calculateNewPrice</span><span class="token punctuation">(</span>orderTotalAmount<span class="token punctuation">,</span> shopTotalAmount<span class="token punctuation">,</span> quota<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœæ–°çš„ä»·æ ¼å°äºæœ€å°æˆæœ¬ï¼Œè®¾ä¸ºæœ€å°æˆæœ¬ï¼ˆè‡³å°‘ 1 åˆ†é’±ï¼‰</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newCost <span class="token operator">&lt;</span> <span class="token function">minCost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newCost <span class="token operator">=</span> <span class="token function">minCost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// æ›´æ–°è®¢å•çš„æˆæœ¬å’Œä¼˜æƒ åˆ¸ä¿¡æ¯</span>
        order<span class="token punctuation">.</span><span class="token function">setCost</span><span class="token punctuation">(</span>newCost<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸è®¡ç®—æˆåŠŸï¼Œè®¢å•æ€»ä»·ï¼š{}ï¼Œä¼˜æƒ åˆ¸ä¼˜æƒ é‡‘é¢ï¼š{}ï¼Œä¼˜æƒ åè®¢å•æ€»ä»·ï¼š{}&quot;</span><span class="token punctuation">,</span> orderTotalAmount<span class="token punctuation">,</span> orderTotalAmount <span class="token operator">-</span> newCost<span class="token punctuation">,</span> newCost<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> order<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—æ–°çš„ä»·æ ¼ï¼ˆç­–ç•¥æ¨¡å¼ï¼Œç•™ç»™å­ç±»æ ¹æ®ä¸åŒç±»å‹çš„ä¼˜æƒ å·è®¡ç®—è§„åˆ™å®ç°ï¼‰
     *
     * <span class="token keyword">@param</span> <span class="token parameter">orderTotalAmount</span> è®¢å•æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">shopTotalAmount</span>  åº—é“ºæ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">quota</span>            ä½¿ç”¨é™é¢
     * <span class="token keyword">@return</span> è®¡ç®—åçš„æ–°ä»·æ ¼
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token class-name">Long</span> <span class="token function">calculateNewPrice</span><span class="token punctuation">(</span><span class="token class-name">Long</span> orderTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> shopTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> quota<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—è®¢å•çš„æ€»é‡‘é¢
     *
     * <span class="token keyword">@param</span> <span class="token parameter">products</span> è®¢å•äº§å“åˆ—è¡¨
     * <span class="token keyword">@return</span> è®¢å•çš„æ€»é‡‘é¢
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">long</span> <span class="token function">getTotalPrice</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> products<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> products<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">mapToLong</span><span class="token punctuation">(</span>product <span class="token operator">-&gt;</span> product<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> product<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * æŒ‰åº—é“ºåˆ†ç»„è®¡ç®—è®¢å•çš„æ€»é‡‘é¢
     *
     * <span class="token keyword">@param</span> <span class="token parameter">products</span> è®¢å•äº§å“åˆ—è¡¨
     * <span class="token keyword">@return</span> æŒ‰åº—é“ºåˆ†ç»„çš„è®¢å•æ€»é‡‘é¢ map
     */</span>
    <span class="token keyword">protected</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTotalPriceGroupByShop</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> products<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> products<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>
                        <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span>
                                <span class="token class-name">Product</span><span class="token operator">::</span><span class="token function">getShopId</span><span class="token punctuation">,</span>
                                <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">summingLong</span><span class="token punctuation">(</span>product <span class="token operator">-&gt;</span> product<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> product<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * è·å–æœ€å°æˆæœ¬
     *
     * <span class="token keyword">@return</span> æœ€å°æˆæœ¬
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">long</span> <span class="token function">minCost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">1L</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¾‹å¦‚ï¼Œæ»¡å‡è§„åˆ™çš„å®ç° <code>MoneyOffTemplate</code> ç»§æ‰¿äº† <code>AbstractRuleTemplate</code>ï¼Œåªéœ€æä¾› <code>calculateNewPrice</code> æ–¹æ³•çš„å…·ä½“å®ç°å³å¯ï¼Œè¿™æ ·çš„è®¾è®¡ç®€æ´ä¸”å‡å°‘äº†ä»£ç é‡å¤ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·ç­–ç•¥ï¼šæ»¡å‡
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MoneyOffTemplate</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractRuleTemplate</span> <span class="token keyword">implements</span> <span class="token class-name">RuleTemplate</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—æ–°çš„ä»·æ ¼
     *
     * <span class="token keyword">@param</span> <span class="token parameter">orderTotalAmount</span> è®¢å•æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">shopTotalAmount</span>  å•†åº—æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">quota</span>            ä¼˜æƒ é¢åº¦(è¿™é‡ŒæŒ‡æ»¡å‡é¢åº¦ï¼‰
     * <span class="token keyword">@return</span> æ–°çš„ä»·æ ¼
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Long</span> <span class="token function">calculateNewPrice</span><span class="token punctuation">(</span><span class="token class-name">Long</span> orderTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> shopTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> quota<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è®¡ç®—ä¼˜æƒ é¢åº¦ï¼šå–å•†åº—æ€»é‡‘é¢å’Œä¼˜æƒ é¢åº¦çš„æœ€å°å€¼</span>
        <span class="token class-name">Long</span> benefitAmount <span class="token operator">=</span> shopTotalAmount <span class="token operator">&lt;</span> quota <span class="token operator">?</span> shopTotalAmount <span class="token operator">:</span> quota<span class="token punctuation">;</span>
        <span class="token comment">// è®¡ç®—æœ€ç»ˆçš„ä»·æ ¼ï¼šè®¢å•æ€»é‡‘é¢å‡å»ä¼˜æƒ é¢åº¦</span>
        <span class="token keyword">return</span> orderTotalAmount <span class="token operator">-</span> benefitAmount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢ç»™å‡ºå…¶ä»–ä¼˜æƒ å·è®¡ç®—æ¨¡ç‰ˆï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·ç­–ç•¥ï¼šæŠ˜æ‰£å·
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DiscountTemplate</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractRuleTemplate</span> <span class="token keyword">implements</span> <span class="token class-name">RuleTemplate</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—æ–°çš„ä»·æ ¼
     *
     * <span class="token keyword">@param</span> <span class="token parameter">orderTotalAmount</span> è®¢å•æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">shopTotalAmount</span>  å•†åº—æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">quota</span>            ä¼˜æƒ é¢åº¦
     * <span class="token keyword">@return</span> æ–°çš„ä»·æ ¼
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Long</span> <span class="token function">calculateNewPrice</span><span class="token punctuation">(</span><span class="token class-name">Long</span> orderTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> shopTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> quota<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">convertToDecimal</span><span class="token punctuation">(</span>shopTotalAmount<span class="token punctuation">,</span> quota<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * å°†å•†åº—æ€»é‡‘é¢è½¬æ¢ä¸ºå°æ•°ï¼Œå¹¶æŒ‰æ¯”ä¾‹è½¬æ¢ä¸ºå®é™…é‡‘é¢
     *
     * <span class="token keyword">@param</span> <span class="token parameter">shopTotalAmount</span> å•†åº—æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">quota</span>           æ¯”ä¾‹
     * <span class="token keyword">@return</span> è½¬æ¢åçš„å°æ•°é‡‘é¢
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> <span class="token function">convertToDecimal</span><span class="token punctuation">(</span><span class="token class-name">Long</span> shopTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> quota<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span> v <span class="token operator">=</span> shopTotalAmount <span class="token operator">*</span> <span class="token punctuation">(</span>quota<span class="token punctuation">.</span><span class="token function">doubleValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> v<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·ç­–ç•¥ï¼šç©ºç­–ç•¥
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DummyTemplate</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractRuleTemplate</span> <span class="token keyword">implements</span> <span class="token class-name">RuleTemplate</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—æ–°çš„ä»·æ ¼
     *
     * <span class="token keyword">@param</span> <span class="token parameter">orderTotalAmount</span> è®¢å•æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">shopTotalAmount</span>  å•†åº—æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">quota</span>            ä¼˜æƒ é¢åº¦
     * <span class="token keyword">@return</span> æ–°çš„ä»·æ ¼
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Long</span> <span class="token function">calculateNewPrice</span><span class="token punctuation">(</span><span class="token class-name">Long</span> orderTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> shopTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> quota<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> orderTotalAmount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ShoppingCart</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        order<span class="token punctuation">.</span><span class="token function">setCost</span><span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getTotalPrice</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> order<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·ç­–ç•¥ï¼šå¤œé—´å•èº«ç‹—ç¿»å€å·ï¼ˆ22:00 - 02:00ï¼‰
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LonelyNightTemplate</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractRuleTemplate</span> <span class="token keyword">implements</span> <span class="token class-name">RuleTemplate</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—æ–°çš„ä»·æ ¼
     *
     * <span class="token keyword">@param</span> <span class="token parameter">orderTotalAmount</span> è®¢å•æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">shopTotalAmount</span>  å•†åº—æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">quota</span>            ä¼˜æƒ é¢åº¦
     * <span class="token keyword">@return</span> æ–°çš„ä»·æ ¼
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Long</span> <span class="token function">calculateNewPrice</span><span class="token punctuation">(</span><span class="token class-name">Long</span> orderTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> shopTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> quota<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Calendar</span> calendar <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hourOfDay <span class="token operator">=</span> calendar<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token constant">HOUR_OF_DAY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>hourOfDay <span class="token operator">&gt;=</span> <span class="token number">22</span> <span class="token operator">||</span> hourOfDay <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            quota <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Long</span> benefitAmount <span class="token operator">=</span> shopTotalAmount <span class="token operator">&lt;</span> quota <span class="token operator">?</span> shopTotalAmount <span class="token operator">:</span> quota<span class="token punctuation">;</span>
        <span class="token keyword">return</span> orderTotalAmount <span class="token operator">-</span> benefitAmount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·ç­–ç•¥ï¼šéšæœºç«‹å‡å·
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RandomReductionTemplate</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractRuleTemplate</span> <span class="token keyword">implements</span> <span class="token class-name">RuleTemplate</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—æ–°çš„ä»·æ ¼
     *
     * <span class="token keyword">@param</span> <span class="token parameter">orderTotalAmount</span> è®¢å•æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">shopTotalAmount</span>  å•†åº—æ€»é‡‘é¢
     * <span class="token keyword">@param</span> <span class="token parameter">quota</span>            ä¼˜æƒ é¢åº¦
     * <span class="token keyword">@return</span> æ–°çš„ä»·æ ¼
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Long</span> <span class="token function">calculateNewPrice</span><span class="token punctuation">(</span><span class="token class-name">Long</span> orderTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> shopTotalAmount<span class="token punctuation">,</span> <span class="token class-name">Long</span> quota<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è®¡ç®—æœ€å¤§çš„ä¼˜æƒ é¢åº¦ï¼šå–å•†åº—æ€»é‡‘é¢å’Œä¼˜æƒ é¢åº¦çš„æœ€å°å€¼</span>
        <span class="token keyword">long</span> maxBenefit <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>shopTotalAmount<span class="token punctuation">,</span> quota<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¡ç®—ä¼˜æƒ é¢åº¦ï¼šéšæœºç”Ÿæˆä¸€ä¸ªæ•´æ•°ï¼ŒèŒƒå›´ä¸º 0 ~ maxBenefit-1</span>
        <span class="token keyword">int</span> reductionAmount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> maxBenefit<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¡ç®—æ–°çš„ä»·æ ¼ï¼šè®¢å•æ€»é‡‘é¢å‡å»ä¼˜æƒ é¢åº¦</span>
        <span class="token keyword">return</span> orderTotalAmount <span class="token operator">-</span> reductionAmount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æœªæ¥ï¼Œå¦‚æœä¸šåŠ¡æ‹“å±•æ–°å¢äº†æ›´å¤šç±»å‹çš„ä¼˜æƒ åˆ¸ï¼Œå½“å‰çš„è®¾è®¡å…è®¸æˆ‘ä»¬é€šè¿‡æ·»åŠ æ–°çš„å­ç±»æˆ–åœ¨å¿…è¦æ—¶åˆ›å»ºæ›´å¤šå±‚æ¬¡çš„æŠ½è±¡ç±»æ¥åº”å¯¹ï¼Œè¿™æ ·åšä¸€æ–¹é¢ä¿æŒäº†ç°æœ‰ä»£ç çš„ç¨³å®šï¼Œå¦ä¸€æ–¹é¢åˆä¿æŒäº†ç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p><h4 id="_3-2-3-service-å±‚" tabindex="-1"><a class="header-anchor" href="#_3-2-3-service-å±‚" aria-hidden="true">#</a> 3.2.3 Service å±‚</h4><p>æ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯å®ç° Service å±‚ã€‚Service å±‚ä¸­çš„ <code>calculateOrderPrice</code> æ–¹æ³•é€šè¿‡<code>CouponTemplateFactory</code>å·¥å‚ç±»æ¥è·å–å…·ä½“çš„è®¡ç®—è§„åˆ™ï¼Œç„¶åè°ƒç”¨ <code>calculate</code> æ–¹æ³•æ¥è®¡ç®—è®¢å•çš„ä¼˜æƒ åä»·æ ¼ã€‚å…¶ä¸­ï¼Œ<code>simulate </code>æ–¹æ³•æä¾›äº†ä¸€ç§è¯•ç®—æœºåˆ¶ï¼Œå¸®åŠ©ç”¨æˆ·åœ¨å®é™…ä¸‹å•å‰é¢„ä¼°å„ä¼˜æƒ åˆ¸çš„æŠ˜æ‰£é‡‘é¢ï¼Œä»¥ä¾¿é€‰æ‹©æœ€ä¼˜æƒ çš„é€‰é¡¹ã€‚</p><p><code>CouponTemplateFactory </code>çš„è®¾è®¡æ˜¯æ ¹æ®è®¢å•ä¸­åŒ…å«çš„ä¼˜æƒ åˆ¸ä¿¡æ¯æ¥è¿”å›ç›¸åº”çš„ä¼˜æƒ åˆ¸æ¨¡æ¿å®ä¾‹ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥è®¡ç®—ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * å·¥å‚æ¨¡å¼ï¼šç”¨äºåˆ›å»ºä¸åŒç±»å‹çš„ä¼˜æƒ åˆ¸æ¨¡æ¿
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponTemplateFactory</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">MoneyOffTemplate</span> moneyOffTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">DiscountTemplate</span> discountTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RandomReductionTemplate</span> randomReductionTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">LonelyNightTemplate</span> lonelyNightTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">DummyTemplate</span> dummyTemplate<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">RuleTemplate</span> <span class="token function">getTemplate</span><span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getCouponInfos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> dummyTemplate<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">CouponTemplateInfo</span> templateInfo <span class="token operator">=</span> order<span class="token punctuation">.</span><span class="token function">getCouponInfos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTemplateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CouponType</span> couponType <span class="token operator">=</span> <span class="token class-name">CouponType</span><span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>templateInfo<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">switch</span> <span class="token punctuation">(</span>couponType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token constant">MONEY_OFF</span><span class="token operator">:</span>
                <span class="token keyword">return</span> moneyOffTemplate<span class="token punctuation">;</span>

            <span class="token keyword">case</span> <span class="token constant">DISCOUNT</span><span class="token operator">:</span>
                <span class="token keyword">return</span> discountTemplate<span class="token punctuation">;</span>

            <span class="token keyword">case</span> <span class="token constant">RANDOM_DISCOUNT</span><span class="token operator">:</span>
                <span class="token keyword">return</span> randomReductionTemplate<span class="token punctuation">;</span>

            <span class="token keyword">case</span> <span class="token constant">LONELY_NIGHT_MONEY_OFF</span><span class="token operator">:</span>
                <span class="token keyword">return</span> lonelyNightTemplate<span class="token punctuation">;</span>

            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">return</span> dummyTemplate<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®šä¹‰ <code>CouponCalculationService</code> æ¥å£ä»¥åŠå…¶å…·ä½“å®ç°ï¼Œè¿™æ ·çš„è®¾è®¡éµå¾ªäº†<strong>å¼€é—­åŸåˆ™</strong>ï¼Œå³å¯¹ä¿®æ”¹å°é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾ï¼Œæé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p><p><code>CouponCalculationService</code> æ¥å£ç”¨äºæä¾›ä¼˜æƒ è®¡ç®—çš„ API å®šä¹‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·è®¡ç®—æœåŠ¡
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CouponCalculationService</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è®¡ç®—è®¢å•ä»·æ ¼
     *
     * <span class="token keyword">@param</span> <span class="token parameter">cart</span> è´­ç‰©è½¦
     * <span class="token keyword">@return</span> è®¢å•ä»·æ ¼
     */</span>
    <span class="token class-name">ShoppingCart</span> <span class="token function">calculateOrderPrice</span><span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> cart<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ä¼˜æƒ è¯•ç®—
     *
     * <span class="token keyword">@param</span> <span class="token parameter">order</span> è®¢å•
     * <span class="token keyword">@return</span> å“åº”
     */</span>
    <span class="token class-name">SimulationResponse</span> <span class="token function">simulateOrder</span><span class="token punctuation">(</span><span class="token class-name">SimulationOrder</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹åº”å®ç°å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·è®¡ç®—æœåŠ¡å®ç°
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponCalculationServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">CouponCalculationService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponTemplateFactory</span> couponTemplateFactory<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ­£å¸¸è®¡ç®—
     * <span class="token keyword">@param</span> <span class="token parameter">cart</span> è´­ç‰©è½¦
     * <span class="token keyword">@return</span> è®¡ç®—åçš„è´­ç‰©è½¦
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ShoppingCart</span> <span class="token function">calculateOrderPrice</span><span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> cart<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;calculateOrderPrice: {}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>cart<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RuleTemplate</span> ruleTemplate <span class="token operator">=</span> couponTemplateFactory<span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>cart<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ruleTemplate<span class="token punctuation">.</span><span class="token function">calculate</span><span class="token punctuation">(</span>cart<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * æ¨¡æ‹Ÿè®¡ç®—
     * <span class="token keyword">@param</span> <span class="token parameter">order</span> è®¢å•
     * <span class="token keyword">@return</span> æ¨¡æ‹Ÿè®¡ç®—ç»“æœ
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">SimulationResponse</span> <span class="token function">simulateOrder</span><span class="token punctuation">(</span><span class="token class-name">SimulationOrder</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿå“åº”å¯¹è±¡</span>
        <span class="token class-name">SimulationResponse</span> response <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimulationResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆå§‹åŒ–æœ€å°è®¢å•ä»·æ ¼ä¸º Long æœ€å¤§å€¼</span>
        <span class="token class-name">Long</span> minOrderPrice <span class="token operator">=</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>

        <span class="token comment">// éå†ä¼ å…¥çš„ä¼˜æƒ åˆ¸ä¿¡æ¯åˆ—è¡¨</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">CouponInfo</span> couponInfo <span class="token operator">:</span> order<span class="token punctuation">.</span><span class="token function">getCouponInfos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ›å»ºä¸€ä¸ªè´­ç‰©è½¦å¯¹è±¡</span>
            <span class="token class-name">ShoppingCart</span> shoppingCart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ShoppingCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è®¾ç½®è´­ç‰©è½¦çš„äº§å“ä¸ºä¼ å…¥è®¢å•çš„äº§å“</span>
            shoppingCart<span class="token punctuation">.</span><span class="token function">setProducts</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// å°†ä¼˜æƒ åˆ¸ä¿¡æ¯æ·»åŠ åˆ°è´­ç‰©è½¦ä¸­</span>
            shoppingCart<span class="token punctuation">.</span><span class="token function">setCouponInfos</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span>couponInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// æ ¹æ®è´­ç‰©è½¦æ¨¡æ¿è®¡ç®—åçš„è´­ç‰©è½¦å¯¹è±¡ï¼ˆå†³å®šä½¿ç”¨å“ªä¸ªä¼˜æƒ åˆ¸ï¼Œå¯¹ä¸Šå±‚ä¸šåŠ¡é€æ˜ï¼‰</span>
            shoppingCart <span class="token operator">=</span> couponTemplateFactory<span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>shoppingCart<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">calculate</span><span class="token punctuation">(</span>shoppingCart<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// è·å–å½“å‰ä¼˜æƒ åˆ¸ä¿¡æ¯çš„ID</span>
            <span class="token class-name">Long</span> couponInfoId <span class="token operator">=</span> couponInfo<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è·å–è®¡ç®—åçš„è´­ç‰©è½¦ä»·æ ¼</span>
            <span class="token keyword">long</span> orderPrice <span class="token operator">=</span> shoppingCart<span class="token punctuation">.</span><span class="token function">getCost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// å°†ä¼˜æƒ åˆ¸IDå’Œå¯¹åº”çš„è®¢å•ä»·æ ¼æ·»åŠ åˆ°æ¨¡æ‹Ÿå“åº”çš„ä¼˜æƒ åˆ¸åˆ°è®¢å•ä»·æ ¼æ˜ å°„ä¸­</span>
            response<span class="token punctuation">.</span><span class="token function">getCouponToOrderPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>couponInfoId<span class="token punctuation">,</span> orderPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// å¦‚æœæœ€å°è®¢å•ä»·æ ¼å¤§äºå½“å‰è®¢å•ä»·æ ¼</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>minOrderPrice <span class="token operator">&gt;</span> orderPrice<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">// è®¾ç½®æœ€ä½³ä¼˜æƒ åˆ¸IDä¸ºå½“å‰ä¼˜æƒ åˆ¸ä¿¡æ¯çš„ID</span>
                response<span class="token punctuation">.</span><span class="token function">setBestCouponId</span><span class="token punctuation">(</span>couponInfoId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// æ›´æ–°æœ€å°è®¢å•ä»·æ ¼</span>
                minOrderPrice <span class="token operator">=</span> orderPrice<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> response<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-4-controller-å±‚" tabindex="-1"><a class="header-anchor" href="#_3-2-4-controller-å±‚" aria-hidden="true">#</a> 3.2.4 Controller å±‚</h4><p>å®Œæˆ Service å±‚çš„æ„å»ºåï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡åˆ›å»ºä¸€ä¸ª <code>CouponCalculationController</code> ç±»æ¥å‘å¤–ç•Œæä¾›æ¥å£ã€‚è¿™ä¸ªæ§åˆ¶å™¨å°†æš´éœ²è‡³å°‘ä¸¤ä¸ª POST æ¥å£ï¼Œä¸€ä¸ªç”¨äºå®Œæˆè®¢å•çš„ä¼˜æƒ è®¡ç®—ï¼Œå¦ä¸€ä¸ªç”¨äºè¿›è¡Œä¼˜æƒ åˆ¸çš„ä»·æ ¼è¯•ç®—ã€‚è¿™äº›æ¥å£çš„å®ç°å°†ä¾èµ–äºä¹‹å‰æ„å»ºçš„ Service å±‚é€»è¾‘ã€‚</p><p>è¿™é‡Œæ˜¯ä¸€ä¸ªç®€åŒ–çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•å®šä¹‰è¿™äº› REST æ¥å£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·è®¡ç®— Controller
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;calculator&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponCalculationController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponCalculationService</span> calculationService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/checkout&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ShoppingCart</span> <span class="token function">calculateOrderPrice</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">ShoppingCart</span> settlement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;do calculation: {}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>settlement<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> calculationService<span class="token punctuation">.</span><span class="token function">calculateOrderPrice</span><span class="token punctuation">(</span>settlement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/simulate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">SimulationResponse</span> <span class="token function">simulate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SimulationOrder</span> simulator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;do simulation: {}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>simulator<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> calculationService<span class="token punctuation">.</span><span class="token function">simulateOrder</span><span class="token punctuation">(</span>simulator<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªæ§åˆ¶å™¨ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥äº† <code>CouponCalculationService</code> æ¥è°ƒç”¨è®¡ç®—å’Œè¯•ç®—çš„ç›¸å…³æ–¹æ³•ï¼Œå¹¶è¿”å›ç»“æœã€‚</p><h4 id="_3-2-5-å¯åŠ¨ç±»" tabindex="-1"><a class="header-anchor" href="#_3-2-5-å¯åŠ¨ç±»" aria-hidden="true">#</a> 3.2.5 å¯åŠ¨ç±»</h4><p>æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»º <code>Application</code> ç±»æ¥å¯åŠ¨ Spring Boot åº”ç”¨ã€‚è¿™ä¸ªç±»é€šå¸¸å¾ˆç®€å•ï¼ŒåŒ…å«ä¸€ä¸ª main æ–¹æ³•å’Œ <code>@SpringBootApplication</code> æ³¨è§£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;cn.javgo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>apple<span class="token punctuation">.</span>eawt<span class="token punctuation">.</span></span>Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-6-é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3-2-6-é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> 3.2.6 é…ç½®æ–‡ä»¶</h4><p>æœ€åï¼Œæˆ‘ä»¬éœ€è¦é…ç½® <code>application.yml</code> æ–‡ä»¶ï¼Œä¸ºæˆ‘ä»¬çš„æœåŠ¡æä¾›å¿…è¦çš„é…ç½®ï¼Œå¦‚ç«¯å£å·ã€æ•°æ®åº“è¿æ¥çš„é…ç½®ç­‰ã€‚</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># æœåŠ¡ç«¯å£</span>
<span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">20002</span>
<span class="token comment"># é”™è¯¯ä¿¡æ¯æ˜¯å¦åŒ…å«å †æ ˆä¿¡æ¯</span>
<span class="token key attr-name">server.error.include-message</span><span class="token punctuation">=</span><span class="token value attr-value">always</span>

<span class="token comment"># åº”ç”¨åç§°</span>
<span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">coupon-calculation-serv</span>

<span class="token comment"># æ—¥å¿—çº§åˆ«</span>
<span class="token key attr-name">logging.level.cn.javgo.coupon</span><span class="token punctuation">=</span><span class="token value attr-value">debug</span>

<span class="token comment"># å¼€å¯ Spring Boot Actuator çš„æ‰€æœ‰ç«¯ç‚¹</span>
<span class="token key attr-name">management.endpoints.web.exposure.include</span><span class="token punctuation">=</span><span class="token value attr-value">*</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº† <code>coupon-calculation-impl</code> æ¨¡å—çš„æ„å»ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•æ¥éªŒè¯æœåŠ¡çš„æ­£ç¡®æ€§ï¼Œå¹¶ä½¿ç”¨ Spring Boot çš„ Actuator æ¥ç›‘æ§æœåŠ¡çš„å¥åº·çŠ¶å†µå’Œæ€§èƒ½ã€‚</p><p>ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†ç»§ç»­å‰è¿›ï¼Œæ„å»º <code>coupon-customer-serv</code> æ¨¡å—ï¼Œè¿™æ˜¯ä¼˜æƒ åˆ¸é¡¹ç›®çš„æœ€åä¸€ä¸ªæœåŠ¡ï¼Œä¸“é—¨ç”¨äºä¸ç”¨æˆ·äº¤äº’ï¼Œæ¯”å¦‚é¢†å–ä¼˜æƒ åˆ¸ã€æŸ¥è¯¢ä¼˜æƒ åˆ¸ç­‰ã€‚</p><h2 id="_4-æ­å»ºç”¨æˆ·æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_4-æ­å»ºç”¨æˆ·æœåŠ¡" aria-hidden="true">#</a> 4.æ­å»ºç”¨æˆ·æœåŠ¡</h2><p>åœ¨ç”µå­å•†åŠ¡ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ä¼˜æƒ åˆ¸æœåŠ¡ï¼ˆä»¥ä¸‹ç®€ç§° â€œç”¨æˆ·æœåŠ¡â€ï¼‰æ˜¯è‡³å…³é‡è¦çš„ä¸€ç¯ã€‚æœ¬æ¨¡å—çš„è®¾è®¡é‡ç‚¹åœ¨äºå®ç°ç”¨æˆ·ä¸ä¼˜æƒ åˆ¸äº¤äº’çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨æˆ·é¢†å–ä¼˜æƒ åˆ¸ã€æŸ¥è¯¢æŒæœ‰ä¼˜æƒ åˆ¸ä»¥åŠåœ¨è®¢å•ç»“ç®—æ—¶ä½¿ç”¨ä¼˜æƒ åˆ¸ã€‚ç±»ä¼¼åœ°ï¼Œè¯¥æ¨¡å—çš„æ¶æ„è®¾è®¡å‚ç…§äº†ä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡ï¼Œä¹Ÿåˆ†ä¸º API å±‚ã€DAO å±‚å’Œä¸šåŠ¡é€»è¾‘å±‚ã€‚</p><p>ä¸ºäº†ä¿æŒæ–‡ç« çš„èšç„¦ï¼Œæˆ‘ä»¬å°†ä¸ä¼šæ·±å…¥ â€œç”¨æˆ·æ³¨å†Œâ€ ç­‰åŠŸèƒ½ï¼Œè€Œæ˜¯å‡è®¾ä½ å·²ç»ç†Ÿæ‚‰ç”¨æˆ·èº«ä»½éªŒè¯çš„æµç¨‹ï¼Œé€šè¿‡ <code>userId</code> æ¥æ ‡è¯†ä¸€ä¸ªç»è¿‡è®¤è¯çš„ç”¨æˆ·èº«ä»½ã€‚</p><h3 id="_4-1-æ­å»º-coupon-customer-api-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_4-1-æ­å»º-coupon-customer-api-æ¨¡å—" aria-hidden="true">#</a> 4.1 æ­å»º coupon-customer-api æ¨¡å—</h3><h4 id="_4-1-1-ä¾èµ–é…ç½®" tabindex="-1"><a class="header-anchor" href="#_4-1-1-ä¾èµ–é…ç½®" aria-hidden="true">#</a> 4.1.1 ä¾èµ–é…ç½®</h4><p>åœ¨ç”¨æˆ·æœåŠ¡çš„ API å±‚æ„å»ºä¸­ï¼Œé¦–å…ˆè¦ç¡®ä¿ç”¨æˆ·æœåŠ¡èƒ½å¤Ÿä¸ç³»ç»Ÿä¸­çš„å…¶ä»–æœåŠ¡è¿›è¡Œäº¤äº’ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç”¨æˆ·æœåŠ¡çš„é¡¹ç›®å¯¹è±¡æ¨¡å‹ï¼ˆPOMï¼‰æ–‡ä»¶ä¸­æ·»åŠ ä¼˜æƒ åˆ¸æ¨¡æ¿æœåŠ¡ï¼ˆcoupon-template-apiï¼‰å’Œä¼˜æƒ åˆ¸è®¡ç®—æœåŠ¡ï¼ˆcoupon-calculation-apiï¼‰çš„ä¾èµ–ã€‚è¿™ä¸€æ­¥ç¡®ä¿ç”¨æˆ·æœåŠ¡èƒ½å¤Ÿä½¿ç”¨è¿™ä¸¤ä¸ªæœåŠ¡æä¾›çš„è¯·æ±‚å’Œå“åº”å¯¹è±¡ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-template-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-calculation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.google.guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>guava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-1-2-å°è£…-dto" tabindex="-1"><a class="header-anchor" href="#_4-1-2-å°è£…-dto" aria-hidden="true">#</a> 4.1.2 å°è£… DTO</h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰ <code>RequestCoupon</code> ç±»ï¼Œç”¨äºå°è£…ç”¨æˆ·é¢†å–ä¼˜æƒ åˆ¸æ—¶æ‰€éœ€æä¾›çš„ä¿¡æ¯ï¼Œè¿™é€šå¸¸åŒ…æ‹¬ç”¨æˆ· ID å’Œä¼˜æƒ åˆ¸æ¨¡æ¿ IDã€‚é€šè¿‡è¿™ä¸ªç±»ï¼Œç”¨æˆ·å¯ä»¥è¯·æ±‚ç³»ç»Ÿä¸ºå…¶ç”ŸæˆåŸºäºæŒ‡å®šæ¨¡æ¿çš„ä¼˜æƒ åˆ¸ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ç”¨æˆ·é¢†å–ä¼˜æƒ åˆ¸è¯·æ±‚
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestCoupon</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@NotNull</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotNull</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> couponTemplateId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤å¤–ï¼Œ<code>SearchCoupon</code> ç±»è¢«å®šä¹‰ç”¨äºå°è£…æŸ¥è¯¢ä¼˜æƒ åˆ¸è¯·æ±‚æ—¶çš„å‚æ•°ã€‚å®ƒå…è®¸ç”¨æˆ·æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œä¼˜æƒ åˆ¸æŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥æ ¹æ®ä¼˜æƒ åˆ¸çš„çŠ¶æ€è¿›è¡Œç­›é€‰ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·æŸ¥è¯¢
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SearchCoupon</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@NotNull</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">Long</span> shopId<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·çŠ¶æ€æšä¸¾
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">CouponStatus</span> <span class="token punctuation">{</span>

    <span class="token function">AVAILABLE</span><span class="token punctuation">(</span><span class="token string">&quot;æœªä½¿ç”¨&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">USED</span><span class="token punctuation">(</span><span class="token string">&quot;å·²ä½¿ç”¨&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">INACTIVE</span><span class="token punctuation">(</span><span class="token string">&quot;å·²æ³¨é”€&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> desc<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CouponStatus</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>bean <span class="token operator">-&gt;</span> bean<span class="token punctuation">.</span>code<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">findAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æ­å»ºå¥½äº†ç”¨æˆ·æœåŠ¡çš„ API å­æ¨¡å—çš„åŸºæœ¬ç»“æ„ã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¼šè¿›å…¥åˆ°æ•°æ®è®¿é—®å±‚ï¼ˆDAOï¼‰ï¼Œåœ¨è¿™ä¸€å±‚æˆ‘ä»¬å°†å®ç°ä¼˜æƒ åˆ¸æ•°æ®çš„æŒä¹…åŒ–æ“ä½œï¼ŒåŒ…æ‹¬ä¼˜æƒ åˆ¸çš„å­˜å‚¨ã€æ£€ç´¢ã€æ›´æ–°å’Œåˆ é™¤ã€‚</p><h3 id="_4-2-æ­å»º-coupon-customer-dao-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_4-2-æ­å»º-coupon-customer-dao-æ¨¡å—" aria-hidden="true">#</a> 4.2 æ­å»º coupon-customer-dao æ¨¡å—</h3><h4 id="_4-2-1-æ•°æ®åº“æ˜ å°„å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_4-2-1-æ•°æ®åº“æ˜ å°„å¯¹è±¡" aria-hidden="true">#</a> 4.2.1 æ•°æ®åº“æ˜ å°„å¯¹è±¡</h4><p>åœ¨ç”¨æˆ·ä¼˜æƒ åˆ¸æœåŠ¡çš„æ•°æ®è®¿é—®å±‚ï¼ˆDAO å±‚ï¼‰çš„æ­å»ºä¸­ï¼Œæ ¸å¿ƒä»»åŠ¡æ˜¯è®¾è®¡å’Œå®ç°ä¸æ•°æ®åº“äº¤äº’çš„å®ä½“å’Œæ¥å£ã€‚åœ¨è¿™ä¸€ç¯èŠ‚ï¼Œæˆ‘å®šä¹‰äº† <code>Coupon</code> å®ä½“ç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“æ˜ å°„å¯¹è±¡ï¼Œä¸“é—¨ç”¨æ¥è¡¨ç¤ºå’Œå­˜å‚¨ç”¨æˆ·æ‰€é¢†å–çš„ä¼˜æƒ åˆ¸ä¿¡æ¯ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@EntityListeners</span><span class="token punctuation">(</span><span class="token class-name">AuditingEntityListener</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;coupon&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Coupon</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span><span class="token constant">IDENTITY</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;template_id&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> templateId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;user_id&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;shop_id&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> shopId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">CouponStatusConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponStatus</span> status<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Transient</span> <span class="token comment">// æ ‡è®°è¯¥å­—æ®µä¸å‚ä¸æ•°æ®åº“æ˜ å°„</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponTemplateInfo</span> templateInfo<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@CreatedDate</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;created_time&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> createTime<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é’ˆå¯¹ <code>Coupon</code> å®ä½“ç±»ï¼Œæˆ‘è¿˜ç¼–å†™äº†ç›¸åº”çš„è½¬æ¢å™¨ç±»ï¼Œå…¶ä½œç”¨æ˜¯åœ¨ä¸åŒæ•°æ®ç±»å‹çš„å®ä½“å±æ€§å’Œè¡¨å­—æ®µè¿›è¡Œæ˜ å°„æ—¶ï¼Œèƒ½å¤Ÿå°†æ•°æ®åº“å®ä½“å±æ€§å’Œå¯¹åº”å­—æ®µè¿›è¡Œäº’ç›¸è½¬æ¢ï¼Œä¿è¯æ•°æ®å¤„ç†çš„ä¸€è‡´æ€§å’Œå‡†ç¡®æ€§ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·çŠ¶æ€è½¬æ¢å™¨
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponStatusConverter</span> <span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponStatus</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span> attribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> attribute<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CouponStatus</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>dbData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œä½¿ç”¨äº† Lombok åº“æ¥ç®€åŒ–å®ä½“ç±»çš„ç¼–å†™ï¼Œé€šè¿‡æ³¨è§£è‡ªåŠ¨ç”Ÿæˆå¸¸ç”¨çš„æ–¹æ³•å¦‚ <code>getter</code>ã€<code>setter</code>ã€<code>toString</code> ç­‰ï¼Œå¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡ã€‚å¯¹ Lombok æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è®¿é—®å…¶<a href="https://projectlombok.org/" target="_blank" rel="noopener noreferrer">å®˜æ–¹ç½‘ç«™<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ä»¥è·å¾—æ›´å¤šä¿¡æ¯ã€‚</p><img src="https://javgo-images.oss-cn-beijing.aliyuncs.com/2023-09-18-061309.png" style="zoom:33%;"><p>æ­¤å¤–ï¼Œæˆ‘æƒ³åˆ†äº«å…³äº â€œ<strong>æ•°æ®å†—ä½™</strong>â€ çš„è®¾è®¡è€ƒé‡ã€‚ä¾‹å¦‚ï¼Œåœ¨ <code>Coupon</code> å®ä½“ä¸­ï¼Œæˆ‘ä»¬å†³å®šå¼•å…¥ä¸€ä¸ªå†—ä½™å­—æ®µâ€”â€”Shop IDã€‚è™½ç„¶è¯¥æ•°æ®å¯ä»¥é€šè¿‡å…³è”çš„ <code>CouponTemplate</code> å®ä½“è·å–ï¼Œä½†å°†å…¶ç›´æ¥å­˜å‚¨åœ¨ <code>Coupon</code> å®ä½“ä¸­å¯ä»¥æå¤§æå‡æ•°æ®æŸ¥è¯¢æ•ˆç‡ï¼Œè¿™ç§è®¾è®¡åœ¨é¢å‘å¤§è§„æ¨¡å¹¶å‘çš„ç³»ç»Ÿæ—¶å°¤ä¸ºå¸¸è§ã€‚å®ƒä½“ç°äº† â€œ<strong>ä»¥ç©ºé—´æ¢æ—¶é—´</strong>â€ çš„ç­–ç•¥ï¼Œå³é€šè¿‡å¢åŠ å­˜å‚¨æ¶ˆè€—æ¥æ¢å–æ›´å¿«çš„å“åº”é€Ÿåº¦ã€‚</p><h4 id="_4-2-2-æŒä¹…å±‚" tabindex="-1"><a class="header-anchor" href="#_4-2-2-æŒä¹…å±‚" aria-hidden="true">#</a> 4.2.2 æŒä¹…å±‚</h4><p>æ¥ä¸‹æ¥ï¼Œåˆ›å»ºäº† <code>CouponDAO</code> æ¥å£ï¼Œè¿™æ˜¯ä¸€ä¸ªéµå¾ª Spring Data JPA è§„èŒƒçš„æ•°æ®è®¿é—®æ¥å£ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†å¿…è¦çš„æ•°æ®æ“ä½œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨äºç»Ÿè®¡ä¼˜æƒ åˆ¸æ•°é‡çš„æ–¹æ³•ã€‚è€ŒåŸºäº <code>JpaRepository</code> æä¾›çš„æ ‡å‡† CRUD æ“ä½œåˆ™ä¸éœ€è¦é¢å¤–å®šä¹‰ï¼Œè¿™å±•ç¤ºäº† Spring Data JPA æ¡†æ¶çš„ä¾¿æ·æ€§å’Œé«˜æ•ˆæ€§ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å· DAO
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CouponDao</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coupon</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æ ¹æ®ç”¨æˆ·IDå’Œæ¨¡æ¿IDç»Ÿè®¡æ•°é‡
     *
     * <span class="token keyword">@param</span> <span class="token parameter">userId</span>     ç”¨æˆ·ID
     * <span class="token keyword">@param</span> <span class="token parameter">templateId</span> æ¨¡æ¿ID
     * <span class="token keyword">@return</span> ç»Ÿè®¡æ•°é‡
     */</span>
    <span class="token keyword">long</span> <span class="token function">countByUserIdAndTemplateId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">Long</span> templateId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³æ­¤ï¼Œç”¨æˆ·ä¼˜æƒ åˆ¸æœåŠ¡çš„æ•°æ®è®¿é—®å±‚å·²ç»æ­å»ºå®Œæˆã€‚æˆ‘ä»¬å°†ç»§ç»­å‰è¿›ï¼Œä¸‹ä¸€æ­¥æ˜¯è¿›å…¥å®ç°å±‚ï¼ˆimpl å±‚ï¼‰ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬å°†å…·ä½“å®ç°ä¸šåŠ¡é€»è¾‘ã€‚</p><h3 id="_4-3-æ­å»º-coupon-customer-impl-æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_4-3-æ­å»º-coupon-customer-impl-æ¨¡å—" aria-hidden="true">#</a> 4.3 æ­å»º coupon-customer-impl æ¨¡å—</h3><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦è¿°ç”¨æˆ·ä¼˜æƒ åˆ¸æœåŠ¡çš„ä¸šåŠ¡é€»è¾‘å±‚â€”â€”<code>coupon-customer-impl</code>æ¨¡å—çš„æ„å»ºã€‚</p><h4 id="_4-3-1-ä¾èµ–é…ç½®" tabindex="-1"><a class="header-anchor" href="#_4-3-1-ä¾èµ–é…ç½®" aria-hidden="true">#</a> 4.3.1 ä¾èµ–é…ç½®</h4><p>åœ¨å¾®æœåŠ¡çš„å®Œå…¨å®è·µä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆå°†æ¨¡æ¿æœåŠ¡ï¼ˆtemplateï¼‰å’Œè®¡ç®—æœåŠ¡ï¼ˆcalculationï¼‰çš„åŠŸèƒ½ä¸´æ—¶é›†æˆåˆ°ç”¨æˆ·æœåŠ¡ï¼ˆcustomerï¼‰ä¸­ï¼Œå½¢æˆä¸€ä¸ªé›†æˆçš„å•ä½“åº”ç”¨ã€‚è¿™ä¸ªè¿‡æ¸¡æ€§çš„å•ä½“ç»“æ„ä¸ºæœªæ¥æ‹†åˆ†æˆç‹¬ç«‹å¾®æœåŠ¡æ‰“ä¸‹äº†åŸºç¡€ã€‚</p><p>åœ¨å¼€å§‹å®ç°ä¸šåŠ¡é€»è¾‘ä¹‹å‰ï¼Œéœ€è¦åœ¨ <code>coupon-customer-impl</code> çš„é…ç½®ä¸­åŠ å…¥æ¨¡æ¿å’Œè®¡ç®—æœåŠ¡çš„å®ç°å±‚ä¾èµ–é¡¹ã€‚è¿™ä¸€æ­¥è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒç¡®ä¿äº†ç”¨æˆ·æœåŠ¡ä¸ä»…èƒ½å¤Ÿè°ƒç”¨å…¶ä»–æœåŠ¡çš„ APIï¼Œè¿˜èƒ½å¤Ÿåˆ©ç”¨å®ƒä»¬çš„å…·ä½“å®ç°æ¥å®Œæˆå¤æ‚çš„ä¸šåŠ¡æ“ä½œã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-customer-dao<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-calculation-impl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>${project.groupId}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>coupon-template-impl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-3-2-service-å±‚" tabindex="-1"><a class="header-anchor" href="#_4-3-2-service-å±‚" aria-hidden="true">#</a> 4.3.2 Service å±‚</h4><p>å®Œæˆä¾èµ–é…ç½®ä¹‹åï¼Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªæ ¸å¿ƒä¸šåŠ¡æ¥å£ <code>CouponCustomerService</code>ï¼Œå®ƒè§„å®šäº†é¢†å–ä¼˜æƒ åˆ¸ã€æŸ¥è¯¢ä¼˜æƒ åˆ¸ã€æ ¸é”€ä¼˜æƒ åˆ¸ä»¥åŠæ‰§è¡Œä¼˜æƒ åˆ¸è¯•ç®—ç­‰å…³é”®ä¸šåŠ¡åŠŸèƒ½çš„æ–¹æ³•ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ç”¨æˆ·ä¼˜æƒ å·æœåŠ¡
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CouponCustomerService</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è·å–ä¼˜æƒ åˆ¸
     *
     * <span class="token keyword">@param</span> <span class="token parameter">request</span> ä¼˜æƒ åˆ¸è¯·æ±‚å¯¹è±¡
     * <span class="token keyword">@return</span> ä¼˜æƒ åˆ¸å¯¹è±¡
     */</span>
    <span class="token class-name">Coupon</span> <span class="token function">requestCoupon</span><span class="token punctuation">(</span><span class="token class-name">RequestCoupon</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ ¸é”€ä¼˜æƒ å·ï¼ˆå³ä¸‹å•ï¼‰
     *
     * <span class="token keyword">@param</span> <span class="token parameter">order</span> è´­ç‰©è½¦å¯¹è±¡
     */</span>
    <span class="token class-name">ShoppingCart</span> <span class="token function">placeOrder</span><span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ¨¡æ‹Ÿè®¢å•è¯•ç®—
     *
     * <span class="token keyword">@param</span> <span class="token parameter">order</span> æ¨¡æ‹Ÿè®¢å•å¯¹è±¡
     * <span class="token keyword">@return</span> æ¨¡æ‹Ÿå“åº”å¯¹è±¡
     */</span>
    <span class="token class-name">SimulationResponse</span> <span class="token function">simulateOrderPrice</span><span class="token punctuation">(</span><span class="token class-name">SimulationOrder</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * åˆ é™¤ä¼˜æƒ åˆ¸
     *
     * <span class="token keyword">@param</span> <span class="token parameter">userId</span>   ç”¨æˆ·ID
     * <span class="token keyword">@param</span> <span class="token parameter">couponId</span> ä¼˜æƒ åˆ¸ID
     */</span>
    <span class="token keyword">void</span> <span class="token function">deleteCoupon</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">Long</span> couponId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æŸ¥æ‰¾ä¼˜æƒ åˆ¸
     *
     * <span class="token keyword">@param</span> <span class="token parameter">request</span> æŸ¥æ‰¾ä¼˜æƒ åˆ¸è¯·æ±‚å¯¹è±¡
     * <span class="token keyword">@return</span> ä¼˜æƒ åˆ¸ä¿¡æ¯åˆ—è¡¨
     */</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">findCoupon</span><span class="token punctuation">(</span><span class="token class-name">SearchCoupon</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œé‡ç‚¹å…³æ³¨ <code>placeOrder</code> æ–¹æ³•çš„å®ç°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¤„ç†ç”¨æˆ·ä¸‹å•åŠä¼˜æƒ åˆ¸æ ¸é”€æµç¨‹çš„å…³é”®ã€‚åœ¨å®ç°è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œ<code>Coupon</code> å¯¹è±¡çš„æ„é€ è¿‡ç¨‹é‡‡ç”¨äº†æ„å»ºè€…æ¨¡å¼ï¼Œè¿™ä¸€æ¨¡å¼é€šè¿‡ Lombok çš„ <code>@Builder</code> æ³¨è§£å¾—ä»¥ç®€åŒ–å®ç°ï¼Œä½¿å¾—å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹æ—¢ç›´è§‚åˆæ˜“äºç®¡ç†ï¼Œæå‡äº†ä»£ç çš„æ•´æ´åº¦å’Œå¯ç»´æŠ¤æ€§ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">ShoppingCart</span> <span class="token function">placeOrder</span><span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœè®¢å•å•†å“ä¸ºç©º</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è®¢å•å•†å“ä¸ºç©º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;è®¢å•å•†å“ä¸ºç©º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Coupon</span> coupon <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">// å¦‚æœè®¢å•ä¸­å«æœ‰ä¼˜æƒ åˆ¸ID</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getCouponId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ›å»ºä¼˜æƒ åˆ¸æŸ¥è¯¢ç¤ºä¾‹</span>
        <span class="token class-name">Coupon</span> example <span class="token operator">=</span> <span class="token class-name">Coupon</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getCouponId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token constant">AVAILABLE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„ä¼˜æƒ åˆ¸</span>
        coupon <span class="token operator">=</span> couponDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸ä¸å­˜åœ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°†ä¼˜æƒ åˆ¸è½¬æ¢ä¸ºä¼˜æƒ åˆ¸ä¿¡æ¯å¯¹è±¡</span>
        <span class="token class-name">CouponInfo</span> couponInfo <span class="token operator">=</span> <span class="token class-name">CouponConverter</span><span class="token punctuation">.</span><span class="token function">convertToCoupon</span><span class="token punctuation">(</span>coupon<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŠ è½½ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯</span>
        couponInfo<span class="token punctuation">.</span><span class="token function">setTemplateInfo</span><span class="token punctuation">(</span>templateService<span class="token punctuation">.</span><span class="token function">loadCouponTemplate</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getTemplateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†ä¼˜æƒ åˆ¸ä¿¡æ¯æ·»åŠ åˆ°è®¢å•ä¸­</span>
        order<span class="token punctuation">.</span><span class="token function">setCouponInfos</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span>couponInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è®¡ç®—è®¢å•ä»·æ ¼</span>
    <span class="token class-name">ShoppingCart</span> checkoutInfo <span class="token operator">=</span> calculationService<span class="token punctuation">.</span><span class="token function">calculateOrderPrice</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¦‚æœå«æœ‰ä¼˜æƒ åˆ¸</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>coupon <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¦‚æœè®¢å•ä¸­æ²¡æœ‰ä¼˜æƒ åˆ¸ä¿¡æ¯</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>checkoutInfo<span class="token punctuation">.</span><span class="token function">getCouponInfos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;æ²¡æœ‰ä¼˜æƒ åˆ¸ä¿¡æ¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;æ²¡æœ‰ä¼˜æƒ åˆ¸ä¿¡æ¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ›´æ–°ä¼˜æƒ åˆ¸çŠ¶æ€&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ›´æ–°ä¼˜æƒ åˆ¸çŠ¶æ€ä¸ºå·²ä½¿ç”¨</span>
        coupon<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token constant">USED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¿å­˜ä¼˜æƒ åˆ¸ä¿¡æ¯</span>
        couponDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>coupon<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// è¿”å›ç»“è´¦ä¿¡æ¯å¯¹è±¡</span>
    <span class="token keyword">return</span> checkoutInfo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®Œæ•´å®ç°ç±»å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ç”¨æˆ·ä¼˜æƒ åˆ¸ä¸šåŠ¡é€»è¾‘å®ç°ç±»
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponCustomerServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">CouponCustomerService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponDao</span> couponDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponTemplateService</span> templateService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponCalculationService</span> calculationService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Coupon</span> <span class="token function">requestCoupon</span><span class="token punctuation">(</span><span class="token class-name">RequestCoupon</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åŠ è½½ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯</span>
        <span class="token class-name">CouponTemplateInfo</span> templateInfo <span class="token operator">=</span> templateService<span class="token punctuation">.</span><span class="token function">loadCouponTemplate</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getCouponTemplateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœæ¨¡æ¿ä¿¡æ¯ä¸ºç©ºï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>templateInfo <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸æ¨¡æ¿ä¸å­˜åœ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸æ¨¡æ¿ä¸å­˜åœ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// è·å–å½“å‰æ—¶é—´</span>
        <span class="token keyword">long</span> now <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTimeInMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–æ¨¡æ¿è§„åˆ™çš„æˆªæ­¢æ—¶é—´</span>
        <span class="token class-name">Long</span> expTime <span class="token operator">=</span> templateInfo<span class="token punctuation">.</span><span class="token function">getTemplateRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeadline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœæˆªæ­¢æ—¶é—´ä¸ä¸ºç©ºä¸”å½“å‰æ—¶é—´è¶…è¿‡æˆªæ­¢æ—¶é—´ï¼Œæˆ–è€…å¯ç”¨æ€§ä¸ºfalseï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>expTime <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> now <span class="token operator">&gt;</span> expTime <span class="token operator">||</span> <span class="token class-name">BooleanUtils</span><span class="token punctuation">.</span><span class="token function">isFalse</span><span class="token punctuation">(</span>templateInfo<span class="token punctuation">.</span><span class="token function">getAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸æ¨¡æ¿ä¸å¯ç”¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸æ¨¡æ¿ä¸å¯ç”¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// ç»Ÿè®¡ç”¨æˆ·ä½¿ç”¨è¯¥æ¨¡æ¿çš„ä¼˜æƒ åˆ¸æ•°é‡</span>
        <span class="token keyword">long</span> count <span class="token operator">=</span> couponDao<span class="token punctuation">.</span><span class="token function">countByUserIdAndTemplateId</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getCouponTemplateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœæ•°é‡è¾¾åˆ°é™åˆ¶ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;=</span> templateInfo<span class="token punctuation">.</span><span class="token function">getTemplateRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLimitation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸æ¨¡æ¿å·²è¾¾ä¸Šé™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸æ¨¡æ¿å·²è¾¾ä¸Šé™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// åˆ›å»ºä¼˜æƒ åˆ¸å¯¹è±¡</span>
        <span class="token class-name">Coupon</span> coupon <span class="token operator">=</span> <span class="token class-name">Coupon</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">templateId</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getCouponTemplateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">shopId</span><span class="token punctuation">(</span>templateInfo<span class="token punctuation">.</span><span class="token function">getShopId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token constant">AVAILABLE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ä¿å­˜ä¼˜æƒ åˆ¸åˆ°æ•°æ®åº“</span>
        couponDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>coupon<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¿”å›ç”Ÿæˆçš„ä¼˜æƒ åˆ¸å¯¹è±¡</span>
        <span class="token keyword">return</span> coupon<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Transactional</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ShoppingCart</span> <span class="token function">placeOrder</span><span class="token punctuation">(</span><span class="token class-name">ShoppingCart</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¦‚æœè®¢å•å•†å“ä¸ºç©º</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;è®¢å•å•†å“ä¸ºç©º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;è®¢å•å•†å“ä¸ºç©º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Coupon</span> coupon <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœè®¢å•ä¸­å«æœ‰ä¼˜æƒ åˆ¸ID</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getCouponId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ›å»ºä¼˜æƒ åˆ¸æŸ¥è¯¢ç¤ºä¾‹</span>
            <span class="token class-name">Coupon</span> example <span class="token operator">=</span> <span class="token class-name">Coupon</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getCouponId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token constant">AVAILABLE</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„ä¼˜æƒ åˆ¸</span>
            coupon <span class="token operator">=</span> couponDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸ä¸å­˜åœ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// å°†ä¼˜æƒ åˆ¸è½¬æ¢ä¸ºä¼˜æƒ åˆ¸ä¿¡æ¯å¯¹è±¡</span>
            <span class="token class-name">CouponInfo</span> couponInfo <span class="token operator">=</span> <span class="token class-name">CouponConverter</span><span class="token punctuation">.</span><span class="token function">convertToCoupon</span><span class="token punctuation">(</span>coupon<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// åŠ è½½ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯</span>
            couponInfo<span class="token punctuation">.</span><span class="token function">setTemplateInfo</span><span class="token punctuation">(</span>templateService<span class="token punctuation">.</span><span class="token function">loadCouponTemplate</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getTemplateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// å°†ä¼˜æƒ åˆ¸ä¿¡æ¯æ·»åŠ åˆ°è®¢å•ä¸­</span>
            order<span class="token punctuation">.</span><span class="token function">setCouponInfos</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span>couponInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// è®¡ç®—è®¢å•ä»·æ ¼</span>
        <span class="token class-name">ShoppingCart</span> checkoutInfo <span class="token operator">=</span> calculationService<span class="token punctuation">.</span><span class="token function">calculateOrderPrice</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¦‚æœå«æœ‰ä¼˜æƒ åˆ¸</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>coupon <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœè®¢å•ä¸­æ²¡æœ‰ä¼˜æƒ åˆ¸ä¿¡æ¯</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>checkoutInfo<span class="token punctuation">.</span><span class="token function">getCouponInfos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;æ²¡æœ‰ä¼˜æƒ åˆ¸ä¿¡æ¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;æ²¡æœ‰ä¼˜æƒ åˆ¸ä¿¡æ¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ›´æ–°ä¼˜æƒ åˆ¸çŠ¶æ€&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// æ›´æ–°ä¼˜æƒ åˆ¸çŠ¶æ€ä¸ºå·²ä½¿ç”¨</span>
            coupon<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token constant">USED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// ä¿å­˜ä¼˜æƒ åˆ¸ä¿¡æ¯</span>
            couponDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>coupon<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// è¿”å›ç»“è´¦ä¿¡æ¯å¯¹è±¡</span>
        <span class="token keyword">return</span> checkoutInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">SimulationResponse</span> <span class="token function">simulateOrderPrice</span><span class="token punctuation">(</span><span class="token class-name">SimulationOrder</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ›å»ºä¸€ä¸ªç©ºçš„CouponInfoåˆ—è¡¨</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponInfo</span><span class="token punctuation">&gt;</span></span> couponInfos <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// éå†è®¢å•ä¸­çš„ä¼˜æƒ åˆ¸IDåˆ—è¡¨</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Long</span> couponID <span class="token operator">:</span> order<span class="token punctuation">.</span><span class="token function">getCouponIDs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ›å»ºä¸€ä¸ªCouponçš„æ„å»ºå™¨å¯¹è±¡ï¼Œå¹¶è®¾ç½®ç”¨æˆ·IDã€ä¼˜æƒ åˆ¸IDå’ŒçŠ¶æ€</span>
            <span class="token class-name">Coupon</span> example <span class="token operator">=</span> <span class="token class-name">Coupon</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>couponID<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token constant">AVAILABLE</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// é€šè¿‡ä¼˜æƒ åˆ¸IDæŸ¥è¯¢ä¼˜æƒ åˆ¸ä¿¡æ¯ï¼Œå¹¶å°†ç»“æœè½¬æ¢ä¸ºObservable</span>
            <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coupon</span><span class="token punctuation">&gt;</span></span> couponOptional <span class="token operator">=</span> couponDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// å¦‚æœæŸ¥è¯¢åˆ°äº†ä¼˜æƒ åˆ¸</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>couponOptional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// è·å–ä¼˜æƒ åˆ¸å¯¹è±¡</span>
                <span class="token class-name">Coupon</span> coupon <span class="token operator">=</span> couponOptional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// å°†ä¼˜æƒ åˆ¸è½¬æ¢ä¸ºCouponInfoå¯¹è±¡</span>
                <span class="token class-name">CouponInfo</span> couponInfo <span class="token operator">=</span> <span class="token class-name">CouponConverter</span><span class="token punctuation">.</span><span class="token function">convertToCoupon</span><span class="token punctuation">(</span>coupon<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// åŠ è½½ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯</span>
                couponInfo<span class="token punctuation">.</span><span class="token function">setTemplateInfo</span><span class="token punctuation">(</span>templateService<span class="token punctuation">.</span><span class="token function">loadCouponTemplate</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getTemplateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// å°†CouponInfoå¯¹è±¡æ·»åŠ åˆ°åˆ—è¡¨ä¸­</span>
                couponInfos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>couponInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å°†ç”Ÿæˆçš„ä¼˜æƒ åˆ¸ä¿¡æ¯åˆ—è¡¨è®¾ç½®å›è®¢å•å¯¹è±¡</span>
        order<span class="token punctuation">.</span><span class="token function">setCouponInfos</span><span class="token punctuation">(</span>couponInfos<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è°ƒç”¨è®¡ç®—æœåŠ¡çš„simulateOrderæ–¹æ³•ï¼Œè¿”å›æ¨¡æ‹Ÿè®¢å•ç»“æœ</span>
        <span class="token keyword">return</span> calculationService<span class="token punctuation">.</span><span class="token function">simulateOrder</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteCoupon</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">Long</span> couponId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ„å»ºä¼˜æƒ åˆ¸æŸ¥è¯¢ç¤ºä¾‹</span>
        <span class="token class-name">Coupon</span> example <span class="token operator">=</span> <span class="token class-name">Coupon</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>couponId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token constant">AVAILABLE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ ¹æ®æŸ¥è¯¢ç¤ºä¾‹è·å–ç¬¦åˆæ¡ä»¶çš„ä¼˜æƒ åˆ¸</span>
        <span class="token class-name">Coupon</span> coupon <span class="token operator">=</span> couponDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;ä¼˜æƒ åˆ¸ä¸å­˜åœ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°†ä¼˜æƒ åˆ¸çŠ¶æ€è®¾ç½®ä¸ºæ— æ•ˆ</span>
        coupon<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token constant">INACTIVE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ä¿å­˜ä¿®æ”¹åçš„ä¼˜æƒ åˆ¸</span>
        couponDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>coupon<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">findCoupon</span><span class="token punctuation">(</span><span class="token class-name">SearchCoupon</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ ¹æ®æœç´¢æ¡ä»¶æŸ¥è¯¢ä¼˜æƒ åˆ¸åˆ—è¡¨</span>
        <span class="token comment">// æ³¨æ„ï¼šåœ¨ç”Ÿäº§ä¸­æ­¤å¤„åº”è¯¥ä½¿ç”¨åˆ†é¡µæŸ¥è¯¢ä¸”æŸ¥è¯¢æ¡ä»¶åº”è¯¥å°è£…ä¸ºä¸€ä¸ªç±»</span>
        <span class="token class-name">Coupon</span> example <span class="token operator">=</span> <span class="token class-name">Coupon</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">CouponStatus</span><span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">shopId</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getShopId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coupon</span><span class="token punctuation">&gt;</span></span> coupons <span class="token operator">=</span> couponDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœä¼˜æƒ åˆ¸åˆ—è¡¨ä¸ºç©º,è¿”å›ç©ºåˆ—è¡¨</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>coupons<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// è·å–ä¼˜æƒ åˆ¸æ¨¡æ¿IDåˆ—è¡¨</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> templateIds <span class="token operator">=</span> coupons<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Coupon</span><span class="token operator">::</span><span class="token function">getTemplateId</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ ¹æ®æ¨¡æ¿IDè·å–ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯æ˜ å°„</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">CouponTemplateInfo</span><span class="token punctuation">&gt;</span></span> templateMap <span class="token operator">=</span> templateService<span class="token punctuation">.</span><span class="token function">getCouponTemplateMap</span><span class="token punctuation">(</span>templateIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†ä¼˜æƒ åˆ¸æ¨¡æ¿ä¿¡æ¯è®¾ç½®åˆ°ä¼˜æƒ åˆ¸å¯¹è±¡ä¸­</span>
        coupons<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>coupon <span class="token operator">-&gt;</span> coupon<span class="token punctuation">.</span><span class="token function">setTemplateInfo</span><span class="token punctuation">(</span>templateMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getTemplateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°†ä¼˜æƒ åˆ¸åˆ—è¡¨è½¬æ¢ä¸ºä¼˜æƒ åˆ¸ä¿¡æ¯åˆ—è¡¨</span>
        <span class="token keyword">return</span> coupons<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">CouponConverter</span><span class="token operator">::</span><span class="token function">convertToCoupon</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¶‰åŠåˆ°çš„è½¬æ¢å™¨å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¼˜æƒ å·è½¬æ¢å™¨
 *
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponConverter</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CouponInfo</span> <span class="token function">convertToCoupon</span><span class="token punctuation">(</span><span class="token class-name">Coupon</span> coupon<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CouponInfo</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">templateId</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getTemplateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">shopId</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getShopId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">templateInfo</span><span class="token punctuation">(</span>coupon<span class="token punctuation">.</span><span class="token function">getTemplateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™é‡Œï¼Œè½¬æ¢å™¨çš„ä½œç”¨æ˜¯ç¡®ä¿å®ä½“å¯¹è±¡ä¸æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆDTOï¼‰ä¹‹é—´çš„å‡†ç¡®è½¬æ¢ï¼Œè¿™å¯¹ä¿è¯ç³»ç»Ÿçš„æ•°æ®ä¸€è‡´æ€§è‡³å…³é‡è¦ã€‚</p><h4 id="_4-3-3-controller-å±‚" tabindex="-1"><a class="header-anchor" href="#_4-3-3-controller-å±‚" aria-hidden="true">#</a> 4.3.3 Controller å±‚</h4><p>åœ¨ä¸šåŠ¡é€»è¾‘å±‚çš„å®ç°ä¹‹åï¼Œç´§æ¥ç€æ˜¯å°†æœåŠ¡é€»è¾‘ä¸å‰ç«¯äº¤äº’çš„æ§åˆ¶å™¨å±‚ã€‚åœ¨ <code>CouponCustomerController</code> ä¸­ï¼Œæˆ‘å®šä¹‰äº†å‡ ä¸ªå¯¹å¤–æ¥å£ï¼Œè¿™äº›æ¥å£é€šè¿‡è°ƒç”¨ <code>CouponCustomerServiceImpl</code> ä¸­çš„æ–¹æ³•æ¥å…·ä½“å®ç°ç›¸åº”çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> javgo.cn
 * <span class="token keyword">@date</span> 2023/11/4
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;coupon-customer&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponCustomerController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponCustomerService</span> customerService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;requestCoupon&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Coupon</span> <span class="token function">requestCoupon</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">RequestCoupon</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> customerService<span class="token punctuation">.</span><span class="token function">requestCoupon</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string">&quot;deleteCoupon&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteCoupon</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span>
                             <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;couponId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> couponId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        customerService<span class="token punctuation">.</span><span class="token function">deleteCoupon</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span> couponId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;simulateOrder&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">SimulationResponse</span> <span class="token function">simulate</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SimulationOrder</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> customerService<span class="token punctuation">.</span><span class="token function">simulateOrderPrice</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;placeOrder&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ShoppingCart</span> <span class="token function">checkout</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">ShoppingCart</span> info<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> customerService<span class="token punctuation">.</span><span class="token function">placeOrder</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;findCoupon&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CouponInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">findCoupon</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SearchCoupon</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> customerService<span class="token punctuation">.</span><span class="token function">findCoupon</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®Œæˆäº†ç”¨æˆ·ä¼˜æƒ åˆ¸æœåŠ¡çš„ä¸šåŠ¡é€»è¾‘å±‚å’Œæ§åˆ¶å±‚å®ç°åï¼Œæ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯è¿›è¡Œåº”ç”¨å¯åŠ¨ç±»çš„é…ç½®ä»¥åŠç›¸å…³é…ç½®æ–‡ä»¶çš„è®¾ç½®ã€‚</p><h4 id="_4-3-4-å¯åŠ¨ç±»" tabindex="-1"><a class="header-anchor" href="#_4-3-4-å¯åŠ¨ç±»" aria-hidden="true">#</a> 4.3.4 å¯åŠ¨ç±»</h4><p>å¯åŠ¨ç±»æ˜¯ Spring Boot åº”ç”¨çš„å…¥å£ç‚¹ï¼Œé€šè¿‡ä¸€ç³»åˆ—çš„æ³¨è§£ï¼ŒSpring Boot å¯ä»¥è‡ªåŠ¨é…ç½®å…¶ä¸Šä¸‹æ–‡ç¯å¢ƒå¹¶å¯åŠ¨åº”ç”¨ã€‚</p><p>ä»¥ä¸‹æ˜¯å¯åŠ¨ç±»ä»£ç çš„æ ¸å¿ƒç‰‡æ®µï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableJpaAuditing</span> <span class="token comment">// å¼€å¯å®¡è®¡åŠŸèƒ½</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;cn.javgo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableTransactionManagement</span> <span class="token comment">// å¼€å¯äº‹åŠ¡ç®¡ç†</span>
<span class="token annotation punctuation">@EnableJpaRepositories</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;cn.javgo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// æ‰«æ JPA ç›¸å…³çš„ DAO å±‚</span>
<span class="token annotation punctuation">@EntityScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;cn.javgo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// æ‰«æ JPA ç›¸å…³çš„å®ä½“ç±»</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>@SpringBootApplication</code>ï¼šè¿™æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œå®ƒæ•´åˆäº†<code>@Configuration</code>ï¼Œ<code>@EnableAutoConfiguration</code>ï¼Œå’Œ <code>@ComponentScan</code> æ³¨è§£ã€‚é€šè¿‡è¿™ä¸ªæ³¨è§£ï¼ŒSpring Boot è‡ªåŠ¨æ‰«æå¹¶åŠ è½½å®šä¹‰å¥½çš„ç»„ä»¶ã€‚</li><li><code>@ComponentScan(basePackages = &quot;cn.javgo&quot;)</code>ï¼šè¿™ä¸ªæ³¨è§£å‘Šè¯‰ Spring Boot åœ¨ <code>cn.javgo</code> åŒ…ä¸‹ä»¥åŠå…¶å­åŒ…ä¸­æŸ¥æ‰¾ç»„ä»¶ã€é…ç½®å’ŒæœåŠ¡ã€‚</li></ul><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ Spring Boot çš„ä¸€ä¸ªçº¦å®šï¼šå®ƒé»˜è®¤ä¼šæ‰«æå¯åŠ¨ç±»æ‰€åœ¨åŒ…ä»¥åŠå…¶å­åŒ…ä¸­çš„ç»„ä»¶ã€‚å¦‚æœéœ€è¦åŠ è½½å…¶ä»–åŒ…è·¯å¾„ä¸‹çš„ç»„ä»¶ï¼Œåˆ™éœ€è¦é€šè¿‡ <code>@ComponentScan</code> æ³¨è§£æ˜ç¡®æŒ‡å®šæ‰«æè·¯å¾„ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœå¯åŠ¨ç±»ä½äº <code>cn.javgo.customer</code> åŒ…ä¸­ï¼Œä½†é¡¹ç›®ä¸­éœ€è¦åŠ è½½ <code>cn.javgo.template</code> åŒ…ä¸‹çš„ç»„ä»¶ï¼Œå°±éœ€è¦åœ¨ <code>@ComponentScan</code> ä¸­æŒ‡å®šè¿™äº›åŒ…ä½œä¸ºé¢å¤–çš„æ‰«æè·¯å¾„ã€‚</p><h4 id="_4-3-5-æ¨¡å—é…ç½®" tabindex="-1"><a class="header-anchor" href="#_4-3-5-æ¨¡å—é…ç½®" aria-hidden="true">#</a> 4.3.5 æ¨¡å—é…ç½®</h4><p>å¯¹äºé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ <code>application.yml</code>ï¼ˆæˆ– <code>application.properties</code>ï¼‰ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿé‰´å·²æœ‰çš„ <code>coupon-template-impl</code> æœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼Œå¤åˆ¶å¹¶è°ƒæ•´å¿…è¦çš„é…ç½®é¡¹æ¥æ»¡è¶³å½“å‰æœåŠ¡çš„éœ€æ±‚ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œç¡®ä¿ä¿®æ”¹ <code>spring.application.name </code>å±æ€§ï¼Œå°†å…¶è®¾ç½®ä¸º <code>coupon-customer-serv</code>ï¼Œä»¥åæ˜ æœåŠ¡çš„å®é™…èº«ä»½ã€‚</p><p>é…ç½®æ–‡ä»¶çš„è¯¦ç»†å†…å®¹ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># æœåŠ¡å™¨ç«¯å£</span>
<span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">20001</span>

<span class="token comment"># æ˜¯å¦åœ¨é”™è¯¯ä¿¡æ¯ä¸­åŒ…å«æ¶ˆæ¯</span>
<span class="token key attr-name">server.error.include-message</span><span class="token punctuation">=</span><span class="token value attr-value">always</span>

<span class="token comment"># åº”ç”¨åç§°</span>
<span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">coupon-customer-serv</span>

<span class="token comment"># æ•°æ®åº“é©±åŠ¨ç±»å</span>
<span class="token key attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span>
<span class="token comment"># æ•°æ®åº“è¿æ¥URL</span>
<span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://127.0.0.1:3306/coupon_db?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false&amp;allowPublicKeyRetrieval=true&amp;zeroDateTimeBehavior=convertToNull&amp;serverTimezone=UTC</span>
<span class="token comment"># æ•°æ®åº“ç”¨æˆ·å</span>
<span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token comment"># æ•°æ®åº“å¯†ç </span>
<span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>

<span class="token comment"># æ•°æ®æºç±»å‹</span>
<span class="token key attr-name">spring.datasource.type</span><span class="token punctuation">=</span><span class="token value attr-value">com.zaxxer.hikari.HikariDataSource</span>
<span class="token comment"># æ•°æ®æºè¿æ¥æ± åç§°</span>
<span class="token key attr-name">spring.datasource.hikari.pool-name</span><span class="token punctuation">=</span><span class="token value attr-value">CouponHikari</span>
<span class="token comment"># è¿æ¥è¶…æ—¶æ—¶é—´</span>
<span class="token key attr-name">spring.datasource.hikari.connection-timeout</span><span class="token punctuation">=</span><span class="token value attr-value">5000</span>
<span class="token comment"># ç©ºé—²è¶…æ—¶æ—¶é—´</span>
<span class="token key attr-name">spring.datasource.hikari.idle-timeout</span><span class="token punctuation">=</span><span class="token value attr-value">30000</span>
<span class="token comment"># æœ€å¤§è¿æ¥æ± å¤§å°</span>
<span class="token key attr-name">spring.datasource.hikari.maximum-pool-size</span><span class="token punctuation">=</span><span class="token value attr-value">10</span>
<span class="token comment"># æœ€å°è¿æ¥æ± å¤§å°</span>
<span class="token key attr-name">spring.datasource.hikari.minimum-idle</span><span class="token punctuation">=</span><span class="token value attr-value">5</span>
<span class="token comment"># è¿æ¥ç”Ÿå‘½å‘¨æœŸ</span>
<span class="token key attr-name">spring.datasource.hikari.max-lifetime</span><span class="token punctuation">=</span><span class="token value attr-value">60000</span>
<span class="token comment"># è‡ªåŠ¨æäº¤</span>
<span class="token key attr-name">spring.datasource.hikari.auto-commit</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>

<span class="token comment"># æ˜¯å¦æ˜¾ç¤º Hibernate SQL è¯­å¥</span>
<span class="token key attr-name">spring.jpa.show-sql</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># JPA ç”ŸæˆDDLçš„æ–¹å¼</span>
<span class="token key attr-name">spring.jpa.hibernate.ddl-auto</span><span class="token punctuation">=</span><span class="token value attr-value">none</span>
<span class="token comment"># Hibernate SQL è¯­å¥æ ¼å¼åŒ–</span>
<span class="token key attr-name">spring.jpa.properties.hibernate.format_sql</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># Hibernate SQL è¯­å¥æ˜¾ç¤º</span>
<span class="token key attr-name">spring.jpa.properties.hibernate.show_sql</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># æ˜¯å¦åœ¨è§†å›¾ä¸­æ‰“å¼€ JPA è¿æ¥</span>
<span class="token key attr-name">spring.jpa.open-in-view</span><span class="token punctuation">=</span><span class="token value attr-value">false</span>

<span class="token comment"># æ—¥å¿—çº§åˆ«</span>
<span class="token key attr-name">logging.level.cn.javgo.coupon</span><span class="token punctuation">=</span><span class="token value attr-value">debug</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å®Œå¯åŠ¨ç±»å’Œ <code>application.properties</code> ä¹‹åï¼Œç”¨æˆ·ä¼˜æƒ åˆ¸æœåŠ¡çš„ Spring Boot ç‰ˆæœ¬å°±é…ç½®å®Œæˆäº†ã€‚ç°åœ¨ï¼Œé€šè¿‡åœ¨æœ¬åœ°å¯åŠ¨å•ä½“åº”ç”¨ <code>coupon-customer-serv</code>ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ•´åˆå¹¶ä½¿ç”¨ç”¨æˆ·æœåŠ¡ã€æ¨¡æ¿æœåŠ¡å’Œè®¡ç®—æœåŠ¡çš„åŠŸèƒ½ã€‚</p><p>åœ¨æœ¬åœ°ç¯å¢ƒä¸‹ï¼Œä½ å¯ä»¥ç›´æ¥è¿è¡Œå¯åŠ¨ç±»æ¥å¯åŠ¨æœåŠ¡ï¼Œå¹¶é€šè¿‡ä¸åŒçš„æµ‹è¯•ç”¨ä¾‹æ¥éªŒè¯æœåŠ¡çš„åŠŸèƒ½ï¼Œç¡®ä¿å®ƒä»¬æŒ‰é¢„æœŸå·¥ä½œã€‚</p><h2 id="_5-é¡¹ç›®æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_5-é¡¹ç›®æ€»ç»“" aria-hidden="true">#</a> 5.é¡¹ç›®æ€»ç»“</h2><p>æˆ‘ä»¬å…±åŒæ‰“é€ äº†ä¸€ä¸ªåŸºäº Spring Boot çš„ä¼˜æƒ åˆ¸å¹³å°ï¼Œæ¶µç›–äº†ç”¨æˆ·ã€æ¨¡æ¿å’Œè®¡ç®—ç­‰ä¸‰ä¸ªæ ¸å¿ƒæœåŠ¡æ¨¡å—ã€‚æœ¬é¡¹ç›®é‡‡çº³äº†<strong>åˆ†å±‚è®¾è®¡åŸåˆ™</strong>ï¼Œç»†åŒ–ä¸º APIã€DAO å’Œä¸šåŠ¡é€»è¾‘å±‚ï¼Œä»¥ç¡®ä¿æ¶æ„çš„æ¸…æ™°æ€§å’Œç»´æŠ¤çš„ä¾¿æ·æ€§ã€‚åœ¨å®ç°è¿‡ç¨‹ä¸­ï¼Œspring-data-jpa çš„åŠ å…¥æå¤§ç®€åŒ–äº†æ•°æ®æ“ä½œï¼Œè€Œ spring-web åˆ™ä¸ºæˆ‘ä»¬æä¾›äº†æ„å»º RESTful æ¥å£çš„å¼ºå¤§å·¥å…·ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å³å°†è¸å…¥ Spring Cloud çš„å­¦ä¹ ä¹‹æ—…ã€‚åœ¨è¿™ä¸ªç¯‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥äº†è§£ Nacosã€Loadbalancerã€OpenFeign ç­‰å…³é”®ç»„ä»¶ï¼Œå®ƒä»¬æ˜¯æ„å»ºå¾®æœåŠ¡æ¶æ„ä¸­è·¨æœåŠ¡è°ƒç”¨ç³»ç»Ÿçš„åŸºçŸ³ã€‚é€šè¿‡ Spring Cloudï¼Œæˆ‘ä»¬èƒ½å¤Ÿå®ç°æœåŠ¡çš„è‡ªåŠ¨æ³¨å†Œä¸å‘ç°ã€è´Ÿè½½å‡è¡¡ã€æœåŠ¡ç†”æ–­å’Œé“¾è·¯è¿½è¸ªç­‰é«˜çº§åŠŸèƒ½ï¼Œè¿™å°†æå¤§åœ°æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå¯é æ€§ã€‚</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/javgocn/javgocn/edit/main/src/md/Spring/SpringCloud/04-cloud-å®æˆ˜é¡¹ç›®æ­å»º.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: liyao@jikugroup.com">liyao</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a aria-label="03-cloud-å®æˆ˜é¡¹ç›®è¯´æ˜" class="vp-link nav-link prev nav-link prev" href="/md/Spring/SpringCloud/03-cloud-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E8%AF%B4%E6%98%8E.html"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->03-cloud-å®æˆ˜é¡¹ç›®è¯´æ˜</div></a><a aria-label="05-cloud-æœåŠ¡æ²»ç†" class="vp-link nav-link next nav-link next" href="/md/Spring/SpringCloud/05-cloud-%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86.html"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">05-cloud-æœåŠ¡æ²»ç†<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-009ef08a.js" defer></script>
  </body>
</html>
